IF
HasItem("dw#sumfi",Myself)
THEN
RESPONSE #100
DestroyItem("dw#sumfi")
Continue()
END

IF
Die()
Global("fl#EACheck","LOCALS",1)
Global("fl#XP","LOCALS",0)
THEN
RESPONSE #100
SetGlobal("fl#XP","LOCALS",1)
AddexperienceParty(20000)
END

IF
Global("fl#EACheck","LOCALS",0)
Allegiance(LastSummonerOf(Myself),GOODCUTOFF)
THEN
RESPONSE #100
SetInterrupt(FALSE)
SetGlobal("fl#EACheck","LOCALS",2)
DialogInterrupt(FALSE)
LeaveParty()
ChangeEnemyAlly(Myself,ALLY)
SetInterrupt(TRUE)
END

IF
Global("fl#EACheck","LOCALS",0)
OR(2)
Allegiance(LastSummonerOf(Myself),EVILCUTOFF)
!Exists(LastSummonerOf(Myself))
THEN
RESPONSE #100
SetInterrupt(FALSE)
SetGlobal("fl#EACheck","LOCALS",1)
Enemy()
SetInterrupt(TRUE)
END

IF
Global("fl#EACheck","LOCALS",2)
Global("fl#Hostile","LOCALS",1)
Allegiance(Myself,EVILCUTOFF)
!See([PC])
THEN
RESPONSE #100
SetInterrupt(FALSE)
LeaveParty()
ChangeEnemyAlly(Myself,ALLY)
SetInterrupt(TRUE)
END

IF
Global("fl#EACheck","LOCALS",2)
Global("fl#Hostile","LOCALS",0)
!Allegiance(Myself,EVILCUTOFF)
See([PC])
THEN
RESPONSE #100
SetInterrupt(FALSE)
SetGlobal("fl#Hostile","LOCALS",1)
Enemy()
SetInterrupt(TRUE)
END

IF
See(LastSummonerOf(Myself))
Global("fl#Summoner","LOCALS",0)
Exists(LastSummonerOf(Myself))
!CheckStatGT(LastSummonerOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",LastSummonerOf(Myself))
!HasItemEquiped("wa2amu",LastSummonerOf(Myself))

!StateCheck(LastSummonerOf(Myself),STATE_REALLY_DEAD)
!StateCheck(Myself,STATE_INVISIBLE)
!Race(LastSummonerOf(Myself),DEMONIC)
THEN
RESPONSE #100
SetInterrupt(FALSE)
SetGlobal("fl#Summoner","LOCALS",1)
FaceObject(LastSummonerOf(Myself))
DisplayStringHead(Myself,@681)
SetInterrupt(TRUE)
END

IF
StateCheck(Myself,STATE_REALLY_DEAD)
THEN
RESPONSE #100
NoAction()
END

IF
!InActiveArea(Myself)
!See([ANYONE])
THEN
RESPONSE #100
NoAction()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
OR(2)
AreaCheck("AR3004")
AreaCheck("AR3008")
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",600)
END

IF
Global("flDecideMinorSequencer","LOCALS",0)
THEN
RESPONSE #100
SetGlobal("flDecideMinorSequencer","LOCALS",1)
RESPONSE #100
SetGlobal("flDecideMinorSequencer","LOCALS",2)
END

IF
Global("flContingency","LOCALS",0)
THEN
RESPONSE #100
DisplayStringHead(Myself,25942)
ReallyForceSpell(Myself,WIZARD_IMPROVED_INVISIBILITY)
SetGlobal("flContingency","LOCALS",1)
RESPONSE #100
DisplayStringHead(Myself,25942)
ReallyForceSpell(Myself,WIZARD_MINOR_GLOBE_OF_INVULNERABILITY)
SetGlobal("flContingency","LOCALS",2)
RESPONSE #100
DisplayStringHead(Myself,25942)
ReallyForceSpell(Myself,WIZARD_STONE_SKIN)
SetGlobal("flContingency","LOCALS",3)
RESPONSE #100
DisplayStringHead(Myself,25942)
ReallyForceSpell(Myself,WIZARD_PROTECTION_FROM_COLD)
SetGlobal("flContingency","LOCALS",4)
RESPONSE #100
DisplayStringHead(Myself,25942)
ReallyForceSpell(Myself,WIZARD_MELF_METEOR)
SetGlobal("flContingency","LOCALS",5)
RESPONSE #100
DisplayStringHead(Myself,25942)
ReallyForceSpell(Myself,WIZARD_FIRE_SHIELD_BLUE)
SetGlobal("flContingency","LOCALS",6)
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
Allegiance(Myself,GOODCUTOFF)
AttackedBy([GOODCUTOFF],DEFAULT)
CheckStatGT(LastAttackerOf(Myself),0,PROTECTION_FROM_EVIL)
!See(NearestEnemyOf(Myself))
THEN
RESPONSE #100
SetInterrupt(FALSE)
DisplayStringHead(Myself,@724)
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("RR#TELAW",Myself)
SetInterrupt(TRUE)
END

IF
See(LastAttackerOf(Myself))
!GlobalTimerNotExpired("flCast","LOCALS")
Exists(LastAttackerOf(Myself))
!Range(LastAttackerOf(Myself),6)
InMyArea(LastAttackerOf(Myself))
OR(2)
!Allegiance(LastAttackerOf(Myself),GOODCUTOFF)
!Allegiance(Myself,GOODCUTOFF)
!StateCheck(LastAttackerOf(Myself),STATE_REALLY_DEAD)
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(LastAttackerOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(LastAttackerOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(LastAttackerOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(LastAttackerOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(LastAttackerOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",LastAttackerOf(Myself))
!CheckStatGT(LastAttackerOf(Myself),99,RESISTSLASHING)
!CheckStatGT(LastAttackerOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",LastAttackerOf(Myself))
!HasItemEquiped("wa2amu",LastAttackerOf(Myself))
!See(NearestEnemyOf(Myself))
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("RR#TELWE",LastAttackerOf(Myself))
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SixthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SixthNearestEnemyOf(Myself))
!CheckStatGT(SixthNearestEnemyOf(Myself),99,RESISTSLASHING)
StateCheck(SixthNearestEnemyOf(Myself),STATE_IMMOBILE)
!Range(SixthNearestEnemyOf(Myself),6)
See(SixthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FifthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FifthNearestEnemyOf(Myself))
!CheckStatGT(FifthNearestEnemyOf(Myself),99,RESISTSLASHING)
StateCheck(FifthNearestEnemyOf(Myself),STATE_IMMOBILE)
!Range(FifthNearestEnemyOf(Myself),6)
See(FifthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FourthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FourthNearestEnemyOf(Myself))
!CheckStatGT(FourthNearestEnemyOf(Myself),99,RESISTSLASHING)
StateCheck(FourthNearestEnemyOf(Myself),STATE_IMMOBILE)
!Range(FourthNearestEnemyOf(Myself),6)
See(FourthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearestEnemyOf(Myself))
!CheckStatGT(ThirdNearestEnemyOf(Myself),99,RESISTSLASHING)
StateCheck(ThirdNearestEnemyOf(Myself),STATE_IMMOBILE)
!Range(ThirdNearestEnemyOf(Myself),6)
See(ThirdNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearestEnemyOf(Myself))
!CheckStatGT(SecondNearestEnemyOf(Myself),99,RESISTSLASHING)
StateCheck(SecondNearestEnemyOf(Myself),STATE_IMMOBILE)
!Range(SecondNearestEnemyOf(Myself),6)
See(SecondNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(NearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",NearestEnemyOf(Myself))
!CheckStatGT(NearestEnemyOf(Myself),99,RESISTSLASHING)
StateCheck(NearestEnemyOf(Myself),STATE_IMMOBILE)
!Range(NearestEnemyOf(Myself),6)
See(NearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(LastSeenBy(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(LastSeenBy(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(LastSeenBy(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(LastSeenBy(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(LastSeenBy(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",LastSeenBy(Myself))
!CheckStatGT(LastSeenBy(Myself),99,RESISTSLASHING)
StateCheck(LastSeenBy(Myself),STATE_IMMOBILE)
!Range(LastSeenBy(Myself),6)
See(LastSeenBy(Myself))
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("RR#TELWE",LastSeenBy(Myself))
END

IF
!GlobalTimerNotExpired("fl#Taunt","LOCALS")
!GlobalTimerNotExpired("flCast","LOCALS")
!StateCheck(Myself,STATE_INVISIBLE)
!See(NearestEnemyOf(Myself))
See([0.HUMANOID.0.INNOCENT])
!Range(LastSeenBy(Myself),8)
THEN
RESPONSE #40
SetInterrupt(FALSE)
SetGlobalTimer("fl#Taunt","LOCALS",12)
ForceSpellRES("RR#TELWE",LastSeenBy(Myself))
SetGlobalTimer("flCast","LOCALS",6)
DisplayStringHead(Myself,@739)
ApplySpellRES("RR#FEAR",LastSeenBy(Myself))
DisplayStringHead(LastSeenBy(Myself),@740)
SetInterrupt(TRUE)
RESPONSE #30
SetInterrupt(FALSE)
SetGlobalTimer("fl#Taunt","LOCALS",12)
ForceSpellRES("RR#TELWE",LastSeenBy(Myself))
SetGlobalTimer("flCast","LOCALS",6)
DisplayStringHead(Myself,@741)
ApplySpellRES("RR#FEAR",LastSeenBy(Myself))
DisplayStringHead(LastSeenBy(Myself),@742)
SetInterrupt(TRUE)
RESPONSE #30
SetInterrupt(FALSE)
SetGlobalTimer("fl#Taunt","LOCALS",12)
ForceSpellRES("RR#TELWE",LastSeenBy(Myself))
SetGlobalTimer("flCast","LOCALS",6)
DisplayStringHead(Myself,@743)
ApplySpellRES("RR#FEAR",LastSeenBy(Myself))
DisplayStringHead(LastSeenBy(Myself),@744)
SetInterrupt(TRUE)
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_STONE_SKIN)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!CheckStatGT(Myself,0,STONESKINS)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
Spell(Myself,WIZARD_STONE_SKIN)
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_PROTECTION_FROM_COLD)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!CheckStatGT(Myself,0,RESISTCOLD)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
Spell(Myself,WIZARD_PROTECTION_FROM_COLD)
RESPONSE #50
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_MELF_METEOR)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!HasItem("melfmet",Myself)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
Spell(Myself,WIZARD_MELF_METEOR)
RESPONSE #50
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_MIRROR_IMAGE)
See(NearestEnemyOf(Myself))
!CheckStatGT(NearestEnemyOf(Myself),0,TRUE_SIGHT)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,TRUE_SIGHT)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,TRUE_SIGHT)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,TRUE_SIGHT)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,TRUE_SIGHT)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,TRUE_SIGHT)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(Myself,STATE_MIRRORIMAGE)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
Spell(Myself,WIZARD_MIRROR_IMAGE)
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_SHIELD)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
Spell(Myself,WIZARD_SHIELD)
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
!StateCheck(Myself,STATE_INVISIBLE)
!CheckStatGT(NearestEnemyOf(Myself),0,TRUE_SIGHT)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,TRUE_SIGHT)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,TRUE_SIGHT)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,TRUE_SIGHT)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,TRUE_SIGHT)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,TRUE_SIGHT)
!CheckStatGT(SeventhNearestEnemyOf(Myself),0,TRUE_SIGHT)
!Global("dvgldust","LOCALS",1)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("RR#WI206",Myself)
RESPONSE #400
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_SECRET_WORD)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,HELD)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
OR(5)
CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_IMMUNITY)
CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
CheckStat(ThirdNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
CheckStatGT(ThirdNearestEnemyOf(Myself),0,MINORGLOBE)
!Race(ThirdNearestEnemyOf(Myself),RAKSHASA)
!Race(ThirdNearestEnemyOf(Myself),LICH)
See(ThirdNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_SECRET_WORD)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,HELD)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
OR(5)
CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_IMMUNITY)
CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
CheckStat(SecondNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
CheckStatGT(SecondNearestEnemyOf(Myself),0,MINORGLOBE)
!Race(SecondNearestEnemyOf(Myself),RAKSHASA)
!Race(SecondNearestEnemyOf(Myself),LICH)
See(SecondNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_SECRET_WORD)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(NearestEnemyOf(Myself),0,HELD)
!StateCheck(NearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
OR(5)
CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_IMMUNITY)
CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
CheckStat(NearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
CheckStatGT(NearestEnemyOf(Myself),0,MINORGLOBE)
!Race(NearestEnemyOf(Myself),RAKSHASA)
!Race(NearestEnemyOf(Myself),LICH)
See(NearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_SECRET_WORD)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(NearestEnemyOfType([0.0.0.BARD_ALL]),STATE_DISABLED)
!CheckStatGT(NearestEnemyOfType([0.0.0.BARD_ALL]),0,HELD)
!StateCheck(NearestEnemyOfType([0.0.0.BARD_ALL]),STATE_STONE_DEATH)
!CheckStatGT(NearestEnemyOfType([0.0.0.BARD_ALL]),0,WIZARD_SPELL_TRAP)
OR(5)
CheckStatGT(NearestEnemyOfType([0.0.0.BARD_ALL]),0,WIZARD_SPELL_IMMUNITY)
CheckStatGT(NearestEnemyOfType([0.0.0.BARD_ALL]),0,WIZARD_SPELL_DEFLECTION)
CheckStatGT(NearestEnemyOfType([0.0.0.BARD_ALL]),0,WIZARD_SPELL_TURNING)
CheckStat(NearestEnemyOfType([0.0.0.BARD_ALL]),1,CLERIC_SHIELD_OF_THE_ARCHONS)
CheckStatGT(NearestEnemyOfType([0.0.0.BARD_ALL]),0,MINORGLOBE)
!Race(NearestEnemyOfType([0.0.0.BARD_ALL]),RAKSHASA)
!Race(NearestEnemyOfType([0.0.0.BARD_ALL]),LICH)
See(NearestEnemyOfType([0.0.0.BARD_ALL]))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_SECRET_WORD)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(SecondNearestEnemyOfType([0.0.0.MAGE_ALL]),STATE_DISABLED)
!CheckStatGT(SecondNearestEnemyOfType([0.0.0.MAGE_ALL]),0,HELD)
!StateCheck(SecondNearestEnemyOfType([0.0.0.MAGE_ALL]),STATE_STONE_DEATH)
!CheckStatGT(SecondNearestEnemyOfType([0.0.0.MAGE_ALL]),0,WIZARD_SPELL_TRAP)
OR(5)
CheckStatGT(SecondNearestEnemyOfType([0.0.0.MAGE_ALL]),0,WIZARD_SPELL_IMMUNITY)
CheckStatGT(SecondNearestEnemyOfType([0.0.0.MAGE_ALL]),0,WIZARD_SPELL_DEFLECTION)
CheckStatGT(SecondNearestEnemyOfType([0.0.0.MAGE_ALL]),0,WIZARD_SPELL_TURNING)
CheckStat(SecondNearestEnemyOfType([0.0.0.MAGE_ALL]),1,CLERIC_SHIELD_OF_THE_ARCHONS)
CheckStatGT(SecondNearestEnemyOfType([0.0.0.MAGE_ALL]),0,MINORGLOBE)
!Race(SecondNearestEnemyOfType([0.0.0.MAGE_ALL]),RAKSHASA)
!Race(SecondNearestEnemyOfType([0.0.0.MAGE_ALL]),LICH)
See(SecondNearestEnemyOfType([0.0.0.MAGE_ALL]))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_SECRET_WORD)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(NearestEnemyOfType([0.0.0.MAGE_ALL]),STATE_DISABLED)
!CheckStatGT(NearestEnemyOfType([0.0.0.MAGE_ALL]),0,HELD)
!StateCheck(NearestEnemyOfType([0.0.0.MAGE_ALL]),STATE_STONE_DEATH)
!CheckStatGT(NearestEnemyOfType([0.0.0.MAGE_ALL]),0,WIZARD_SPELL_TRAP)
OR(5)
CheckStatGT(NearestEnemyOfType([0.0.0.MAGE_ALL]),0,WIZARD_SPELL_IMMUNITY)
CheckStatGT(NearestEnemyOfType([0.0.0.MAGE_ALL]),0,WIZARD_SPELL_DEFLECTION)
CheckStatGT(NearestEnemyOfType([0.0.0.MAGE_ALL]),0,WIZARD_SPELL_TURNING)
CheckStat(NearestEnemyOfType([0.0.0.MAGE_ALL]),1,CLERIC_SHIELD_OF_THE_ARCHONS)
CheckStatGT(NearestEnemyOfType([0.0.0.MAGE_ALL]),0,MINORGLOBE)
!Race(NearestEnemyOfType([0.0.0.MAGE_ALL]),RAKSHASA)
!Race(NearestEnemyOfType([0.0.0.MAGE_ALL]),LICH)
See(NearestEnemyOfType([0.0.0.MAGE_ALL]))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_SECRET_WORD)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(SecondNearestEnemyOfType([0.0.0.MAGE]),STATE_DISABLED)
!CheckStatGT(SecondNearestEnemyOfType([0.0.0.MAGE]),0,HELD)
!StateCheck(SecondNearestEnemyOfType([0.0.0.MAGE]),STATE_STONE_DEATH)
!CheckStatGT(SecondNearestEnemyOfType([0.0.0.MAGE]),0,WIZARD_SPELL_TRAP)
OR(5)
CheckStatGT(SecondNearestEnemyOfType([0.0.0.MAGE]),0,WIZARD_SPELL_IMMUNITY)
CheckStatGT(SecondNearestEnemyOfType([0.0.0.MAGE]),0,WIZARD_SPELL_DEFLECTION)
CheckStatGT(SecondNearestEnemyOfType([0.0.0.MAGE]),0,WIZARD_SPELL_TURNING)
CheckStat(SecondNearestEnemyOfType([0.0.0.MAGE]),1,CLERIC_SHIELD_OF_THE_ARCHONS)
CheckStatGT(SecondNearestEnemyOfType([0.0.0.MAGE]),0,MINORGLOBE)
!Race(SecondNearestEnemyOfType([0.0.0.MAGE]),RAKSHASA)
!Race(SecondNearestEnemyOfType([0.0.0.MAGE]),LICH)
See(SecondNearestEnemyOfType([0.0.0.MAGE]))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_SECRET_WORD)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(NearestEnemyOfType([0.0.0.MAGE]),STATE_DISABLED)
!CheckStatGT(NearestEnemyOfType([0.0.0.MAGE]),0,HELD)
!StateCheck(NearestEnemyOfType([0.0.0.MAGE]),STATE_STONE_DEATH)
!CheckStatGT(NearestEnemyOfType([0.0.0.MAGE]),0,WIZARD_SPELL_TRAP)
OR(5)
CheckStatGT(NearestEnemyOfType([0.0.0.MAGE]),0,WIZARD_SPELL_IMMUNITY)
CheckStatGT(NearestEnemyOfType([0.0.0.MAGE]),0,WIZARD_SPELL_DEFLECTION)
CheckStatGT(NearestEnemyOfType([0.0.0.MAGE]),0,WIZARD_SPELL_TURNING)
CheckStat(NearestEnemyOfType([0.0.0.MAGE]),1,CLERIC_SHIELD_OF_THE_ARCHONS)
CheckStatGT(NearestEnemyOfType([0.0.0.MAGE]),0,MINORGLOBE)
!Race(NearestEnemyOfType([0.0.0.MAGE]),RAKSHASA)
!Race(NearestEnemyOfType([0.0.0.MAGE]),LICH)
See(NearestEnemyOfType([0.0.0.MAGE]))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_SECRET_WORD)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
!CheckStatGT(LastSeenBy(Myself),0,HELD)
!StateCheck(LastSeenBy(Myself),STATE_STONE_DEATH)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
OR(5)
CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_IMMUNITY)
CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
!Race(LastSeenBy(Myself),RAKSHASA)
!Race(LastSeenBy(Myself),LICH)
See(LastSeenBy(Myself))
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
Spell(LastSeenBy(Myself),WIZARD_SECRET_WORD)
RESPONSE #33
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_BREACH)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SixthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStat(SixthNearestEnemyOf(Myself),1,WIZARD_SPELL_IMMUNITY)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,HELD)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_STONE_DEATH)
OR(5)
CheckStatGT(SixthNearestEnemyOf(Myself),0,TRUE_SIGHT)
CheckStatGT(SixthNearestEnemyOf(Myself),0,STONESKINS)
CheckStatGT(SixthNearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
CheckStatGT(SixthNearestEnemyOf(Myself),0,CLERIC_FREE_ACTION)
CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_RESIST_FEAR)
!Race(SixthNearestEnemyOf(Myself),RAKSHASA)
!Race(SixthNearestEnemyOf(Myself),LICH)
See(SixthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_BREACH)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(FifthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStat(FifthNearestEnemyOf(Myself),1,WIZARD_SPELL_IMMUNITY)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_STONE_DEATH)
OR(5)
CheckStatGT(FifthNearestEnemyOf(Myself),0,TRUE_SIGHT)
CheckStatGT(FifthNearestEnemyOf(Myself),0,STONESKINS)
CheckStatGT(FifthNearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
CheckStatGT(FifthNearestEnemyOf(Myself),0,CLERIC_FREE_ACTION)
CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_RESIST_FEAR)
!Race(FifthNearestEnemyOf(Myself),RAKSHASA)
!Race(FifthNearestEnemyOf(Myself),LICH)
See(FifthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_BREACH)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(FourthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStat(FourthNearestEnemyOf(Myself),1,WIZARD_SPELL_IMMUNITY)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_STONE_DEATH)
OR(5)
CheckStatGT(FourthNearestEnemyOf(Myself),0,TRUE_SIGHT)
CheckStatGT(FourthNearestEnemyOf(Myself),0,STONESKINS)
CheckStatGT(FourthNearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
CheckStatGT(FourthNearestEnemyOf(Myself),0,CLERIC_FREE_ACTION)
CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_RESIST_FEAR)
!Race(FourthNearestEnemyOf(Myself),RAKSHASA)
!Race(FourthNearestEnemyOf(Myself),LICH)
See(FourthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_BREACH)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(ThirdNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStat(ThirdNearestEnemyOf(Myself),1,WIZARD_SPELL_IMMUNITY)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,HELD)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STONE_DEATH)
OR(5)
CheckStatGT(ThirdNearestEnemyOf(Myself),0,TRUE_SIGHT)
CheckStatGT(ThirdNearestEnemyOf(Myself),0,STONESKINS)
CheckStatGT(ThirdNearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
CheckStatGT(ThirdNearestEnemyOf(Myself),0,CLERIC_FREE_ACTION)
CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_RESIST_FEAR)
!Race(ThirdNearestEnemyOf(Myself),RAKSHASA)
!Race(ThirdNearestEnemyOf(Myself),LICH)
See(ThirdNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_BREACH)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SecondNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStat(SecondNearestEnemyOf(Myself),1,WIZARD_SPELL_IMMUNITY)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,HELD)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_STONE_DEATH)
OR(5)
CheckStatGT(SecondNearestEnemyOf(Myself),0,TRUE_SIGHT)
CheckStatGT(SecondNearestEnemyOf(Myself),0,STONESKINS)
CheckStatGT(SecondNearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
CheckStatGT(SecondNearestEnemyOf(Myself),0,CLERIC_FREE_ACTION)
CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_RESIST_FEAR)
!Race(SecondNearestEnemyOf(Myself),RAKSHASA)
!Race(SecondNearestEnemyOf(Myself),LICH)
See(SecondNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_BREACH)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(NearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStat(NearestEnemyOf(Myself),1,WIZARD_SPELL_IMMUNITY)
!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(NearestEnemyOf(Myself),0,HELD)
!StateCheck(NearestEnemyOf(Myself),STATE_STONE_DEATH)
OR(5)
CheckStatGT(NearestEnemyOf(Myself),0,TRUE_SIGHT)
CheckStatGT(NearestEnemyOf(Myself),0,STONESKINS)
CheckStatGT(NearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
CheckStatGT(NearestEnemyOf(Myself),0,CLERIC_FREE_ACTION)
CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_RESIST_FEAR)
!Race(NearestEnemyOf(Myself),RAKSHASA)
!Race(NearestEnemyOf(Myself),LICH)
See(NearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_BREACH)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_IMMUNITY)
!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
!CheckStatGT(LastSeenBy(Myself),0,HELD)
!StateCheck(LastSeenBy(Myself),STATE_STONE_DEATH)
OR(5)
CheckStatGT(LastSeenBy(Myself),0,TRUE_SIGHT)
CheckStatGT(LastSeenBy(Myself),0,STONESKINS)
CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
CheckStatGT(LastSeenBy(Myself),0,WIZARD_RESIST_FEAR)
!Race(LastSeenBy(Myself),RAKSHASA)
!Race(LastSeenBy(Myself),LICH)
See(LastSeenBy(Myself))
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
Spell(LastSeenBy(Myself),WIZARD_BREACH)
RESPONSE #33
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_GREATER_MALISON)
See(NearestEnemyOf(Myself))
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(NearestEnemyOf(Myself),0,HELD)
!StateCheck(NearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(NearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(NearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!Race(NearestEnemyOf(Myself),RAKSHASA)
!Race(NearestEnemyOf(Myself),LICH)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
Spell(NearestEnemyOf(Myself),WIZARD_GREATER_MALISON)
RESPONSE #33
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_GREATER_MALISON)
See(SecondNearestEnemyOf(Myself))
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,HELD)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SecondNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(SecondNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!Race(SecondNearestEnemyOf(Myself),RAKSHASA)
!Race(SecondNearestEnemyOf(Myself),LICH)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
Spell(SecondNearestEnemyOf(Myself),WIZARD_GREATER_MALISON)
RESPONSE #33
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_GREATER_MALISON)
See(ThirdNearestEnemyOf(Myself))
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,HELD)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(ThirdNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(ThirdNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!Race(ThirdNearestEnemyOf(Myself),RAKSHASA)
!Race(ThirdNearestEnemyOf(Myself),LICH)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
Spell(ThirdNearestEnemyOf(Myself),WIZARD_GREATER_MALISON)
RESPONSE #33
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_GREATER_MALISON)
See(FourthNearestEnemyOf(Myself))
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FourthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(FourthNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!Race(FourthNearestEnemyOf(Myself),RAKSHASA)
!Race(FourthNearestEnemyOf(Myself),LICH)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
Spell(FourthNearestEnemyOf(Myself),WIZARD_GREATER_MALISON)
RESPONSE #33
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_GREATER_MALISON)
See(FifthNearestEnemyOf(Myself))
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FifthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(FifthNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!Race(FifthNearestEnemyOf(Myself),RAKSHASA)
!Race(FifthNearestEnemyOf(Myself),LICH)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
Spell(FifthNearestEnemyOf(Myself),WIZARD_GREATER_MALISON)
RESPONSE #33
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_GREATER_MALISON)
See(SixthNearestEnemyOf(Myself))
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,HELD)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SixthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(SixthNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!Race(SixthNearestEnemyOf(Myself),RAKSHASA)
!Race(SixthNearestEnemyOf(Myself),LICH)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
Spell(SixthNearestEnemyOf(Myself),WIZARD_GREATER_MALISON)
RESPONSE #33
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_CHAOS)
See(NearestEnemyOf(Myself))
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(NearestEnemyOf(Myself),0,HELD)
!StateCheck(NearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(NearestEnemyOf(Myself),50,RESISTMAGIC)
!General(NearestEnemyOf(Myself),UNDEAD)
!Race(NearestEnemyOf(Myself),SLIME)
!Race(NearestEnemyOf(Myself),DEMONIC)
!Race(NearestEnemyOf(Myself),TROLL)
!Race(NearestEnemyOf(Myself),UMBERHULK)
!CheckStatGT(NearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(NearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItem("ipsion",NearestEnemyOf(Myself))
!HasItemEquiped("leat20",NearestEnemyOf(Myself))
!HasItemEquiped("shld25",NearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h54",NearestEnemyOf(Myself))
!HasItemEquipedReal("sw2h14",NearestEnemyOf(Myself))
!HasItemEquipedReal("sw2h21",NearestEnemyOf(Myself))
!CheckStat(NearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!Race(NearestEnemyOf(Myself),RAKSHASA)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
Spell(NearestEnemyOf(Myself),WIZARD_CHAOS)
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_CHAOS)
See(SecondNearestEnemyOf(Myself))
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,HELD)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SecondNearestEnemyOf(Myself),50,RESISTMAGIC)
!General(SecondNearestEnemyOf(Myself),UNDEAD)
!Race(SecondNearestEnemyOf(Myself),SLIME)
!Race(SecondNearestEnemyOf(Myself),DEMONIC)
!Race(SecondNearestEnemyOf(Myself),TROLL)
!Race(SecondNearestEnemyOf(Myself),UMBERHULK)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(SecondNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItem("ipsion",SecondNearestEnemyOf(Myself))
!HasItemEquiped("leat20",SecondNearestEnemyOf(Myself))
!HasItemEquiped("shld25",SecondNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h54",SecondNearestEnemyOf(Myself))
!HasItemEquipedReal("sw2h14",SecondNearestEnemyOf(Myself))
!HasItemEquipedReal("sw2h21",SecondNearestEnemyOf(Myself))
!CheckStat(SecondNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!Race(SecondNearestEnemyOf(Myself),RAKSHASA)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
Spell(SecondNearestEnemyOf(Myself),WIZARD_CHAOS)
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_CHAOS)
See(ThirdNearestEnemyOf(Myself))
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,HELD)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(ThirdNearestEnemyOf(Myself),50,RESISTMAGIC)
!General(ThirdNearestEnemyOf(Myself),UNDEAD)
!Race(ThirdNearestEnemyOf(Myself),SLIME)
!Race(ThirdNearestEnemyOf(Myself),DEMONIC)
!Race(ThirdNearestEnemyOf(Myself),TROLL)
!Race(ThirdNearestEnemyOf(Myself),UMBERHULK)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(ThirdNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItem("ipsion",ThirdNearestEnemyOf(Myself))
!HasItemEquiped("leat20",ThirdNearestEnemyOf(Myself))
!HasItemEquiped("shld25",ThirdNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h54",ThirdNearestEnemyOf(Myself))
!HasItemEquipedReal("sw2h14",ThirdNearestEnemyOf(Myself))
!HasItemEquipedReal("sw2h21",ThirdNearestEnemyOf(Myself))
!CheckStat(ThirdNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!Race(ThirdNearestEnemyOf(Myself),RAKSHASA)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
Spell(ThirdNearestEnemyOf(Myself),WIZARD_CHAOS)
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_CHAOS)
See(FourthNearestEnemyOf(Myself))
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FourthNearestEnemyOf(Myself),50,RESISTMAGIC)
!General(FourthNearestEnemyOf(Myself),UNDEAD)
!Race(FourthNearestEnemyOf(Myself),SLIME)
!Race(FourthNearestEnemyOf(Myself),DEMONIC)
!Race(FourthNearestEnemyOf(Myself),TROLL)
!Race(FourthNearestEnemyOf(Myself),UMBERHULK)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(FourthNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItem("ipsion",FourthNearestEnemyOf(Myself))
!HasItemEquiped("leat20",FourthNearestEnemyOf(Myself))
!HasItemEquiped("shld25",FourthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h54",FourthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw2h14",FourthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw2h21",FourthNearestEnemyOf(Myself))
!CheckStat(FourthNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!Race(FourthNearestEnemyOf(Myself),RAKSHASA)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
Spell(FourthNearestEnemyOf(Myself),WIZARD_CHAOS)
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_CHAOS)
See(FifthNearestEnemyOf(Myself))
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FifthNearestEnemyOf(Myself),50,RESISTMAGIC)
!General(FifthNearestEnemyOf(Myself),UNDEAD)
!Race(FifthNearestEnemyOf(Myself),SLIME)
!Race(FifthNearestEnemyOf(Myself),DEMONIC)
!Race(FifthNearestEnemyOf(Myself),TROLL)
!Race(FifthNearestEnemyOf(Myself),UMBERHULK)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(FifthNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItem("ipsion",FifthNearestEnemyOf(Myself))
!HasItemEquiped("leat20",FifthNearestEnemyOf(Myself))
!HasItemEquiped("shld25",FifthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h54",FifthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw2h14",FifthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw2h21",FifthNearestEnemyOf(Myself))
!CheckStat(FifthNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!Race(FifthNearestEnemyOf(Myself),RAKSHASA)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
Spell(FifthNearestEnemyOf(Myself),WIZARD_CHAOS)
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_CHAOS)
See(SixthNearestEnemyOf(Myself))
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,HELD)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SixthNearestEnemyOf(Myself),50,RESISTMAGIC)
!General(SixthNearestEnemyOf(Myself),UNDEAD)
!Race(SixthNearestEnemyOf(Myself),SLIME)
!Race(SixthNearestEnemyOf(Myself),DEMONIC)
!Race(SixthNearestEnemyOf(Myself),TROLL)
!Race(SixthNearestEnemyOf(Myself),UMBERHULK)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(SixthNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItem("ipsion",SixthNearestEnemyOf(Myself))
!HasItemEquiped("leat20",SixthNearestEnemyOf(Myself))
!HasItemEquiped("shld25",SixthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h54",SixthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw2h14",SixthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw2h21",SixthNearestEnemyOf(Myself))
!CheckStat(SixthNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!Race(SixthNearestEnemyOf(Myself),RAKSHASA)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
Spell(SixthNearestEnemyOf(Myself),WIZARD_CHAOS)
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_CHAIN_LIGHTNING)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,HELD)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SixthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(SixthNearestEnemyOf(Myself),50,RESISTELECTRICITY)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SixthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStat(SixthNearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
!HasItemEquiped("clck24",SixthNearestEnemyOf(Myself))
!HasItemEquiped("clck26",SixthNearestEnemyOf(Myself))
!Race(SixthNearestEnemyOf(Myself),RAKSHASA)
See(SixthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_CHAIN_LIGHTNING)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FifthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(FifthNearestEnemyOf(Myself),50,RESISTELECTRICITY)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(FifthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStat(FifthNearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
!HasItemEquiped("clck24",FifthNearestEnemyOf(Myself))
!HasItemEquiped("clck26",FifthNearestEnemyOf(Myself))
!Race(FifthNearestEnemyOf(Myself),RAKSHASA)
See(FifthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_CHAIN_LIGHTNING)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FourthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(FourthNearestEnemyOf(Myself),50,RESISTELECTRICITY)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(FourthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStat(FourthNearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
!HasItemEquiped("clck24",FourthNearestEnemyOf(Myself))
!HasItemEquiped("clck26",FourthNearestEnemyOf(Myself))
!Race(FourthNearestEnemyOf(Myself),RAKSHASA)
See(FourthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_CHAIN_LIGHTNING)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,HELD)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(ThirdNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(ThirdNearestEnemyOf(Myself),50,RESISTELECTRICITY)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(ThirdNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStat(ThirdNearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
!HasItemEquiped("clck24",ThirdNearestEnemyOf(Myself))
!HasItemEquiped("clck26",ThirdNearestEnemyOf(Myself))
!Race(ThirdNearestEnemyOf(Myself),RAKSHASA)
See(ThirdNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_CHAIN_LIGHTNING)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,HELD)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SecondNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(SecondNearestEnemyOf(Myself),50,RESISTELECTRICITY)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SecondNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStat(SecondNearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
!HasItemEquiped("clck24",SecondNearestEnemyOf(Myself))
!HasItemEquiped("clck26",SecondNearestEnemyOf(Myself))
!Race(SecondNearestEnemyOf(Myself),RAKSHASA)
See(SecondNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_CHAIN_LIGHTNING)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(NearestEnemyOf(Myself),0,HELD)
!StateCheck(NearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(NearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(NearestEnemyOf(Myself),50,RESISTELECTRICITY)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(NearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStat(NearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
!HasItemEquiped("clck24",NearestEnemyOf(Myself))
!HasItemEquiped("clck26",NearestEnemyOf(Myself))
!Race(NearestEnemyOf(Myself),RAKSHASA)
See(NearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_CHAIN_LIGHTNING)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
!CheckStatGT(LastSeenBy(Myself),0,HELD)
!StateCheck(LastSeenBy(Myself),STATE_STONE_DEATH)
!CheckStatGT(LastSeenBy(Myself),50,RESISTMAGIC)
!CheckStatGT(LastSeenBy(Myself),50,RESISTELECTRICITY)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
!HasItemEquiped("clck24",LastSeenBy(Myself))
!HasItemEquiped("clck26",LastSeenBy(Myself))
!Race(LastSeenBy(Myself),RAKSHASA)
See(LastSeenBy(Myself))
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
Spell(LastSeenBy(Myself),WIZARD_CHAIN_LIGHTNING)
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_DOMINATION)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,HELD)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SixthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SixthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStat(SixthNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!General(SixthNearestEnemyOf(Myself),UNDEAD)
!Race(SixthNearestEnemyOf(Myself),ELF)
!Race(SixthNearestEnemyOf(Myself),GOLEM)
!Race(SixthNearestEnemyOf(Myself),SLIME)
!Race(SixthNearestEnemyOf(Myself),DEMONIC)
!Race(SixthNearestEnemyOf(Myself),TROLL)
!Class(SixthNearestEnemyOf(Myself),MONK)
!Kit(SixthNearestEnemyOf(Myself),INQUISITOR)
!Kit(SixthNearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(SixthNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("helm06",SixthNearestEnemyOf(Myself))
!HasItemEquiped("ipsion",SixthNearestEnemyOf(Myself))
!HasItemEquipedReal("miscbc",SixthNearestEnemyOf(Myself))
!HasItemEquiped("npchan",SixthNearestEnemyOf(Myself))
!HasItemEquiped("shld25",SixthNearestEnemyOf(Myself))
!HasItemEquipedReal("sper07",SixthNearestEnemyOf(Myself))
!HasItemEquipedReal("staf11",SixthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h35",SixthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h54",SixthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw2h14",SixthNearestEnemyOf(Myself))
OR(2)
!Gender(SixthNearestEnemyOf(Myself),SUMMONED)
!Gender(SixthNearestEnemyOf(Myself),20)
!Race(SixthNearestEnemyOf(Myself),RAKSHASA)
See(SixthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_DOMINATION)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FifthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(FifthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStat(FifthNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!General(FifthNearestEnemyOf(Myself),UNDEAD)
!Race(FifthNearestEnemyOf(Myself),ELF)
!Race(FifthNearestEnemyOf(Myself),GOLEM)
!Race(FifthNearestEnemyOf(Myself),SLIME)
!Race(FifthNearestEnemyOf(Myself),DEMONIC)
!Race(FifthNearestEnemyOf(Myself),TROLL)
!Class(FifthNearestEnemyOf(Myself),MONK)
!Kit(FifthNearestEnemyOf(Myself),INQUISITOR)
!Kit(FifthNearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(FifthNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("helm06",FifthNearestEnemyOf(Myself))
!HasItemEquiped("ipsion",FifthNearestEnemyOf(Myself))
!HasItemEquipedReal("miscbc",FifthNearestEnemyOf(Myself))
!HasItemEquiped("npchan",FifthNearestEnemyOf(Myself))
!HasItemEquiped("shld25",FifthNearestEnemyOf(Myself))
!HasItemEquipedReal("sper07",FifthNearestEnemyOf(Myself))
!HasItemEquipedReal("staf11",FifthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h35",FifthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h54",FifthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw2h14",FifthNearestEnemyOf(Myself))
OR(2)
!Gender(FifthNearestEnemyOf(Myself),SUMMONED)
!Gender(FifthNearestEnemyOf(Myself),20)
!Race(FifthNearestEnemyOf(Myself),RAKSHASA)
See(FifthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_DOMINATION)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FourthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(FourthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStat(FourthNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!General(FourthNearestEnemyOf(Myself),UNDEAD)
!Race(FourthNearestEnemyOf(Myself),ELF)
!Race(FourthNearestEnemyOf(Myself),GOLEM)
!Race(FourthNearestEnemyOf(Myself),SLIME)
!Race(FourthNearestEnemyOf(Myself),DEMONIC)
!Race(FourthNearestEnemyOf(Myself),TROLL)
!Class(FourthNearestEnemyOf(Myself),MONK)
!Kit(FourthNearestEnemyOf(Myself),INQUISITOR)
!Kit(FourthNearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(FourthNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("helm06",FourthNearestEnemyOf(Myself))
!HasItemEquiped("ipsion",FourthNearestEnemyOf(Myself))
!HasItemEquipedReal("miscbc",FourthNearestEnemyOf(Myself))
!HasItemEquiped("npchan",FourthNearestEnemyOf(Myself))
!HasItemEquiped("shld25",FourthNearestEnemyOf(Myself))
!HasItemEquipedReal("sper07",FourthNearestEnemyOf(Myself))
!HasItemEquipedReal("staf11",FourthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h35",FourthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h54",FourthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw2h14",FourthNearestEnemyOf(Myself))
OR(2)
!Gender(FourthNearestEnemyOf(Myself),SUMMONED)
!Gender(FourthNearestEnemyOf(Myself),20)
!Race(FourthNearestEnemyOf(Myself),RAKSHASA)
See(FourthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_DOMINATION)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,HELD)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(ThirdNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(ThirdNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStat(ThirdNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!General(ThirdNearestEnemyOf(Myself),UNDEAD)
!Race(ThirdNearestEnemyOf(Myself),ELF)
!Race(ThirdNearestEnemyOf(Myself),GOLEM)
!Race(ThirdNearestEnemyOf(Myself),SLIME)
!Race(ThirdNearestEnemyOf(Myself),DEMONIC)
!Race(ThirdNearestEnemyOf(Myself),TROLL)
!Class(ThirdNearestEnemyOf(Myself),MONK)
!Kit(ThirdNearestEnemyOf(Myself),INQUISITOR)
!Kit(ThirdNearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(ThirdNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("helm06",ThirdNearestEnemyOf(Myself))
!HasItemEquiped("ipsion",ThirdNearestEnemyOf(Myself))
!HasItemEquipedReal("miscbc",ThirdNearestEnemyOf(Myself))
!HasItemEquiped("npchan",ThirdNearestEnemyOf(Myself))
!HasItemEquiped("shld25",ThirdNearestEnemyOf(Myself))
!HasItemEquipedReal("sper07",ThirdNearestEnemyOf(Myself))
!HasItemEquipedReal("staf11",ThirdNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h35",ThirdNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h54",ThirdNearestEnemyOf(Myself))
!HasItemEquipedReal("sw2h14",ThirdNearestEnemyOf(Myself))
OR(2)
!Gender(ThirdNearestEnemyOf(Myself),SUMMONED)
!Gender(ThirdNearestEnemyOf(Myself),20)
!Race(ThirdNearestEnemyOf(Myself),RAKSHASA)
See(ThirdNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_DOMINATION)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,HELD)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SecondNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SecondNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStat(SecondNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!General(SecondNearestEnemyOf(Myself),UNDEAD)
!Race(SecondNearestEnemyOf(Myself),ELF)
!Race(SecondNearestEnemyOf(Myself),GOLEM)
!Race(SecondNearestEnemyOf(Myself),SLIME)
!Race(SecondNearestEnemyOf(Myself),DEMONIC)
!Race(SecondNearestEnemyOf(Myself),TROLL)
!Class(SecondNearestEnemyOf(Myself),MONK)
!Kit(SecondNearestEnemyOf(Myself),INQUISITOR)
!Kit(SecondNearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(SecondNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("helm06",SecondNearestEnemyOf(Myself))
!HasItemEquiped("ipsion",SecondNearestEnemyOf(Myself))
!HasItemEquipedReal("miscbc",SecondNearestEnemyOf(Myself))
!HasItemEquiped("npchan",SecondNearestEnemyOf(Myself))
!HasItemEquiped("shld25",SecondNearestEnemyOf(Myself))
!HasItemEquipedReal("sper07",SecondNearestEnemyOf(Myself))
!HasItemEquipedReal("staf11",SecondNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h35",SecondNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h54",SecondNearestEnemyOf(Myself))
!HasItemEquipedReal("sw2h14",SecondNearestEnemyOf(Myself))
OR(2)
!Gender(SecondNearestEnemyOf(Myself),SUMMONED)
!Gender(SecondNearestEnemyOf(Myself),20)
!Race(SecondNearestEnemyOf(Myself),RAKSHASA)
See(SecondNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_DOMINATION)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(NearestEnemyOf(Myself),0,HELD)
!StateCheck(NearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(NearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(NearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStat(NearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!General(NearestEnemyOf(Myself),UNDEAD)
!Race(NearestEnemyOf(Myself),ELF)
!Race(NearestEnemyOf(Myself),GOLEM)
!Race(NearestEnemyOf(Myself),SLIME)
!Race(NearestEnemyOf(Myself),DEMONIC)
!Race(NearestEnemyOf(Myself),TROLL)
!Class(NearestEnemyOf(Myself),MONK)
!Kit(NearestEnemyOf(Myself),INQUISITOR)
!Kit(NearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(NearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(NearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("helm06",NearestEnemyOf(Myself))
!HasItemEquiped("ipsion",NearestEnemyOf(Myself))
!HasItemEquipedReal("miscbc",NearestEnemyOf(Myself))
!HasItemEquiped("npchan",NearestEnemyOf(Myself))
!HasItemEquiped("shld25",NearestEnemyOf(Myself))
!HasItemEquipedReal("sper07",NearestEnemyOf(Myself))
!HasItemEquipedReal("staf11",NearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h35",NearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h54",NearestEnemyOf(Myself))
!HasItemEquipedReal("sw2h14",NearestEnemyOf(Myself))
OR(2)
!Gender(NearestEnemyOf(Myself),SUMMONED)
!Gender(NearestEnemyOf(Myself),20)
!Race(NearestEnemyOf(Myself),RAKSHASA)
See(NearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_DOMINATION)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
!CheckStatGT(LastSeenBy(Myself),0,HELD)
!StateCheck(LastSeenBy(Myself),STATE_STONE_DEATH)
!CheckStatGT(LastSeenBy(Myself),50,RESISTMAGIC)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
!General(LastSeenBy(Myself),UNDEAD)
!Race(LastSeenBy(Myself),ELF)
!Race(LastSeenBy(Myself),GOLEM)
!Race(LastSeenBy(Myself),SLIME)
!Race(LastSeenBy(Myself),DEMONIC)
!Race(LastSeenBy(Myself),TROLL)
!Class(LastSeenBy(Myself),MONK)
!Kit(LastSeenBy(Myself),INQUISITOR)
!Kit(LastSeenBy(Myself),CAVALIER)
!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("helm06",LastSeenBy(Myself))
!HasItemEquiped("ipsion",LastSeenBy(Myself))
!HasItemEquipedReal("miscbc",LastSeenBy(Myself))
!HasItemEquiped("npchan",LastSeenBy(Myself))
!HasItemEquiped("shld25",LastSeenBy(Myself))
!HasItemEquipedReal("sper07",LastSeenBy(Myself))
!HasItemEquipedReal("staf11",LastSeenBy(Myself))
!HasItemEquipedReal("sw1h35",LastSeenBy(Myself))
!HasItemEquipedReal("sw1h54",LastSeenBy(Myself))
!HasItemEquipedReal("sw2h14",LastSeenBy(Myself))
OR(2)
!Gender(LastSeenBy(Myself),SUMMONED)
!Gender(LastSeenBy(Myself),20)
!Race(LastSeenBy(Myself),RAKSHASA)
See(LastSeenBy(Myself))
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
Spell(LastSeenBy(Myself),WIZARD_DOMINATION)
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_HOLD_MONSTER)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,HELD)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SixthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SixthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(SixthNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!General(SixthNearestEnemyOf(Myself),UNDEAD)
!Race(SixthNearestEnemyOf(Myself),GOLEM)
!Race(SixthNearestEnemyOf(Myself),SLIME)
!Race(SixthNearestEnemyOf(Myself),TROLL)
!Kit(SixthNearestEnemyOf(Myself),UNDEADHUNTER)
!Kit(SixthNearestEnemyOf(Myself),INQUISITOR)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,CLERIC_FREE_ACTION)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(SixthNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("shld25",SixthNearestEnemyOf(Myself))
!HasItemEquipedReal("blun30",SixthNearestEnemyOf(Myself))
!HasItemEquiped("ipsion",SixthNearestEnemyOf(Myself))
!HasItemEquiped("npplat",SixthNearestEnemyOf(Myself))
!HasItemEquiped("ring09",SixthNearestEnemyOf(Myself))
!HasItemEquipedReal("sper12",SixthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h27",SixthNearestEnemyOf(Myself))
OR(2)
!Gender(SixthNearestEnemyOf(Myself),SUMMONED)
!Gender(SixthNearestEnemyOf(Myself),20)
!Race(SixthNearestEnemyOf(Myself),RAKSHASA)
See(SixthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_HOLD_MONSTER)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FifthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(FifthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(FifthNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!General(FifthNearestEnemyOf(Myself),UNDEAD)
!Race(FifthNearestEnemyOf(Myself),GOLEM)
!Race(FifthNearestEnemyOf(Myself),SLIME)
!Race(FifthNearestEnemyOf(Myself),TROLL)
!Kit(FifthNearestEnemyOf(Myself),UNDEADHUNTER)
!Kit(FifthNearestEnemyOf(Myself),INQUISITOR)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,CLERIC_FREE_ACTION)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(FifthNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("shld25",FifthNearestEnemyOf(Myself))
!HasItemEquipedReal("blun30",FifthNearestEnemyOf(Myself))
!HasItemEquiped("ipsion",FifthNearestEnemyOf(Myself))
!HasItemEquiped("npplat",FifthNearestEnemyOf(Myself))
!HasItemEquiped("ring09",FifthNearestEnemyOf(Myself))
!HasItemEquipedReal("sper12",FifthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h27",FifthNearestEnemyOf(Myself))
OR(2)
!Gender(FifthNearestEnemyOf(Myself),SUMMONED)
!Gender(FifthNearestEnemyOf(Myself),20)
!Race(FifthNearestEnemyOf(Myself),RAKSHASA)
See(FifthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_HOLD_MONSTER)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FourthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(FourthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(FourthNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!General(FourthNearestEnemyOf(Myself),UNDEAD)
!Race(FourthNearestEnemyOf(Myself),GOLEM)
!Race(FourthNearestEnemyOf(Myself),SLIME)
!Race(FourthNearestEnemyOf(Myself),TROLL)
!Kit(FourthNearestEnemyOf(Myself),UNDEADHUNTER)
!Kit(FourthNearestEnemyOf(Myself),INQUISITOR)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,CLERIC_FREE_ACTION)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(FourthNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("shld25",FourthNearestEnemyOf(Myself))
!HasItemEquipedReal("blun30",FourthNearestEnemyOf(Myself))
!HasItemEquiped("ipsion",FourthNearestEnemyOf(Myself))
!HasItemEquiped("npplat",FourthNearestEnemyOf(Myself))
!HasItemEquiped("ring09",FourthNearestEnemyOf(Myself))
!HasItemEquipedReal("sper12",FourthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h27",FourthNearestEnemyOf(Myself))
OR(2)
!Gender(FourthNearestEnemyOf(Myself),SUMMONED)
!Gender(FourthNearestEnemyOf(Myself),20)
!Race(FourthNearestEnemyOf(Myself),RAKSHASA)
See(FourthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_HOLD_MONSTER)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,HELD)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(ThirdNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(ThirdNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(ThirdNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!General(ThirdNearestEnemyOf(Myself),UNDEAD)
!Race(ThirdNearestEnemyOf(Myself),GOLEM)
!Race(ThirdNearestEnemyOf(Myself),SLIME)
!Race(ThirdNearestEnemyOf(Myself),TROLL)
!Kit(ThirdNearestEnemyOf(Myself),UNDEADHUNTER)
!Kit(ThirdNearestEnemyOf(Myself),INQUISITOR)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,CLERIC_FREE_ACTION)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(ThirdNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("shld25",ThirdNearestEnemyOf(Myself))
!HasItemEquipedReal("blun30",ThirdNearestEnemyOf(Myself))
!HasItemEquiped("ipsion",ThirdNearestEnemyOf(Myself))
!HasItemEquiped("npplat",ThirdNearestEnemyOf(Myself))
!HasItemEquiped("ring09",ThirdNearestEnemyOf(Myself))
!HasItemEquipedReal("sper12",ThirdNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h27",ThirdNearestEnemyOf(Myself))
OR(2)
!Gender(ThirdNearestEnemyOf(Myself),SUMMONED)
!Gender(ThirdNearestEnemyOf(Myself),20)
!Race(ThirdNearestEnemyOf(Myself),RAKSHASA)
See(ThirdNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_HOLD_MONSTER)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,HELD)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SecondNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SecondNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(SecondNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!General(SecondNearestEnemyOf(Myself),UNDEAD)
!Race(SecondNearestEnemyOf(Myself),GOLEM)
!Race(SecondNearestEnemyOf(Myself),SLIME)
!Race(SecondNearestEnemyOf(Myself),TROLL)
!Kit(SecondNearestEnemyOf(Myself),UNDEADHUNTER)
!Kit(SecondNearestEnemyOf(Myself),INQUISITOR)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,CLERIC_FREE_ACTION)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(SecondNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("shld25",SecondNearestEnemyOf(Myself))
!HasItemEquipedReal("blun30",SecondNearestEnemyOf(Myself))
!HasItemEquiped("ipsion",SecondNearestEnemyOf(Myself))
!HasItemEquiped("npplat",SecondNearestEnemyOf(Myself))
!HasItemEquiped("ring09",SecondNearestEnemyOf(Myself))
!HasItemEquipedReal("sper12",SecondNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h27",SecondNearestEnemyOf(Myself))
OR(2)
!Gender(SecondNearestEnemyOf(Myself),SUMMONED)
!Gender(SecondNearestEnemyOf(Myself),20)
!Race(SecondNearestEnemyOf(Myself),RAKSHASA)
See(SecondNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_HOLD_MONSTER)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(NearestEnemyOf(Myself),0,HELD)
!StateCheck(NearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(NearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(NearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(NearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(NearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!General(NearestEnemyOf(Myself),UNDEAD)
!Race(NearestEnemyOf(Myself),GOLEM)
!Race(NearestEnemyOf(Myself),SLIME)
!Race(NearestEnemyOf(Myself),TROLL)
!Kit(NearestEnemyOf(Myself),UNDEADHUNTER)
!Kit(NearestEnemyOf(Myself),INQUISITOR)
!CheckStatGT(NearestEnemyOf(Myself),0,CLERIC_FREE_ACTION)
!CheckStatGT(NearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(NearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("shld25",NearestEnemyOf(Myself))
!HasItemEquipedReal("blun30",NearestEnemyOf(Myself))
!HasItemEquiped("ipsion",NearestEnemyOf(Myself))
!HasItemEquiped("npplat",NearestEnemyOf(Myself))
!HasItemEquiped("ring09",NearestEnemyOf(Myself))
!HasItemEquipedReal("sper12",NearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h27",NearestEnemyOf(Myself))
OR(2)
!Gender(NearestEnemyOf(Myself),SUMMONED)
!Gender(NearestEnemyOf(Myself),20)
!Race(NearestEnemyOf(Myself),RAKSHASA)
See(NearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_HOLD_MONSTER)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
!CheckStatGT(LastSeenBy(Myself),0,HELD)
!StateCheck(LastSeenBy(Myself),STATE_STONE_DEATH)
!CheckStatGT(LastSeenBy(Myself),50,RESISTMAGIC)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
!General(LastSeenBy(Myself),UNDEAD)
!Race(LastSeenBy(Myself),GOLEM)
!Race(LastSeenBy(Myself),SLIME)
!Race(LastSeenBy(Myself),TROLL)
!Kit(LastSeenBy(Myself),UNDEADHUNTER)
!Kit(LastSeenBy(Myself),INQUISITOR)
!CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("shld25",LastSeenBy(Myself))
!HasItemEquipedReal("blun30",LastSeenBy(Myself))
!HasItemEquiped("ipsion",LastSeenBy(Myself))
!HasItemEquiped("npplat",LastSeenBy(Myself))
!HasItemEquiped("ring09",LastSeenBy(Myself))
!HasItemEquipedReal("sper12",LastSeenBy(Myself))
!HasItemEquipedReal("sw1h27",LastSeenBy(Myself))
OR(2)
!Gender(LastSeenBy(Myself),SUMMONED)
!Gender(LastSeenBy(Myself),20)
!Race(LastSeenBy(Myself),RAKSHASA)
See(LastSeenBy(Myself))
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
Spell(LastSeenBy(Myself),WIZARD_HOLD_MONSTER)
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(NearestEnemyOf(Myself))
!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(NearestEnemyOf(Myself),0,HELD)
!StateCheck(NearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(NearestEnemyOf(Myself),75,RESISTMAGIC)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(NearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStat(NearestEnemyOf(Myself),8,WIZARD_SPELL_IMMUNITY)
Range(NearestEnemyOf(Myself),10)
CheckStatGT(NearestEnemyOf(Myself),3,SAVEVSSPELL)
!Race(NearestEnemyOf(Myself),GIANT)
!Race(NearestEnemyOf(Myself),DRAGON)
!Race(NearestEnemyOf(Myself),DEMONIC)
!Class(NearestEnemyOf(Myself),ELEMENTAL_EARTH)
!Class(NearestEnemyOf(Myself),ELEMENTAL_FIRE)
!Class(NearestEnemyOf(Myself),ELEMENTAL_AIR)
!Name("finmel01",NearestEnemyOf(Myself))

!Race(NearestEnemyOf(Myself),RAKSHASA)
!Race(NearestEnemyOf(Myself),LICH)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("fl#telki",NearestEnemyOf(Myself))
RESPONSE #50
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(SecondNearestEnemyOf(Myself))
!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,HELD)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SecondNearestEnemyOf(Myself),75,RESISTMAGIC)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SecondNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStat(SecondNearestEnemyOf(Myself),8,WIZARD_SPELL_IMMUNITY)
Range(SecondNearestEnemyOf(Myself),10)
CheckStatGT(SecondNearestEnemyOf(Myself),3,SAVEVSSPELL)
!Race(SecondNearestEnemyOf(Myself),GIANT)
!Race(SecondNearestEnemyOf(Myself),DRAGON)
!Race(SecondNearestEnemyOf(Myself),DEMONIC)
!Class(SecondNearestEnemyOf(Myself),ELEMENTAL_EARTH)
!Class(SecondNearestEnemyOf(Myself),ELEMENTAL_FIRE)
!Class(SecondNearestEnemyOf(Myself),ELEMENTAL_AIR)
!Name("finmel01",SecondNearestEnemyOf(Myself))

!Race(SecondNearestEnemyOf(Myself),RAKSHASA)
!Race(SecondNearestEnemyOf(Myself),LICH)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("fl#telki",SecondNearestEnemyOf(Myself))
RESPONSE #50
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(ThirdNearestEnemyOf(Myself))
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,HELD)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(ThirdNearestEnemyOf(Myself),75,RESISTMAGIC)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(ThirdNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStat(ThirdNearestEnemyOf(Myself),8,WIZARD_SPELL_IMMUNITY)
Range(ThirdNearestEnemyOf(Myself),10)
CheckStatGT(ThirdNearestEnemyOf(Myself),3,SAVEVSSPELL)
!Race(ThirdNearestEnemyOf(Myself),GIANT)
!Race(ThirdNearestEnemyOf(Myself),DRAGON)
!Race(ThirdNearestEnemyOf(Myself),DEMONIC)
!Class(ThirdNearestEnemyOf(Myself),ELEMENTAL_EARTH)
!Class(ThirdNearestEnemyOf(Myself),ELEMENTAL_FIRE)
!Class(ThirdNearestEnemyOf(Myself),ELEMENTAL_AIR)
!Name("finmel01",ThirdNearestEnemyOf(Myself))

!Race(ThirdNearestEnemyOf(Myself),RAKSHASA)
!Race(ThirdNearestEnemyOf(Myself),LICH)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("fl#telki",ThirdNearestEnemyOf(Myself))
RESPONSE #50
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(FourthNearestEnemyOf(Myself))
!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FourthNearestEnemyOf(Myself),75,RESISTMAGIC)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(FourthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStat(FourthNearestEnemyOf(Myself),8,WIZARD_SPELL_IMMUNITY)
Range(FourthNearestEnemyOf(Myself),10)
CheckStatGT(FourthNearestEnemyOf(Myself),3,SAVEVSSPELL)
!Race(FourthNearestEnemyOf(Myself),GIANT)
!Race(FourthNearestEnemyOf(Myself),DRAGON)
!Race(FourthNearestEnemyOf(Myself),DEMONIC)
!Class(FourthNearestEnemyOf(Myself),ELEMENTAL_EARTH)
!Class(FourthNearestEnemyOf(Myself),ELEMENTAL_FIRE)
!Class(FourthNearestEnemyOf(Myself),ELEMENTAL_AIR)
!Name("finmel01",FourthNearestEnemyOf(Myself))

!Race(FourthNearestEnemyOf(Myself),RAKSHASA)
!Race(FourthNearestEnemyOf(Myself),LICH)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("fl#telki",FourthNearestEnemyOf(Myself))
RESPONSE #50
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(FifthNearestEnemyOf(Myself))
!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FifthNearestEnemyOf(Myself),75,RESISTMAGIC)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(FifthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStat(FifthNearestEnemyOf(Myself),8,WIZARD_SPELL_IMMUNITY)
Range(FifthNearestEnemyOf(Myself),10)
CheckStatGT(FifthNearestEnemyOf(Myself),3,SAVEVSSPELL)
!Race(FifthNearestEnemyOf(Myself),GIANT)
!Race(FifthNearestEnemyOf(Myself),DRAGON)
!Race(FifthNearestEnemyOf(Myself),DEMONIC)
!Class(FifthNearestEnemyOf(Myself),ELEMENTAL_EARTH)
!Class(FifthNearestEnemyOf(Myself),ELEMENTAL_FIRE)
!Class(FifthNearestEnemyOf(Myself),ELEMENTAL_AIR)
!Name("finmel01",FifthNearestEnemyOf(Myself))

!Race(FifthNearestEnemyOf(Myself),RAKSHASA)
!Race(FifthNearestEnemyOf(Myself),LICH)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("fl#telki",FifthNearestEnemyOf(Myself))
RESPONSE #50
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(SixthNearestEnemyOf(Myself))
!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,HELD)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SixthNearestEnemyOf(Myself),75,RESISTMAGIC)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SixthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStat(SixthNearestEnemyOf(Myself),8,WIZARD_SPELL_IMMUNITY)
Range(SixthNearestEnemyOf(Myself),10)
CheckStatGT(SixthNearestEnemyOf(Myself),3,SAVEVSSPELL)
!Race(SixthNearestEnemyOf(Myself),GIANT)
!Race(SixthNearestEnemyOf(Myself),DRAGON)
!Race(SixthNearestEnemyOf(Myself),DEMONIC)
!Class(SixthNearestEnemyOf(Myself),ELEMENTAL_EARTH)
!Class(SixthNearestEnemyOf(Myself),ELEMENTAL_FIRE)
!Class(SixthNearestEnemyOf(Myself),ELEMENTAL_AIR)
!Name("finmel01",SixthNearestEnemyOf(Myself))

!Race(SixthNearestEnemyOf(Myself),RAKSHASA)
!Race(SixthNearestEnemyOf(Myself),LICH)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("fl#telki",SixthNearestEnemyOf(Myself))
RESPONSE #50
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
Global("flMinorSequencer","LOCALS",0)
See(NearestEnemyOf(Myself))
Global("flDecideMinorSequencer","LOCALS",1)
!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(NearestEnemyOf(Myself),0,HELD)
!StateCheck(NearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(NearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(NearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(NearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(NearestEnemyOf(Myself),2,WIZARD_SPELL_IMMUNITY)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!CheckStatGT(NearestEnemyOf(Myself),75,RESISTACID)
!HasItemEquiped("clck26",NearestEnemyOf(Myself))
!Race(NearestEnemyOf(Myself),RAKSHASA)
!Race(NearestEnemyOf(Myself),LICH)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
SetGlobal("flMinorSequencer","LOCALS",1)
DisplayStringHead(Myself,5013)
SetSequence(SEQ_CAST)
ReallyForceSpell(NearestEnemyOf(Myself),WIZARD_MELF_ACID_ARROW)
ReallyForceSpell(NearestEnemyOf(Myself),WIZARD_MELF_ACID_ARROW)
RESPONSE #50
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
Global("flMinorSequencer","LOCALS",0)
See(SecondNearestEnemyOf(Myself))
Global("flDecideMinorSequencer","LOCALS",1)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,HELD)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SecondNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SecondNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(SecondNearestEnemyOf(Myself),2,WIZARD_SPELL_IMMUNITY)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!CheckStatGT(SecondNearestEnemyOf(Myself),75,RESISTACID)
!HasItemEquiped("clck26",SecondNearestEnemyOf(Myself))
!Race(SecondNearestEnemyOf(Myself),RAKSHASA)
!Race(SecondNearestEnemyOf(Myself),LICH)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
SetGlobal("flMinorSequencer","LOCALS",1)
DisplayStringHead(Myself,5013)
SetSequence(SEQ_CAST)
ReallyForceSpell(SecondNearestEnemyOf(Myself),WIZARD_MELF_ACID_ARROW)
ReallyForceSpell(SecondNearestEnemyOf(Myself),WIZARD_MELF_ACID_ARROW)
RESPONSE #50
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
Global("flMinorSequencer","LOCALS",0)
See(ThirdNearestEnemyOf(Myself))
Global("flDecideMinorSequencer","LOCALS",1)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,HELD)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(ThirdNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(ThirdNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(ThirdNearestEnemyOf(Myself),2,WIZARD_SPELL_IMMUNITY)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),75,RESISTACID)
!HasItemEquiped("clck26",ThirdNearestEnemyOf(Myself))
!Race(ThirdNearestEnemyOf(Myself),RAKSHASA)
!Race(ThirdNearestEnemyOf(Myself),LICH)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
SetGlobal("flMinorSequencer","LOCALS",1)
DisplayStringHead(Myself,5013)
SetSequence(SEQ_CAST)
ReallyForceSpell(ThirdNearestEnemyOf(Myself),WIZARD_MELF_ACID_ARROW)
ReallyForceSpell(ThirdNearestEnemyOf(Myself),WIZARD_MELF_ACID_ARROW)
RESPONSE #50
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
Global("flMinorSequencer","LOCALS",0)
See(FourthNearestEnemyOf(Myself))
Global("flDecideMinorSequencer","LOCALS",1)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FourthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(FourthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(FourthNearestEnemyOf(Myself),2,WIZARD_SPELL_IMMUNITY)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!CheckStatGT(FourthNearestEnemyOf(Myself),75,RESISTACID)
!HasItemEquiped("clck26",FourthNearestEnemyOf(Myself))
!Race(FourthNearestEnemyOf(Myself),RAKSHASA)
!Race(FourthNearestEnemyOf(Myself),LICH)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
SetGlobal("flMinorSequencer","LOCALS",1)
DisplayStringHead(Myself,5013)
SetSequence(SEQ_CAST)
ReallyForceSpell(FourthNearestEnemyOf(Myself),WIZARD_MELF_ACID_ARROW)
ReallyForceSpell(FourthNearestEnemyOf(Myself),WIZARD_MELF_ACID_ARROW)
RESPONSE #50
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
Global("flMinorSequencer","LOCALS",0)
See(FifthNearestEnemyOf(Myself))
Global("flDecideMinorSequencer","LOCALS",1)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FifthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(FifthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(FifthNearestEnemyOf(Myself),2,WIZARD_SPELL_IMMUNITY)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!CheckStatGT(FifthNearestEnemyOf(Myself),75,RESISTACID)
!HasItemEquiped("clck26",FifthNearestEnemyOf(Myself))
!Race(FifthNearestEnemyOf(Myself),RAKSHASA)
!Race(FifthNearestEnemyOf(Myself),LICH)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
SetGlobal("flMinorSequencer","LOCALS",1)
DisplayStringHead(Myself,5013)
SetSequence(SEQ_CAST)
ReallyForceSpell(FifthNearestEnemyOf(Myself),WIZARD_MELF_ACID_ARROW)
ReallyForceSpell(FifthNearestEnemyOf(Myself),WIZARD_MELF_ACID_ARROW)
RESPONSE #50
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
Global("flMinorSequencer","LOCALS",0)
See(SixthNearestEnemyOf(Myself))
Global("flDecideMinorSequencer","LOCALS",1)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,HELD)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SixthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SixthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(SixthNearestEnemyOf(Myself),2,WIZARD_SPELL_IMMUNITY)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!CheckStatGT(SixthNearestEnemyOf(Myself),75,RESISTACID)
!HasItemEquiped("clck26",SixthNearestEnemyOf(Myself))
!Race(SixthNearestEnemyOf(Myself),RAKSHASA)
!Race(SixthNearestEnemyOf(Myself),LICH)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
SetGlobal("flMinorSequencer","LOCALS",1)
DisplayStringHead(Myself,5013)
SetSequence(SEQ_CAST)
ReallyForceSpell(SixthNearestEnemyOf(Myself),WIZARD_MELF_ACID_ARROW)
ReallyForceSpell(SixthNearestEnemyOf(Myself),WIZARD_MELF_ACID_ARROW)
RESPONSE #50
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
Global("flMinorSequencer","LOCALS",0)
See(NearestEnemyOf(Myself))
Global("flDecideMinorSequencer","LOCALS",2)
!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(NearestEnemyOf(Myself),0,HELD)
!StateCheck(NearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(NearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(NearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(NearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(NearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!CheckStatGT(NearestEnemyOf(Myself),75,RESISTFIRE)
!HasItemEquiped("clck26",NearestEnemyOf(Myself))
!Race(NearestEnemyOf(Myself),RAKSHASA)
!Race(NearestEnemyOf(Myself),LICH)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
SetGlobal("flMinorSequencer","LOCALS",1)
DisplayStringHead(Myself,5013)
SetSequence(SEQ_CAST)
ReallyForceSpell(NearestEnemyOf(Myself),WIZARD_AGANNAZAR_SCORCHER)
ReallyForceSpell(NearestEnemyOf(Myself),WIZARD_AGANNAZAR_SCORCHER)
RESPONSE #50
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
Global("flMinorSequencer","LOCALS",0)
See(SecondNearestEnemyOf(Myself))
Global("flDecideMinorSequencer","LOCALS",2)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,HELD)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SecondNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SecondNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(SecondNearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!CheckStatGT(SecondNearestEnemyOf(Myself),75,RESISTFIRE)
!HasItemEquiped("clck26",SecondNearestEnemyOf(Myself))
!Race(SecondNearestEnemyOf(Myself),RAKSHASA)
!Race(SecondNearestEnemyOf(Myself),LICH)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
SetGlobal("flMinorSequencer","LOCALS",1)
DisplayStringHead(Myself,5013)
SetSequence(SEQ_CAST)
ReallyForceSpell(SecondNearestEnemyOf(Myself),WIZARD_AGANNAZAR_SCORCHER)
ReallyForceSpell(SecondNearestEnemyOf(Myself),WIZARD_AGANNAZAR_SCORCHER)
RESPONSE #50
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
Global("flMinorSequencer","LOCALS",0)
See(ThirdNearestEnemyOf(Myself))
Global("flDecideMinorSequencer","LOCALS",2)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,HELD)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(ThirdNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(ThirdNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(ThirdNearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),75,RESISTFIRE)
!HasItemEquiped("clck26",ThirdNearestEnemyOf(Myself))
!Race(ThirdNearestEnemyOf(Myself),RAKSHASA)
!Race(ThirdNearestEnemyOf(Myself),LICH)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
SetGlobal("flMinorSequencer","LOCALS",1)
DisplayStringHead(Myself,5013)
SetSequence(SEQ_CAST)
ReallyForceSpell(ThirdNearestEnemyOf(Myself),WIZARD_AGANNAZAR_SCORCHER)
ReallyForceSpell(ThirdNearestEnemyOf(Myself),WIZARD_AGANNAZAR_SCORCHER)
RESPONSE #50
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
Global("flMinorSequencer","LOCALS",0)
See(FourthNearestEnemyOf(Myself))
Global("flDecideMinorSequencer","LOCALS",2)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FourthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(FourthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(FourthNearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!CheckStatGT(FourthNearestEnemyOf(Myself),75,RESISTFIRE)
!HasItemEquiped("clck26",FourthNearestEnemyOf(Myself))
!Race(FourthNearestEnemyOf(Myself),RAKSHASA)
!Race(FourthNearestEnemyOf(Myself),LICH)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
SetGlobal("flMinorSequencer","LOCALS",1)
DisplayStringHead(Myself,5013)
SetSequence(SEQ_CAST)
ReallyForceSpell(FourthNearestEnemyOf(Myself),WIZARD_AGANNAZAR_SCORCHER)
ReallyForceSpell(FourthNearestEnemyOf(Myself),WIZARD_AGANNAZAR_SCORCHER)
RESPONSE #50
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
Global("flMinorSequencer","LOCALS",0)
See(FifthNearestEnemyOf(Myself))
Global("flDecideMinorSequencer","LOCALS",2)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FifthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(FifthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(FifthNearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!CheckStatGT(FifthNearestEnemyOf(Myself),75,RESISTFIRE)
!HasItemEquiped("clck26",FifthNearestEnemyOf(Myself))
!Race(FifthNearestEnemyOf(Myself),RAKSHASA)
!Race(FifthNearestEnemyOf(Myself),LICH)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
SetGlobal("flMinorSequencer","LOCALS",1)
DisplayStringHead(Myself,5013)
SetSequence(SEQ_CAST)
ReallyForceSpell(FifthNearestEnemyOf(Myself),WIZARD_AGANNAZAR_SCORCHER)
ReallyForceSpell(FifthNearestEnemyOf(Myself),WIZARD_AGANNAZAR_SCORCHER)
RESPONSE #50
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
Global("flMinorSequencer","LOCALS",0)
See(SixthNearestEnemyOf(Myself))
Global("flDecideMinorSequencer","LOCALS",2)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,HELD)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SixthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SixthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(SixthNearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!CheckStatGT(SixthNearestEnemyOf(Myself),75,RESISTFIRE)
!HasItemEquiped("clck26",SixthNearestEnemyOf(Myself))
!Race(SixthNearestEnemyOf(Myself),RAKSHASA)
!Race(SixthNearestEnemyOf(Myself),LICH)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
SetGlobal("flMinorSequencer","LOCALS",1)
DisplayStringHead(Myself,5013)
SetSequence(SEQ_CAST)
ReallyForceSpell(SixthNearestEnemyOf(Myself),WIZARD_AGANNAZAR_SCORCHER)
ReallyForceSpell(SixthNearestEnemyOf(Myself),WIZARD_AGANNAZAR_SCORCHER)
RESPONSE #50
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_LIGHTNING_BOLT)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,HELD)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SixthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(SixthNearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(SixthNearestEnemyOf(Myself),50,RESISTELECTRICITY)
!HasItemEquiped("clck24",SixthNearestEnemyOf(Myself))
!HasItemEquiped("clck26",SixthNearestEnemyOf(Myself))
!Race(SixthNearestEnemyOf(Myself),RAKSHASA)
!Race(SixthNearestEnemyOf(Myself),LICH)
See(SixthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_LIGHTNING_BOLT)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FifthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(FifthNearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(FifthNearestEnemyOf(Myself),50,RESISTELECTRICITY)
!HasItemEquiped("clck24",FifthNearestEnemyOf(Myself))
!HasItemEquiped("clck26",FifthNearestEnemyOf(Myself))
!Race(FifthNearestEnemyOf(Myself),RAKSHASA)
!Race(FifthNearestEnemyOf(Myself),LICH)
See(FifthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_LIGHTNING_BOLT)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FourthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(FourthNearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(FourthNearestEnemyOf(Myself),50,RESISTELECTRICITY)
!HasItemEquiped("clck24",FourthNearestEnemyOf(Myself))
!HasItemEquiped("clck26",FourthNearestEnemyOf(Myself))
!Race(FourthNearestEnemyOf(Myself),RAKSHASA)
!Race(FourthNearestEnemyOf(Myself),LICH)
See(FourthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_LIGHTNING_BOLT)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,HELD)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(ThirdNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(ThirdNearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(ThirdNearestEnemyOf(Myself),50,RESISTELECTRICITY)
!HasItemEquiped("clck24",ThirdNearestEnemyOf(Myself))
!HasItemEquiped("clck26",ThirdNearestEnemyOf(Myself))
!Race(ThirdNearestEnemyOf(Myself),RAKSHASA)
!Race(ThirdNearestEnemyOf(Myself),LICH)
See(ThirdNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_LIGHTNING_BOLT)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,HELD)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SecondNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(SecondNearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(SecondNearestEnemyOf(Myself),50,RESISTELECTRICITY)
!HasItemEquiped("clck24",SecondNearestEnemyOf(Myself))
!HasItemEquiped("clck26",SecondNearestEnemyOf(Myself))
!Race(SecondNearestEnemyOf(Myself),RAKSHASA)
!Race(SecondNearestEnemyOf(Myself),LICH)
See(SecondNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_LIGHTNING_BOLT)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(NearestEnemyOf(Myself),0,HELD)
!StateCheck(NearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(NearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(NearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(NearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(NearestEnemyOf(Myself),50,RESISTELECTRICITY)
!HasItemEquiped("clck24",NearestEnemyOf(Myself))
!HasItemEquiped("clck26",NearestEnemyOf(Myself))
!Race(NearestEnemyOf(Myself),RAKSHASA)
!Race(NearestEnemyOf(Myself),LICH)
See(NearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_LIGHTNING_BOLT)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
!CheckStatGT(LastSeenBy(Myself),0,HELD)
!StateCheck(LastSeenBy(Myself),STATE_STONE_DEATH)
!CheckStatGT(LastSeenBy(Myself),50,RESISTMAGIC)
!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
!CheckStatGT(LastSeenBy(Myself),50,RESISTELECTRICITY)
!HasItemEquiped("clck24",LastSeenBy(Myself))
!HasItemEquiped("clck26",LastSeenBy(Myself))
!Race(LastSeenBy(Myself),RAKSHASA)
!Race(LastSeenBy(Myself),LICH)
See(LastSeenBy(Myself))
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
Spell(LastSeenBy(Myself),WIZARD_LIGHTNING_BOLT)
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_FLAME_ARROW)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,HELD)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SixthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(SixthNearestEnemyOf(Myself),2,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SixthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(SixthNearestEnemyOf(Myself),50,RESISTFIRE)
!HasItemEquiped("clck26",SixthNearestEnemyOf(Myself))
!Race(SixthNearestEnemyOf(Myself),RAKSHASA)
!Race(SixthNearestEnemyOf(Myself),LICH)
See(SixthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_FLAME_ARROW)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FifthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(FifthNearestEnemyOf(Myself),2,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(FifthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(FifthNearestEnemyOf(Myself),50,RESISTFIRE)
!HasItemEquiped("clck26",FifthNearestEnemyOf(Myself))
!Race(FifthNearestEnemyOf(Myself),RAKSHASA)
!Race(FifthNearestEnemyOf(Myself),LICH)
See(FifthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_FLAME_ARROW)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FourthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(FourthNearestEnemyOf(Myself),2,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(FourthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(FourthNearestEnemyOf(Myself),50,RESISTFIRE)
!HasItemEquiped("clck26",FourthNearestEnemyOf(Myself))
!Race(FourthNearestEnemyOf(Myself),RAKSHASA)
!Race(FourthNearestEnemyOf(Myself),LICH)
See(FourthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_FLAME_ARROW)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,HELD)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(ThirdNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(ThirdNearestEnemyOf(Myself),2,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(ThirdNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(ThirdNearestEnemyOf(Myself),50,RESISTFIRE)
!HasItemEquiped("clck26",ThirdNearestEnemyOf(Myself))
!Race(ThirdNearestEnemyOf(Myself),RAKSHASA)
!Race(ThirdNearestEnemyOf(Myself),LICH)
See(ThirdNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_FLAME_ARROW)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,HELD)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SecondNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(SecondNearestEnemyOf(Myself),2,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SecondNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(SecondNearestEnemyOf(Myself),50,RESISTFIRE)
!HasItemEquiped("clck26",SecondNearestEnemyOf(Myself))
!Race(SecondNearestEnemyOf(Myself),RAKSHASA)
!Race(SecondNearestEnemyOf(Myself),LICH)
See(SecondNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_FLAME_ARROW)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(NearestEnemyOf(Myself),0,HELD)
!StateCheck(NearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(NearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(NearestEnemyOf(Myself),2,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(NearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(NearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(NearestEnemyOf(Myself),50,RESISTFIRE)
!HasItemEquiped("clck26",NearestEnemyOf(Myself))
!Race(NearestEnemyOf(Myself),RAKSHASA)
!Race(NearestEnemyOf(Myself),LICH)
See(NearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_FLAME_ARROW)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
!CheckStatGT(LastSeenBy(Myself),0,HELD)
!StateCheck(LastSeenBy(Myself),STATE_STONE_DEATH)
!CheckStatGT(LastSeenBy(Myself),50,RESISTMAGIC)
!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(LastSeenBy(Myself),50,RESISTFIRE)
!HasItemEquiped("clck26",LastSeenBy(Myself))
!Race(LastSeenBy(Myself),RAKSHASA)
!Race(LastSeenBy(Myself),LICH)
See(LastSeenBy(Myself))
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
Spell(LastSeenBy(Myself),WIZARD_FLAME_ARROW)
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(NearestEnemyOf(Myself))
!Range(NearestEnemyOf(Myself),10)
THEN
RESPONSE #50
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("fl#adead",NearestEnemyOf(Myself))
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(SecondNearestEnemyOf(Myself))
!Range(SecondNearestEnemyOf(Myself),10)
THEN
RESPONSE #50
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("fl#adead",SecondNearestEnemyOf(Myself))
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(ThirdNearestEnemyOf(Myself))
!Range(ThirdNearestEnemyOf(Myself),10)
THEN
RESPONSE #50
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("fl#adead",ThirdNearestEnemyOf(Myself))
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_HORROR)
See(NearestEnemyOf(Myself))
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(NearestEnemyOf(Myself),0,HELD)
!StateCheck(NearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(NearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(NearestEnemyOf(Myself),7,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(NearestEnemyOf(Myself),0,MINORGLOBE)
!General(NearestEnemyOf(Myself),UNDEAD)
!Race(NearestEnemyOf(Myself),SLIME)
!Race(NearestEnemyOf(Myself),GOLEM)
!Race(NearestEnemyOf(Myself),DEMONIC)
!Race(NearestEnemyOf(Myself),TROLL)
!Kit(NearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_RESIST_FEAR)
!CheckStat(NearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("CLCK30",NearestEnemyOf(Myself))
!HasItemEquipedReal("SW1H32",NearestEnemyOf(Myself))
!HasItemEquipedReal("MISCBC",NearestEnemyOf(Myself))
!HasItemEquiped("RR#HELMD",NearestEnemyOf(Myself))
!Race(NearestEnemyOf(Myself),RAKSHASA)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
Spell(NearestEnemyOf(Myself),WIZARD_HORROR)
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_HORROR)
See(SecondNearestEnemyOf(Myself))
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,HELD)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SecondNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(SecondNearestEnemyOf(Myself),7,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,MINORGLOBE)
!General(SecondNearestEnemyOf(Myself),UNDEAD)
!Race(SecondNearestEnemyOf(Myself),SLIME)
!Race(SecondNearestEnemyOf(Myself),GOLEM)
!Race(SecondNearestEnemyOf(Myself),DEMONIC)
!Race(SecondNearestEnemyOf(Myself),TROLL)
!Kit(SecondNearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_RESIST_FEAR)
!CheckStat(SecondNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("CLCK30",SecondNearestEnemyOf(Myself))
!HasItemEquipedReal("SW1H32",SecondNearestEnemyOf(Myself))
!HasItemEquipedReal("MISCBC",SecondNearestEnemyOf(Myself))
!HasItemEquiped("RR#HELMD",SecondNearestEnemyOf(Myself))
!Race(SecondNearestEnemyOf(Myself),RAKSHASA)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
Spell(SecondNearestEnemyOf(Myself),WIZARD_HORROR)
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_HORROR)
See(ThirdNearestEnemyOf(Myself))
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,HELD)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(ThirdNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(ThirdNearestEnemyOf(Myself),7,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,MINORGLOBE)
!General(ThirdNearestEnemyOf(Myself),UNDEAD)
!Race(ThirdNearestEnemyOf(Myself),SLIME)
!Race(ThirdNearestEnemyOf(Myself),GOLEM)
!Race(ThirdNearestEnemyOf(Myself),DEMONIC)
!Race(ThirdNearestEnemyOf(Myself),TROLL)
!Kit(ThirdNearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_RESIST_FEAR)
!CheckStat(ThirdNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("CLCK30",ThirdNearestEnemyOf(Myself))
!HasItemEquipedReal("SW1H32",ThirdNearestEnemyOf(Myself))
!HasItemEquipedReal("MISCBC",ThirdNearestEnemyOf(Myself))
!HasItemEquiped("RR#HELMD",ThirdNearestEnemyOf(Myself))
!Race(ThirdNearestEnemyOf(Myself),RAKSHASA)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
Spell(ThirdNearestEnemyOf(Myself),WIZARD_HORROR)
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_HORROR)
See(FourthNearestEnemyOf(Myself))
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FourthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(FourthNearestEnemyOf(Myself),7,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,MINORGLOBE)
!General(FourthNearestEnemyOf(Myself),UNDEAD)
!Race(FourthNearestEnemyOf(Myself),SLIME)
!Race(FourthNearestEnemyOf(Myself),GOLEM)
!Race(FourthNearestEnemyOf(Myself),DEMONIC)
!Race(FourthNearestEnemyOf(Myself),TROLL)
!Kit(FourthNearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_RESIST_FEAR)
!CheckStat(FourthNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("CLCK30",FourthNearestEnemyOf(Myself))
!HasItemEquipedReal("SW1H32",FourthNearestEnemyOf(Myself))
!HasItemEquipedReal("MISCBC",FourthNearestEnemyOf(Myself))
!HasItemEquiped("RR#HELMD",FourthNearestEnemyOf(Myself))
!Race(FourthNearestEnemyOf(Myself),RAKSHASA)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
Spell(FourthNearestEnemyOf(Myself),WIZARD_HORROR)
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_HORROR)
See(FifthNearestEnemyOf(Myself))
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FifthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(FifthNearestEnemyOf(Myself),7,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,MINORGLOBE)
!General(FifthNearestEnemyOf(Myself),UNDEAD)
!Race(FifthNearestEnemyOf(Myself),SLIME)
!Race(FifthNearestEnemyOf(Myself),GOLEM)
!Race(FifthNearestEnemyOf(Myself),DEMONIC)
!Race(FifthNearestEnemyOf(Myself),TROLL)
!Kit(FifthNearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_RESIST_FEAR)
!CheckStat(FifthNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("CLCK30",FifthNearestEnemyOf(Myself))
!HasItemEquipedReal("SW1H32",FifthNearestEnemyOf(Myself))
!HasItemEquipedReal("MISCBC",FifthNearestEnemyOf(Myself))
!HasItemEquiped("RR#HELMD",FifthNearestEnemyOf(Myself))
!Race(FifthNearestEnemyOf(Myself),RAKSHASA)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
Spell(FifthNearestEnemyOf(Myself),WIZARD_HORROR)
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_HORROR)
See(SixthNearestEnemyOf(Myself))
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,HELD)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SixthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(SixthNearestEnemyOf(Myself),7,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,MINORGLOBE)
!General(SixthNearestEnemyOf(Myself),UNDEAD)
!Race(SixthNearestEnemyOf(Myself),SLIME)
!Race(SixthNearestEnemyOf(Myself),GOLEM)
!Race(SixthNearestEnemyOf(Myself),DEMONIC)
!Race(SixthNearestEnemyOf(Myself),TROLL)
!Kit(SixthNearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_RESIST_FEAR)
!CheckStat(SixthNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("CLCK30",SixthNearestEnemyOf(Myself))
!HasItemEquipedReal("SW1H32",SixthNearestEnemyOf(Myself))
!HasItemEquipedReal("MISCBC",SixthNearestEnemyOf(Myself))
!HasItemEquiped("RR#HELMD",SixthNearestEnemyOf(Myself))
!Race(SixthNearestEnemyOf(Myself),RAKSHASA)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
Spell(SixthNearestEnemyOf(Myself),WIZARD_HORROR)
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_MELF_ACID_ARROW)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,HELD)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SixthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(SixthNearestEnemyOf(Myself),2,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SixthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(SixthNearestEnemyOf(Myself),50,RESISTACID)
!HasItemEquiped("clck26",SixthNearestEnemyOf(Myself))
!Race(SixthNearestEnemyOf(Myself),RAKSHASA)
!Race(SixthNearestEnemyOf(Myself),LICH)
See(SixthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_MELF_ACID_ARROW)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FifthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(FifthNearestEnemyOf(Myself),2,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(FifthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(FifthNearestEnemyOf(Myself),50,RESISTACID)
!HasItemEquiped("clck26",FifthNearestEnemyOf(Myself))
!Race(FifthNearestEnemyOf(Myself),RAKSHASA)
!Race(FifthNearestEnemyOf(Myself),LICH)
See(FifthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_MELF_ACID_ARROW)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FourthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(FourthNearestEnemyOf(Myself),2,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(FourthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(FourthNearestEnemyOf(Myself),50,RESISTACID)
!HasItemEquiped("clck26",FourthNearestEnemyOf(Myself))
!Race(FourthNearestEnemyOf(Myself),RAKSHASA)
!Race(FourthNearestEnemyOf(Myself),LICH)
See(FourthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_MELF_ACID_ARROW)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,HELD)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(ThirdNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(ThirdNearestEnemyOf(Myself),2,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(ThirdNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(ThirdNearestEnemyOf(Myself),50,RESISTACID)
!HasItemEquiped("clck26",ThirdNearestEnemyOf(Myself))
!Race(ThirdNearestEnemyOf(Myself),RAKSHASA)
!Race(ThirdNearestEnemyOf(Myself),LICH)
See(ThirdNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_MELF_ACID_ARROW)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,HELD)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SecondNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(SecondNearestEnemyOf(Myself),2,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SecondNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(SecondNearestEnemyOf(Myself),50,RESISTACID)
!HasItemEquiped("clck26",SecondNearestEnemyOf(Myself))
!Race(SecondNearestEnemyOf(Myself),RAKSHASA)
!Race(SecondNearestEnemyOf(Myself),LICH)
See(SecondNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_MELF_ACID_ARROW)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(NearestEnemyOf(Myself),0,HELD)
!StateCheck(NearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(NearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(NearestEnemyOf(Myself),2,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(NearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(NearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(NearestEnemyOf(Myself),50,RESISTACID)
!HasItemEquiped("clck26",NearestEnemyOf(Myself))
!Race(NearestEnemyOf(Myself),RAKSHASA)
!Race(NearestEnemyOf(Myself),LICH)
See(NearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_MELF_ACID_ARROW)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
!CheckStatGT(LastSeenBy(Myself),0,HELD)
!StateCheck(LastSeenBy(Myself),STATE_STONE_DEATH)
!CheckStatGT(LastSeenBy(Myself),50,RESISTMAGIC)
!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(LastSeenBy(Myself),50,RESISTACID)
!HasItemEquiped("clck26",LastSeenBy(Myself))
!Race(LastSeenBy(Myself),RAKSHASA)
!Race(LastSeenBy(Myself),LICH)
See(LastSeenBy(Myself))
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
Spell(LastSeenBy(Myself),WIZARD_MELF_ACID_ARROW)
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(NearestEnemyOf(Myself))
!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(NearestEnemyOf(Myself),0,HELD)
!StateCheck(NearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(NearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(NearestEnemyOf(Myself),5,WIZARD_SPELL_IMMUNITY)
!General(NearestEnemyOf(Myself),UNDEAD)
!Race(NearestEnemyOf(Myself),SLIME)
!Race(NearestEnemyOf(Myself),GOLEM)
!Race(NearestEnemyOf(Myself),DEMONIC)
!Race(NearestEnemyOf(Myself),TROLL)
!Kit(NearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_RESIST_FEAR)
!CheckStat(NearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("CLCK30",NearestEnemyOf(Myself))
!HasItemEquipedReal("SW1H32",NearestEnemyOf(Myself))
!HasItemEquipedReal("MISCBC",NearestEnemyOf(Myself))
!HasItemEquiped("RR#HELMD",NearestEnemyOf(Myself))
Range(NearestEnemyOf(Myself),20)

Global("fl#FearCone","LOCALS",0)
!Race(NearestEnemyOf(Myself),RAKSHASA)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("fl#cnefr",NearestEnemyOf(Myself))
IncrementGlobal("fl#FearCone","LOCALS",1)
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(SecondNearestEnemyOf(Myself))
!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,HELD)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SecondNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(SecondNearestEnemyOf(Myself),5,WIZARD_SPELL_IMMUNITY)
!General(SecondNearestEnemyOf(Myself),UNDEAD)
!Race(SecondNearestEnemyOf(Myself),SLIME)
!Race(SecondNearestEnemyOf(Myself),GOLEM)
!Race(SecondNearestEnemyOf(Myself),DEMONIC)
!Race(SecondNearestEnemyOf(Myself),TROLL)
!Kit(SecondNearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_RESIST_FEAR)
!CheckStat(SecondNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("CLCK30",SecondNearestEnemyOf(Myself))
!HasItemEquipedReal("SW1H32",SecondNearestEnemyOf(Myself))
!HasItemEquipedReal("MISCBC",SecondNearestEnemyOf(Myself))
!HasItemEquiped("RR#HELMD",SecondNearestEnemyOf(Myself))
Range(SecondNearestEnemyOf(Myself),20)

Global("fl#FearCone","LOCALS",0)
!Race(SecondNearestEnemyOf(Myself),RAKSHASA)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("fl#cnefr",SecondNearestEnemyOf(Myself))
IncrementGlobal("fl#FearCone","LOCALS",1)
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(ThirdNearestEnemyOf(Myself))
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,HELD)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(ThirdNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(ThirdNearestEnemyOf(Myself),5,WIZARD_SPELL_IMMUNITY)
!General(ThirdNearestEnemyOf(Myself),UNDEAD)
!Race(ThirdNearestEnemyOf(Myself),SLIME)
!Race(ThirdNearestEnemyOf(Myself),GOLEM)
!Race(ThirdNearestEnemyOf(Myself),DEMONIC)
!Race(ThirdNearestEnemyOf(Myself),TROLL)
!Kit(ThirdNearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_RESIST_FEAR)
!CheckStat(ThirdNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("CLCK30",ThirdNearestEnemyOf(Myself))
!HasItemEquipedReal("SW1H32",ThirdNearestEnemyOf(Myself))
!HasItemEquipedReal("MISCBC",ThirdNearestEnemyOf(Myself))
!HasItemEquiped("RR#HELMD",ThirdNearestEnemyOf(Myself))
Range(ThirdNearestEnemyOf(Myself),20)

Global("fl#FearCone","LOCALS",0)
!Race(ThirdNearestEnemyOf(Myself),RAKSHASA)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("fl#cnefr",ThirdNearestEnemyOf(Myself))
IncrementGlobal("fl#FearCone","LOCALS",1)
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(FourthNearestEnemyOf(Myself))
!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FourthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(FourthNearestEnemyOf(Myself),5,WIZARD_SPELL_IMMUNITY)
!General(FourthNearestEnemyOf(Myself),UNDEAD)
!Race(FourthNearestEnemyOf(Myself),SLIME)
!Race(FourthNearestEnemyOf(Myself),GOLEM)
!Race(FourthNearestEnemyOf(Myself),DEMONIC)
!Race(FourthNearestEnemyOf(Myself),TROLL)
!Kit(FourthNearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_RESIST_FEAR)
!CheckStat(FourthNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("CLCK30",FourthNearestEnemyOf(Myself))
!HasItemEquipedReal("SW1H32",FourthNearestEnemyOf(Myself))
!HasItemEquipedReal("MISCBC",FourthNearestEnemyOf(Myself))
!HasItemEquiped("RR#HELMD",FourthNearestEnemyOf(Myself))
Range(FourthNearestEnemyOf(Myself),20)

Global("fl#FearCone","LOCALS",0)
!Race(FourthNearestEnemyOf(Myself),RAKSHASA)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("fl#cnefr",FourthNearestEnemyOf(Myself))
IncrementGlobal("fl#FearCone","LOCALS",1)
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(FifthNearestEnemyOf(Myself))
!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FifthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(FifthNearestEnemyOf(Myself),5,WIZARD_SPELL_IMMUNITY)
!General(FifthNearestEnemyOf(Myself),UNDEAD)
!Race(FifthNearestEnemyOf(Myself),SLIME)
!Race(FifthNearestEnemyOf(Myself),GOLEM)
!Race(FifthNearestEnemyOf(Myself),DEMONIC)
!Race(FifthNearestEnemyOf(Myself),TROLL)
!Kit(FifthNearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_RESIST_FEAR)
!CheckStat(FifthNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("CLCK30",FifthNearestEnemyOf(Myself))
!HasItemEquipedReal("SW1H32",FifthNearestEnemyOf(Myself))
!HasItemEquipedReal("MISCBC",FifthNearestEnemyOf(Myself))
!HasItemEquiped("RR#HELMD",FifthNearestEnemyOf(Myself))
Range(FifthNearestEnemyOf(Myself),20)

Global("fl#FearCone","LOCALS",0)
!Race(FifthNearestEnemyOf(Myself),RAKSHASA)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("fl#cnefr",FifthNearestEnemyOf(Myself))
IncrementGlobal("fl#FearCone","LOCALS",1)
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(SixthNearestEnemyOf(Myself))
!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,HELD)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SixthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(SixthNearestEnemyOf(Myself),5,WIZARD_SPELL_IMMUNITY)
!General(SixthNearestEnemyOf(Myself),UNDEAD)
!Race(SixthNearestEnemyOf(Myself),SLIME)
!Race(SixthNearestEnemyOf(Myself),GOLEM)
!Race(SixthNearestEnemyOf(Myself),DEMONIC)
!Race(SixthNearestEnemyOf(Myself),TROLL)
!Kit(SixthNearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_RESIST_FEAR)
!CheckStat(SixthNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("CLCK30",SixthNearestEnemyOf(Myself))
!HasItemEquipedReal("SW1H32",SixthNearestEnemyOf(Myself))
!HasItemEquipedReal("MISCBC",SixthNearestEnemyOf(Myself))
!HasItemEquiped("RR#HELMD",SixthNearestEnemyOf(Myself))
Range(SixthNearestEnemyOf(Myself),20)

Global("fl#FearCone","LOCALS",0)
!Race(SixthNearestEnemyOf(Myself),RAKSHASA)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("fl#cnefr",SixthNearestEnemyOf(Myself))
IncrementGlobal("fl#FearCone","LOCALS",1)
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(NearestEnemyOfType([0.0.TROLL]))
!CheckStatGT(NearestEnemyOfType([0.0.TROLL]),99,RESISTFIRE)
!CheckStatGT(NearestEnemyOfType([0.0.TROLL]),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(NearestEnemyOfType([0.0.TROLL]),0,WIZARD_SPELL_TURNING)
!CheckStatGT(NearestEnemyOfType([0.0.TROLL]),0,WIZARD_SPELL_TRAP)
!CheckStat(NearestEnemyOfType([0.0.TROLL]),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(NearestEnemyOfType([0.0.TROLL]),0,MINORGLOBE)
!StateCheck(NearestEnemyOfType([0.0.TROLL]),STATE_NOT_TARGETABLE)
HPLT(NearestEnemyOfType([0.0.TROLL]),15)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("RR#PFLAM",NearestEnemyOfType([0.0.TROLL]))
RESPONSE #50
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(SecondNearestEnemyOfType([0.0.TROLL]))
!CheckStatGT(SecondNearestEnemyOfType([0.0.TROLL]),99,RESISTFIRE)
!CheckStatGT(SecondNearestEnemyOfType([0.0.TROLL]),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SecondNearestEnemyOfType([0.0.TROLL]),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SecondNearestEnemyOfType([0.0.TROLL]),0,WIZARD_SPELL_TRAP)
!CheckStat(SecondNearestEnemyOfType([0.0.TROLL]),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(SecondNearestEnemyOfType([0.0.TROLL]),0,MINORGLOBE)
!StateCheck(SecondNearestEnemyOfType([0.0.TROLL]),STATE_NOT_TARGETABLE)
HPLT(SecondNearestEnemyOfType([0.0.TROLL]),15)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("RR#PFLAM",SecondNearestEnemyOfType([0.0.TROLL]))
RESPONSE #50
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(ThirdNearestEnemyOfType([0.0.TROLL]))
!CheckStatGT(ThirdNearestEnemyOfType([0.0.TROLL]),99,RESISTFIRE)
!CheckStatGT(ThirdNearestEnemyOfType([0.0.TROLL]),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(ThirdNearestEnemyOfType([0.0.TROLL]),0,WIZARD_SPELL_TURNING)
!CheckStatGT(ThirdNearestEnemyOfType([0.0.TROLL]),0,WIZARD_SPELL_TRAP)
!CheckStat(ThirdNearestEnemyOfType([0.0.TROLL]),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(ThirdNearestEnemyOfType([0.0.TROLL]),0,MINORGLOBE)
!StateCheck(ThirdNearestEnemyOfType([0.0.TROLL]),STATE_NOT_TARGETABLE)
HPLT(ThirdNearestEnemyOfType([0.0.TROLL]),15)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("RR#PFLAM",ThirdNearestEnemyOfType([0.0.TROLL]))
RESPONSE #50
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(FourthNearestEnemyOfType([0.0.TROLL]))
!CheckStatGT(FourthNearestEnemyOfType([0.0.TROLL]),99,RESISTFIRE)
!CheckStatGT(FourthNearestEnemyOfType([0.0.TROLL]),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FourthNearestEnemyOfType([0.0.TROLL]),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FourthNearestEnemyOfType([0.0.TROLL]),0,WIZARD_SPELL_TRAP)
!CheckStat(FourthNearestEnemyOfType([0.0.TROLL]),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(FourthNearestEnemyOfType([0.0.TROLL]),0,MINORGLOBE)
!StateCheck(FourthNearestEnemyOfType([0.0.TROLL]),STATE_NOT_TARGETABLE)
HPLT(FourthNearestEnemyOfType([0.0.TROLL]),15)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("RR#PFLAM",FourthNearestEnemyOfType([0.0.TROLL]))
RESPONSE #50
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(FifthNearestEnemyOfType([0.0.TROLL]))
!CheckStatGT(FifthNearestEnemyOfType([0.0.TROLL]),99,RESISTFIRE)
!CheckStatGT(FifthNearestEnemyOfType([0.0.TROLL]),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FifthNearestEnemyOfType([0.0.TROLL]),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FifthNearestEnemyOfType([0.0.TROLL]),0,WIZARD_SPELL_TRAP)
!CheckStat(FifthNearestEnemyOfType([0.0.TROLL]),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(FifthNearestEnemyOfType([0.0.TROLL]),0,MINORGLOBE)
!StateCheck(FifthNearestEnemyOfType([0.0.TROLL]),STATE_NOT_TARGETABLE)
HPLT(FifthNearestEnemyOfType([0.0.TROLL]),15)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("RR#PFLAM",FifthNearestEnemyOfType([0.0.TROLL]))
RESPONSE #50
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(SixthNearestEnemyOfType([0.0.TROLL]))
!CheckStatGT(SixthNearestEnemyOfType([0.0.TROLL]),99,RESISTFIRE)
!CheckStatGT(SixthNearestEnemyOfType([0.0.TROLL]),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SixthNearestEnemyOfType([0.0.TROLL]),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SixthNearestEnemyOfType([0.0.TROLL]),0,WIZARD_SPELL_TRAP)
!CheckStat(SixthNearestEnemyOfType([0.0.TROLL]),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(SixthNearestEnemyOfType([0.0.TROLL]),0,MINORGLOBE)
!StateCheck(SixthNearestEnemyOfType([0.0.TROLL]),STATE_NOT_TARGETABLE)
HPLT(SixthNearestEnemyOfType([0.0.TROLL]),15)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("RR#PFLAM",SixthNearestEnemyOfType([0.0.TROLL]))
RESPONSE #50
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_CHROMATIC_ORB)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,HELD)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SixthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(SixthNearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SixthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!General(SixthNearestEnemyOf(Myself),UNDEAD)
!Race(SixthNearestEnemyOf(Myself),SLIME)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,SCRIPTINGSTATE2)
!HasItemEquiped("clck26",SixthNearestEnemyOf(Myself))
!HasItemEquiped("sw1h71",SixthNearestEnemyOf(Myself))
CheckStat(SixthNearestEnemyOf(Myself),1,24)
!Race(SixthNearestEnemyOf(Myself),RAKSHASA)
!Race(SixthNearestEnemyOf(Myself),LICH)
See(SixthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_CHROMATIC_ORB)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FifthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(FifthNearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(FifthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!General(FifthNearestEnemyOf(Myself),UNDEAD)
!Race(FifthNearestEnemyOf(Myself),SLIME)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,SCRIPTINGSTATE2)
!HasItemEquiped("clck26",FifthNearestEnemyOf(Myself))
!HasItemEquiped("sw1h71",FifthNearestEnemyOf(Myself))
CheckStat(FifthNearestEnemyOf(Myself),1,24)
!Race(FifthNearestEnemyOf(Myself),RAKSHASA)
!Race(FifthNearestEnemyOf(Myself),LICH)
See(FifthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_CHROMATIC_ORB)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FourthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(FourthNearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(FourthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!General(FourthNearestEnemyOf(Myself),UNDEAD)
!Race(FourthNearestEnemyOf(Myself),SLIME)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,SCRIPTINGSTATE2)
!HasItemEquiped("clck26",FourthNearestEnemyOf(Myself))
!HasItemEquiped("sw1h71",FourthNearestEnemyOf(Myself))
CheckStat(FourthNearestEnemyOf(Myself),1,24)
!Race(FourthNearestEnemyOf(Myself),RAKSHASA)
!Race(FourthNearestEnemyOf(Myself),LICH)
See(FourthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_CHROMATIC_ORB)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,HELD)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(ThirdNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(ThirdNearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(ThirdNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!General(ThirdNearestEnemyOf(Myself),UNDEAD)
!Race(ThirdNearestEnemyOf(Myself),SLIME)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,SCRIPTINGSTATE2)
!HasItemEquiped("clck26",ThirdNearestEnemyOf(Myself))
!HasItemEquiped("sw1h71",ThirdNearestEnemyOf(Myself))
CheckStat(ThirdNearestEnemyOf(Myself),1,24)
!Race(ThirdNearestEnemyOf(Myself),RAKSHASA)
!Race(ThirdNearestEnemyOf(Myself),LICH)
See(ThirdNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_CHROMATIC_ORB)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,HELD)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SecondNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(SecondNearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SecondNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!General(SecondNearestEnemyOf(Myself),UNDEAD)
!Race(SecondNearestEnemyOf(Myself),SLIME)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,SCRIPTINGSTATE2)
!HasItemEquiped("clck26",SecondNearestEnemyOf(Myself))
!HasItemEquiped("sw1h71",SecondNearestEnemyOf(Myself))
CheckStat(SecondNearestEnemyOf(Myself),1,24)
!Race(SecondNearestEnemyOf(Myself),RAKSHASA)
!Race(SecondNearestEnemyOf(Myself),LICH)
See(SecondNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_CHROMATIC_ORB)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(NearestEnemyOf(Myself),0,HELD)
!StateCheck(NearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(NearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(NearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(NearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(NearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!General(NearestEnemyOf(Myself),UNDEAD)
!Race(NearestEnemyOf(Myself),SLIME)
!CheckStatGT(NearestEnemyOf(Myself),0,SCRIPTINGSTATE2)
!HasItemEquiped("clck26",NearestEnemyOf(Myself))
!HasItemEquiped("sw1h71",NearestEnemyOf(Myself))
CheckStat(NearestEnemyOf(Myself),1,24)
!Race(NearestEnemyOf(Myself),RAKSHASA)
!Race(NearestEnemyOf(Myself),LICH)
See(NearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_CHROMATIC_ORB)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
!CheckStatGT(LastSeenBy(Myself),0,HELD)
!StateCheck(LastSeenBy(Myself),STATE_STONE_DEATH)
!CheckStatGT(LastSeenBy(Myself),50,RESISTMAGIC)
!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!General(LastSeenBy(Myself),UNDEAD)
!Race(LastSeenBy(Myself),SLIME)
!CheckStatGT(LastSeenBy(Myself),0,SCRIPTINGSTATE2)
!HasItemEquiped("clck26",LastSeenBy(Myself))
!HasItemEquiped("sw1h71",LastSeenBy(Myself))
CheckStat(LastSeenBy(Myself),1,24)
!Race(LastSeenBy(Myself),RAKSHASA)
!Race(LastSeenBy(Myself),LICH)
See(LastSeenBy(Myself))
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
Spell(LastSeenBy(Myself),WIZARD_CHROMATIC_ORB)
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_BLINDNESS)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,HELD)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SixthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(SixthNearestEnemyOf(Myself),5,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SixthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!General(SixthNearestEnemyOf(Myself),UNDEAD)
!Race(SixthNearestEnemyOf(Myself),SLIME)
!Race(SixthNearestEnemyOf(Myself),DEMONIC)
!HasItemEquiped("NPMISC1",SixthNearestEnemyOf(Myself))
!HasItemEquiped("RR#HEL02",SixthNearestEnemyOf(Myself))
!StateCheck(SixthNearestEnemyOf(Myself),STATE_BLIND)
!Race(SixthNearestEnemyOf(Myself),RAKSHASA)
!Race(SixthNearestEnemyOf(Myself),LICH)
See(SixthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_BLINDNESS)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FifthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(FifthNearestEnemyOf(Myself),5,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(FifthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!General(FifthNearestEnemyOf(Myself),UNDEAD)
!Race(FifthNearestEnemyOf(Myself),SLIME)
!Race(FifthNearestEnemyOf(Myself),DEMONIC)
!HasItemEquiped("NPMISC1",FifthNearestEnemyOf(Myself))
!HasItemEquiped("RR#HEL02",FifthNearestEnemyOf(Myself))
!StateCheck(FifthNearestEnemyOf(Myself),STATE_BLIND)
!Race(FifthNearestEnemyOf(Myself),RAKSHASA)
!Race(FifthNearestEnemyOf(Myself),LICH)
See(FifthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_BLINDNESS)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FourthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(FourthNearestEnemyOf(Myself),5,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(FourthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!General(FourthNearestEnemyOf(Myself),UNDEAD)
!Race(FourthNearestEnemyOf(Myself),SLIME)
!Race(FourthNearestEnemyOf(Myself),DEMONIC)
!HasItemEquiped("NPMISC1",FourthNearestEnemyOf(Myself))
!HasItemEquiped("RR#HEL02",FourthNearestEnemyOf(Myself))
!StateCheck(FourthNearestEnemyOf(Myself),STATE_BLIND)
!Race(FourthNearestEnemyOf(Myself),RAKSHASA)
!Race(FourthNearestEnemyOf(Myself),LICH)
See(FourthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_BLINDNESS)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,HELD)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(ThirdNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(ThirdNearestEnemyOf(Myself),5,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(ThirdNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!General(ThirdNearestEnemyOf(Myself),UNDEAD)
!Race(ThirdNearestEnemyOf(Myself),SLIME)
!Race(ThirdNearestEnemyOf(Myself),DEMONIC)
!HasItemEquiped("NPMISC1",ThirdNearestEnemyOf(Myself))
!HasItemEquiped("RR#HEL02",ThirdNearestEnemyOf(Myself))
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_BLIND)
!Race(ThirdNearestEnemyOf(Myself),RAKSHASA)
!Race(ThirdNearestEnemyOf(Myself),LICH)
See(ThirdNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_BLINDNESS)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,HELD)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SecondNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(SecondNearestEnemyOf(Myself),5,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SecondNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!General(SecondNearestEnemyOf(Myself),UNDEAD)
!Race(SecondNearestEnemyOf(Myself),SLIME)
!Race(SecondNearestEnemyOf(Myself),DEMONIC)
!HasItemEquiped("NPMISC1",SecondNearestEnemyOf(Myself))
!HasItemEquiped("RR#HEL02",SecondNearestEnemyOf(Myself))
!StateCheck(SecondNearestEnemyOf(Myself),STATE_BLIND)
!Race(SecondNearestEnemyOf(Myself),RAKSHASA)
!Race(SecondNearestEnemyOf(Myself),LICH)
See(SecondNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_BLINDNESS)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(NearestEnemyOf(Myself),0,HELD)
!StateCheck(NearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(NearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(NearestEnemyOf(Myself),5,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(NearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(NearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!General(NearestEnemyOf(Myself),UNDEAD)
!Race(NearestEnemyOf(Myself),SLIME)
!Race(NearestEnemyOf(Myself),DEMONIC)
!HasItemEquiped("NPMISC1",NearestEnemyOf(Myself))
!HasItemEquiped("RR#HEL02",NearestEnemyOf(Myself))
!StateCheck(NearestEnemyOf(Myself),STATE_BLIND)
!Race(NearestEnemyOf(Myself),RAKSHASA)
!Race(NearestEnemyOf(Myself),LICH)
See(NearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_BLINDNESS)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
!CheckStatGT(LastSeenBy(Myself),0,HELD)
!StateCheck(LastSeenBy(Myself),STATE_STONE_DEATH)
!CheckStatGT(LastSeenBy(Myself),50,RESISTMAGIC)
!CheckStat(LastSeenBy(Myself),5,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!General(LastSeenBy(Myself),UNDEAD)
!Race(LastSeenBy(Myself),SLIME)
!Race(LastSeenBy(Myself),DEMONIC)
!HasItemEquiped("NPMISC1",LastSeenBy(Myself))
!HasItemEquiped("RR#HEL02",LastSeenBy(Myself))
!StateCheck(LastSeenBy(Myself),STATE_BLIND)
!Race(LastSeenBy(Myself),RAKSHASA)
!Race(LastSeenBy(Myself),LICH)
See(LastSeenBy(Myself))
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
Spell(LastSeenBy(Myself),WIZARD_BLINDNESS)
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_SPOOK)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,HELD)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SixthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(SixthNearestEnemyOf(Myself),5,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SixthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!General(SixthNearestEnemyOf(Myself),UNDEAD)
!Race(SixthNearestEnemyOf(Myself),SLIME)
!Race(SixthNearestEnemyOf(Myself),GOLEM)
!Race(SixthNearestEnemyOf(Myself),DEMONIC)
!Race(SixthNearestEnemyOf(Myself),TROLL)
!Kit(SixthNearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_RESIST_FEAR)
!CheckStat(SixthNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("CLCK30",SixthNearestEnemyOf(Myself))
!HasItemEquipedReal("SW1H32",SixthNearestEnemyOf(Myself))
!HasItemEquipedReal("MISCBC",SixthNearestEnemyOf(Myself))
!HasItemEquiped("RR#HELMD",SixthNearestEnemyOf(Myself))
!Race(SixthNearestEnemyOf(Myself),RAKSHASA)
See(SixthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_SPOOK)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FifthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(FifthNearestEnemyOf(Myself),5,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(FifthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!General(FifthNearestEnemyOf(Myself),UNDEAD)
!Race(FifthNearestEnemyOf(Myself),SLIME)
!Race(FifthNearestEnemyOf(Myself),GOLEM)
!Race(FifthNearestEnemyOf(Myself),DEMONIC)
!Race(FifthNearestEnemyOf(Myself),TROLL)
!Kit(FifthNearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_RESIST_FEAR)
!CheckStat(FifthNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("CLCK30",FifthNearestEnemyOf(Myself))
!HasItemEquipedReal("SW1H32",FifthNearestEnemyOf(Myself))
!HasItemEquipedReal("MISCBC",FifthNearestEnemyOf(Myself))
!HasItemEquiped("RR#HELMD",FifthNearestEnemyOf(Myself))
!Race(FifthNearestEnemyOf(Myself),RAKSHASA)
See(FifthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_SPOOK)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FourthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(FourthNearestEnemyOf(Myself),5,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(FourthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!General(FourthNearestEnemyOf(Myself),UNDEAD)
!Race(FourthNearestEnemyOf(Myself),SLIME)
!Race(FourthNearestEnemyOf(Myself),GOLEM)
!Race(FourthNearestEnemyOf(Myself),DEMONIC)
!Race(FourthNearestEnemyOf(Myself),TROLL)
!Kit(FourthNearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_RESIST_FEAR)
!CheckStat(FourthNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("CLCK30",FourthNearestEnemyOf(Myself))
!HasItemEquipedReal("SW1H32",FourthNearestEnemyOf(Myself))
!HasItemEquipedReal("MISCBC",FourthNearestEnemyOf(Myself))
!HasItemEquiped("RR#HELMD",FourthNearestEnemyOf(Myself))
!Race(FourthNearestEnemyOf(Myself),RAKSHASA)
See(FourthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_SPOOK)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,HELD)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(ThirdNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(ThirdNearestEnemyOf(Myself),5,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(ThirdNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!General(ThirdNearestEnemyOf(Myself),UNDEAD)
!Race(ThirdNearestEnemyOf(Myself),SLIME)
!Race(ThirdNearestEnemyOf(Myself),GOLEM)
!Race(ThirdNearestEnemyOf(Myself),DEMONIC)
!Race(ThirdNearestEnemyOf(Myself),TROLL)
!Kit(ThirdNearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_RESIST_FEAR)
!CheckStat(ThirdNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("CLCK30",ThirdNearestEnemyOf(Myself))
!HasItemEquipedReal("SW1H32",ThirdNearestEnemyOf(Myself))
!HasItemEquipedReal("MISCBC",ThirdNearestEnemyOf(Myself))
!HasItemEquiped("RR#HELMD",ThirdNearestEnemyOf(Myself))
!Race(ThirdNearestEnemyOf(Myself),RAKSHASA)
See(ThirdNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_SPOOK)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,HELD)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SecondNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(SecondNearestEnemyOf(Myself),5,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SecondNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!General(SecondNearestEnemyOf(Myself),UNDEAD)
!Race(SecondNearestEnemyOf(Myself),SLIME)
!Race(SecondNearestEnemyOf(Myself),GOLEM)
!Race(SecondNearestEnemyOf(Myself),DEMONIC)
!Race(SecondNearestEnemyOf(Myself),TROLL)
!Kit(SecondNearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_RESIST_FEAR)
!CheckStat(SecondNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("CLCK30",SecondNearestEnemyOf(Myself))
!HasItemEquipedReal("SW1H32",SecondNearestEnemyOf(Myself))
!HasItemEquipedReal("MISCBC",SecondNearestEnemyOf(Myself))
!HasItemEquiped("RR#HELMD",SecondNearestEnemyOf(Myself))
!Race(SecondNearestEnemyOf(Myself),RAKSHASA)
See(SecondNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_SPOOK)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(NearestEnemyOf(Myself),0,HELD)
!StateCheck(NearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(NearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStat(NearestEnemyOf(Myself),5,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(NearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(NearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!General(NearestEnemyOf(Myself),UNDEAD)
!Race(NearestEnemyOf(Myself),SLIME)
!Race(NearestEnemyOf(Myself),GOLEM)
!Race(NearestEnemyOf(Myself),DEMONIC)
!Race(NearestEnemyOf(Myself),TROLL)
!Kit(NearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_RESIST_FEAR)
!CheckStat(NearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("CLCK30",NearestEnemyOf(Myself))
!HasItemEquipedReal("SW1H32",NearestEnemyOf(Myself))
!HasItemEquipedReal("MISCBC",NearestEnemyOf(Myself))
!HasItemEquiped("RR#HELMD",NearestEnemyOf(Myself))
!Race(NearestEnemyOf(Myself),RAKSHASA)
See(NearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
HaveSpell(WIZARD_SPOOK)
CheckStatLT(Myself,50,SPELLFAILUREMAGE)
!StateCheck(Myself,STATE_SILENCED)
!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
!CheckStatGT(LastSeenBy(Myself),0,HELD)
!StateCheck(LastSeenBy(Myself),STATE_STONE_DEATH)
!CheckStatGT(LastSeenBy(Myself),50,RESISTMAGIC)
!CheckStat(LastSeenBy(Myself),5,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!General(LastSeenBy(Myself),UNDEAD)
!Race(LastSeenBy(Myself),SLIME)
!Race(LastSeenBy(Myself),GOLEM)
!Race(LastSeenBy(Myself),DEMONIC)
!Race(LastSeenBy(Myself),TROLL)
!Kit(LastSeenBy(Myself),CAVALIER)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_RESIST_FEAR)
!CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("CLCK30",LastSeenBy(Myself))
!HasItemEquipedReal("SW1H32",LastSeenBy(Myself))
!HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
!HasItemEquiped("RR#HELMD",LastSeenBy(Myself))
!Race(LastSeenBy(Myself),RAKSHASA)
See(LastSeenBy(Myself))
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
Spell(LastSeenBy(Myself),WIZARD_SPOOK)
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,HELD)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(ThirdNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(ThirdNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(ThirdNearestEnemyOf(Myself),1,WIZARD_SPELL_IMMUNITY)
!General(ThirdNearestEnemyOf(Myself),UNDEAD)
!Race(ThirdNearestEnemyOf(Myself),DEMONIC)
!Race(ThirdNearestEnemyOf(Myself),GOLEM)
!Race(ThirdNearestEnemyOf(Myself),ELEMENTAL)
!Race(ThirdNearestEnemyOf(Myself),SLIME)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISEASED)
!HasItemEquiped("ring39",ThirdNearestEnemyOf(Myself))
!HasItemEquiped("misc8j",ThirdNearestEnemyOf(Myself))
Range(ThirdNearestEnemyOf(Myself),2)
!Race(ThirdNearestEnemyOf(Myself),RAKSHASA)
See(ThirdNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,HELD)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SecondNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SecondNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(SecondNearestEnemyOf(Myself),1,WIZARD_SPELL_IMMUNITY)
!General(SecondNearestEnemyOf(Myself),UNDEAD)
!Race(SecondNearestEnemyOf(Myself),DEMONIC)
!Race(SecondNearestEnemyOf(Myself),GOLEM)
!Race(SecondNearestEnemyOf(Myself),ELEMENTAL)
!Race(SecondNearestEnemyOf(Myself),SLIME)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISEASED)
!HasItemEquiped("ring39",SecondNearestEnemyOf(Myself))
!HasItemEquiped("misc8j",SecondNearestEnemyOf(Myself))
Range(SecondNearestEnemyOf(Myself),2)
!Race(SecondNearestEnemyOf(Myself),RAKSHASA)
See(SecondNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(NearestEnemyOf(Myself),0,HELD)
!StateCheck(NearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(NearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(NearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(NearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(NearestEnemyOf(Myself),1,WIZARD_SPELL_IMMUNITY)
!General(NearestEnemyOf(Myself),UNDEAD)
!Race(NearestEnemyOf(Myself),DEMONIC)
!Race(NearestEnemyOf(Myself),GOLEM)
!Race(NearestEnemyOf(Myself),ELEMENTAL)
!Race(NearestEnemyOf(Myself),SLIME)
!StateCheck(NearestEnemyOf(Myself),STATE_DISEASED)
!HasItemEquiped("ring39",NearestEnemyOf(Myself))
!HasItemEquiped("misc8j",NearestEnemyOf(Myself))
Range(NearestEnemyOf(Myself),2)
!Race(NearestEnemyOf(Myself),RAKSHASA)
See(NearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
!CheckStatGT(LastSeenBy(Myself),0,HELD)
!StateCheck(LastSeenBy(Myself),STATE_STONE_DEATH)
!CheckStatGT(LastSeenBy(Myself),50,RESISTMAGIC)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_IMMUNITY)
!General(LastSeenBy(Myself),UNDEAD)
!Race(LastSeenBy(Myself),DEMONIC)
!Race(LastSeenBy(Myself),GOLEM)
!Race(LastSeenBy(Myself),ELEMENTAL)
!Race(LastSeenBy(Myself),SLIME)
!StateCheck(LastSeenBy(Myself),STATE_DISEASED)
!HasItemEquiped("ring39",LastSeenBy(Myself))
!HasItemEquiped("misc8j",LastSeenBy(Myself))
Range(LastSeenBy(Myself),2)
!Race(LastSeenBy(Myself),RAKSHASA)
See(LastSeenBy(Myself))
THEN
RESPONSE #70
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("fl#csdis",LastSeenBy(Myself))
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(NearestEnemyOf(Myself))
!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(NearestEnemyOf(Myself),0,HELD)
!StateCheck(NearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(NearestEnemyOf(Myself),75,RESISTMAGIC)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(NearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(NearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(NearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
!Race(NearestEnemyOf(Myself),LICH)
!Race(NearestEnemyOf(Myself),RAKSHASA)
!HasItemEquiped("clck26",NearestEnemyOf(Myself))
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("RR#WI112",NearestEnemyOf(Myself))
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(SecondNearestEnemyOf(Myself))
!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,HELD)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SecondNearestEnemyOf(Myself),75,RESISTMAGIC)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SecondNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(SecondNearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
!Race(SecondNearestEnemyOf(Myself),LICH)
!Race(SecondNearestEnemyOf(Myself),RAKSHASA)
!HasItemEquiped("clck26",SecondNearestEnemyOf(Myself))
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("RR#WI112",SecondNearestEnemyOf(Myself))
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(ThirdNearestEnemyOf(Myself))
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,HELD)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(ThirdNearestEnemyOf(Myself),75,RESISTMAGIC)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(ThirdNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(ThirdNearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
!Race(ThirdNearestEnemyOf(Myself),LICH)
!Race(ThirdNearestEnemyOf(Myself),RAKSHASA)
!HasItemEquiped("clck26",ThirdNearestEnemyOf(Myself))
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("RR#WI112",ThirdNearestEnemyOf(Myself))
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(FourthNearestEnemyOf(Myself))
!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FourthNearestEnemyOf(Myself),75,RESISTMAGIC)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(FourthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(FourthNearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
!Race(FourthNearestEnemyOf(Myself),LICH)
!Race(FourthNearestEnemyOf(Myself),RAKSHASA)
!HasItemEquiped("clck26",FourthNearestEnemyOf(Myself))
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("RR#WI112",FourthNearestEnemyOf(Myself))
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(FifthNearestEnemyOf(Myself))
!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FifthNearestEnemyOf(Myself),75,RESISTMAGIC)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(FifthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(FifthNearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
!Race(FifthNearestEnemyOf(Myself),LICH)
!Race(FifthNearestEnemyOf(Myself),RAKSHASA)
!HasItemEquiped("clck26",FifthNearestEnemyOf(Myself))
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("RR#WI112",FifthNearestEnemyOf(Myself))
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(SixthNearestEnemyOf(Myself))
!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,HELD)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SixthNearestEnemyOf(Myself),75,RESISTMAGIC)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SixthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(SixthNearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
!Race(SixthNearestEnemyOf(Myself),LICH)
!Race(SixthNearestEnemyOf(Myself),RAKSHASA)
!HasItemEquiped("clck26",SixthNearestEnemyOf(Myself))
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("RR#WI112",SixthNearestEnemyOf(Myself))
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
General(SixthNearestEnemyOf(Myself),HUMANOID)
!Race(SixthNearestEnemyOf(Myself),RAKSHASA)
CheckStatGT(SixthNearestEnemyOf(Myself),5,SAVEVSSPELL)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,HELD)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SixthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SixthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(SixthNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!General(SixthNearestEnemyOf(Myself),UNDEAD)
!Race(SixthNearestEnemyOf(Myself),ELF)
!Race(SixthNearestEnemyOf(Myself),GOLEM)
!Race(SixthNearestEnemyOf(Myself),SLIME)
!Race(SixthNearestEnemyOf(Myself),DEMONIC)
!Race(SixthNearestEnemyOf(Myself),TROLL)
!Class(SixthNearestEnemyOf(Myself),MONK)
!Kit(SixthNearestEnemyOf(Myself),INQUISITOR)
!Kit(SixthNearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(SixthNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("helm06",SixthNearestEnemyOf(Myself))
!HasItemEquiped("ipsion",SixthNearestEnemyOf(Myself))
!HasItemEquipedReal("miscbc",SixthNearestEnemyOf(Myself))
!HasItemEquiped("npchan",SixthNearestEnemyOf(Myself))
!HasItemEquiped("shld25",SixthNearestEnemyOf(Myself))
!HasItemEquipedReal("sper07",SixthNearestEnemyOf(Myself))
!HasItemEquipedReal("staf11",SixthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h35",SixthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h54",SixthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw2h14",SixthNearestEnemyOf(Myself))
See(SixthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
General(FifthNearestEnemyOf(Myself),HUMANOID)
!Race(FifthNearestEnemyOf(Myself),RAKSHASA)
CheckStatGT(FifthNearestEnemyOf(Myself),5,SAVEVSSPELL)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FifthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(FifthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(FifthNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!General(FifthNearestEnemyOf(Myself),UNDEAD)
!Race(FifthNearestEnemyOf(Myself),ELF)
!Race(FifthNearestEnemyOf(Myself),GOLEM)
!Race(FifthNearestEnemyOf(Myself),SLIME)
!Race(FifthNearestEnemyOf(Myself),DEMONIC)
!Race(FifthNearestEnemyOf(Myself),TROLL)
!Class(FifthNearestEnemyOf(Myself),MONK)
!Kit(FifthNearestEnemyOf(Myself),INQUISITOR)
!Kit(FifthNearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(FifthNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("helm06",FifthNearestEnemyOf(Myself))
!HasItemEquiped("ipsion",FifthNearestEnemyOf(Myself))
!HasItemEquipedReal("miscbc",FifthNearestEnemyOf(Myself))
!HasItemEquiped("npchan",FifthNearestEnemyOf(Myself))
!HasItemEquiped("shld25",FifthNearestEnemyOf(Myself))
!HasItemEquipedReal("sper07",FifthNearestEnemyOf(Myself))
!HasItemEquipedReal("staf11",FifthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h35",FifthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h54",FifthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw2h14",FifthNearestEnemyOf(Myself))
See(FifthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
General(FourthNearestEnemyOf(Myself),HUMANOID)
!Race(FourthNearestEnemyOf(Myself),RAKSHASA)
CheckStatGT(FourthNearestEnemyOf(Myself),5,SAVEVSSPELL)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FourthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(FourthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(FourthNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!General(FourthNearestEnemyOf(Myself),UNDEAD)
!Race(FourthNearestEnemyOf(Myself),ELF)
!Race(FourthNearestEnemyOf(Myself),GOLEM)
!Race(FourthNearestEnemyOf(Myself),SLIME)
!Race(FourthNearestEnemyOf(Myself),DEMONIC)
!Race(FourthNearestEnemyOf(Myself),TROLL)
!Class(FourthNearestEnemyOf(Myself),MONK)
!Kit(FourthNearestEnemyOf(Myself),INQUISITOR)
!Kit(FourthNearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(FourthNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("helm06",FourthNearestEnemyOf(Myself))
!HasItemEquiped("ipsion",FourthNearestEnemyOf(Myself))
!HasItemEquipedReal("miscbc",FourthNearestEnemyOf(Myself))
!HasItemEquiped("npchan",FourthNearestEnemyOf(Myself))
!HasItemEquiped("shld25",FourthNearestEnemyOf(Myself))
!HasItemEquipedReal("sper07",FourthNearestEnemyOf(Myself))
!HasItemEquipedReal("staf11",FourthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h35",FourthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h54",FourthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw2h14",FourthNearestEnemyOf(Myself))
See(FourthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
General(ThirdNearestEnemyOf(Myself),HUMANOID)
!Race(ThirdNearestEnemyOf(Myself),RAKSHASA)
CheckStatGT(ThirdNearestEnemyOf(Myself),5,SAVEVSSPELL)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,HELD)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(ThirdNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(ThirdNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(ThirdNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!General(ThirdNearestEnemyOf(Myself),UNDEAD)
!Race(ThirdNearestEnemyOf(Myself),ELF)
!Race(ThirdNearestEnemyOf(Myself),GOLEM)
!Race(ThirdNearestEnemyOf(Myself),SLIME)
!Race(ThirdNearestEnemyOf(Myself),DEMONIC)
!Race(ThirdNearestEnemyOf(Myself),TROLL)
!Class(ThirdNearestEnemyOf(Myself),MONK)
!Kit(ThirdNearestEnemyOf(Myself),INQUISITOR)
!Kit(ThirdNearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(ThirdNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("helm06",ThirdNearestEnemyOf(Myself))
!HasItemEquiped("ipsion",ThirdNearestEnemyOf(Myself))
!HasItemEquipedReal("miscbc",ThirdNearestEnemyOf(Myself))
!HasItemEquiped("npchan",ThirdNearestEnemyOf(Myself))
!HasItemEquiped("shld25",ThirdNearestEnemyOf(Myself))
!HasItemEquipedReal("sper07",ThirdNearestEnemyOf(Myself))
!HasItemEquipedReal("staf11",ThirdNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h35",ThirdNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h54",ThirdNearestEnemyOf(Myself))
!HasItemEquipedReal("sw2h14",ThirdNearestEnemyOf(Myself))
See(ThirdNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
General(SecondNearestEnemyOf(Myself),HUMANOID)
!Race(SecondNearestEnemyOf(Myself),RAKSHASA)
CheckStatGT(SecondNearestEnemyOf(Myself),5,SAVEVSSPELL)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,HELD)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SecondNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SecondNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(SecondNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!General(SecondNearestEnemyOf(Myself),UNDEAD)
!Race(SecondNearestEnemyOf(Myself),ELF)
!Race(SecondNearestEnemyOf(Myself),GOLEM)
!Race(SecondNearestEnemyOf(Myself),SLIME)
!Race(SecondNearestEnemyOf(Myself),DEMONIC)
!Race(SecondNearestEnemyOf(Myself),TROLL)
!Class(SecondNearestEnemyOf(Myself),MONK)
!Kit(SecondNearestEnemyOf(Myself),INQUISITOR)
!Kit(SecondNearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(SecondNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("helm06",SecondNearestEnemyOf(Myself))
!HasItemEquiped("ipsion",SecondNearestEnemyOf(Myself))
!HasItemEquipedReal("miscbc",SecondNearestEnemyOf(Myself))
!HasItemEquiped("npchan",SecondNearestEnemyOf(Myself))
!HasItemEquiped("shld25",SecondNearestEnemyOf(Myself))
!HasItemEquipedReal("sper07",SecondNearestEnemyOf(Myself))
!HasItemEquipedReal("staf11",SecondNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h35",SecondNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h54",SecondNearestEnemyOf(Myself))
!HasItemEquipedReal("sw2h14",SecondNearestEnemyOf(Myself))
See(SecondNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
General(NearestEnemyOf(Myself),HUMANOID)
!Race(NearestEnemyOf(Myself),RAKSHASA)
CheckStatGT(NearestEnemyOf(Myself),5,SAVEVSSPELL)
!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(NearestEnemyOf(Myself),0,HELD)
!StateCheck(NearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(NearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(NearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(NearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(NearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!General(NearestEnemyOf(Myself),UNDEAD)
!Race(NearestEnemyOf(Myself),ELF)
!Race(NearestEnemyOf(Myself),GOLEM)
!Race(NearestEnemyOf(Myself),SLIME)
!Race(NearestEnemyOf(Myself),DEMONIC)
!Race(NearestEnemyOf(Myself),TROLL)
!Class(NearestEnemyOf(Myself),MONK)
!Kit(NearestEnemyOf(Myself),INQUISITOR)
!Kit(NearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(NearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(NearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("helm06",NearestEnemyOf(Myself))
!HasItemEquiped("ipsion",NearestEnemyOf(Myself))
!HasItemEquipedReal("miscbc",NearestEnemyOf(Myself))
!HasItemEquiped("npchan",NearestEnemyOf(Myself))
!HasItemEquiped("shld25",NearestEnemyOf(Myself))
!HasItemEquipedReal("sper07",NearestEnemyOf(Myself))
!HasItemEquipedReal("staf11",NearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h35",NearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h54",NearestEnemyOf(Myself))
!HasItemEquipedReal("sw2h14",NearestEnemyOf(Myself))
See(NearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
General(LastSeenBy(Myself),HUMANOID)
!Race(LastSeenBy(Myself),RAKSHASA)
CheckStatGT(LastSeenBy(Myself),5,SAVEVSSPELL)
!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
!CheckStatGT(LastSeenBy(Myself),0,HELD)
!StateCheck(LastSeenBy(Myself),STATE_STONE_DEATH)
!CheckStatGT(LastSeenBy(Myself),50,RESISTMAGIC)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
!General(LastSeenBy(Myself),UNDEAD)
!Race(LastSeenBy(Myself),ELF)
!Race(LastSeenBy(Myself),GOLEM)
!Race(LastSeenBy(Myself),SLIME)
!Race(LastSeenBy(Myself),DEMONIC)
!Race(LastSeenBy(Myself),TROLL)
!Class(LastSeenBy(Myself),MONK)
!Kit(LastSeenBy(Myself),INQUISITOR)
!Kit(LastSeenBy(Myself),CAVALIER)
!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("helm06",LastSeenBy(Myself))
!HasItemEquiped("ipsion",LastSeenBy(Myself))
!HasItemEquipedReal("miscbc",LastSeenBy(Myself))
!HasItemEquiped("npchan",LastSeenBy(Myself))
!HasItemEquiped("shld25",LastSeenBy(Myself))
!HasItemEquipedReal("sper07",LastSeenBy(Myself))
!HasItemEquipedReal("staf11",LastSeenBy(Myself))
!HasItemEquipedReal("sw1h35",LastSeenBy(Myself))
!HasItemEquipedReal("sw1h54",LastSeenBy(Myself))
!HasItemEquipedReal("sw2h14",LastSeenBy(Myself))
See(LastSeenBy(Myself))
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("RR#WI104",LastSeenBy(Myself))
RESPONSE #100
Continue()
END

IF
See(NearestEnemyOf(Myself))
HasItem("melfmet",Myself)
!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(NearestEnemyOf(Myself),0,HELD)
!StateCheck(NearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(NearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(NearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(NearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(NearestEnemyOf(Myself),75,RESISTPIERCING)
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(NearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",NearestEnemyOf(Myself))
OR(2)
CheckStatLT(NearestEnemyOf(Myself),100,RESISTFIRE)
!CheckStatGT(NearestEnemyOf(Myself),0,STONESKINS)
OR(5)
Class(NearestEnemyOf(Myself),MAGE_ALL)
Class(NearestEnemyOf(Myself),BARD_ALL)
Class(NearestEnemyOf(Myself),CLERIC_ALL)
Class(NearestEnemyOf(Myself),CLERIC_RANGER)
Class(NearestEnemyOf(Myself),DRUID_ALL)
THEN
RESPONSE #100
AttackOneRound(NearestEnemyOf(Myself))
END

IF
See(SecondNearestEnemyOf(Myself))
HasItem("melfmet",Myself)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,HELD)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SecondNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SecondNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(SecondNearestEnemyOf(Myself),75,RESISTPIERCING)
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearestEnemyOf(Myself))
OR(2)
CheckStatLT(SecondNearestEnemyOf(Myself),100,RESISTFIRE)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,STONESKINS)
OR(5)
Class(SecondNearestEnemyOf(Myself),MAGE_ALL)
Class(SecondNearestEnemyOf(Myself),BARD_ALL)
Class(SecondNearestEnemyOf(Myself),CLERIC_ALL)
Class(SecondNearestEnemyOf(Myself),CLERIC_RANGER)
Class(SecondNearestEnemyOf(Myself),DRUID_ALL)
THEN
RESPONSE #100
AttackOneRound(SecondNearestEnemyOf(Myself))
END

IF
See(ThirdNearestEnemyOf(Myself))
HasItem("melfmet",Myself)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,HELD)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(ThirdNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(ThirdNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(ThirdNearestEnemyOf(Myself),75,RESISTPIERCING)
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearestEnemyOf(Myself))
OR(2)
CheckStatLT(ThirdNearestEnemyOf(Myself),100,RESISTFIRE)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,STONESKINS)
OR(5)
Class(ThirdNearestEnemyOf(Myself),MAGE_ALL)
Class(ThirdNearestEnemyOf(Myself),BARD_ALL)
Class(ThirdNearestEnemyOf(Myself),CLERIC_ALL)
Class(ThirdNearestEnemyOf(Myself),CLERIC_RANGER)
Class(ThirdNearestEnemyOf(Myself),DRUID_ALL)
THEN
RESPONSE #100
AttackOneRound(ThirdNearestEnemyOf(Myself))
END

IF
See(FourthNearestEnemyOf(Myself))
HasItem("melfmet",Myself)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FourthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(FourthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(FourthNearestEnemyOf(Myself),75,RESISTPIERCING)
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FourthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FourthNearestEnemyOf(Myself))
OR(2)
CheckStatLT(FourthNearestEnemyOf(Myself),100,RESISTFIRE)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,STONESKINS)
OR(5)
Class(FourthNearestEnemyOf(Myself),MAGE_ALL)
Class(FourthNearestEnemyOf(Myself),BARD_ALL)
Class(FourthNearestEnemyOf(Myself),CLERIC_ALL)
Class(FourthNearestEnemyOf(Myself),CLERIC_RANGER)
Class(FourthNearestEnemyOf(Myself),DRUID_ALL)
THEN
RESPONSE #100
AttackOneRound(FourthNearestEnemyOf(Myself))
END

IF
See(FifthNearestEnemyOf(Myself))
HasItem("melfmet",Myself)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FifthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(FifthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(FifthNearestEnemyOf(Myself),75,RESISTPIERCING)
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FifthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FifthNearestEnemyOf(Myself))
OR(2)
CheckStatLT(FifthNearestEnemyOf(Myself),100,RESISTFIRE)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,STONESKINS)
OR(5)
Class(FifthNearestEnemyOf(Myself),MAGE_ALL)
Class(FifthNearestEnemyOf(Myself),BARD_ALL)
Class(FifthNearestEnemyOf(Myself),CLERIC_ALL)
Class(FifthNearestEnemyOf(Myself),CLERIC_RANGER)
Class(FifthNearestEnemyOf(Myself),DRUID_ALL)
THEN
RESPONSE #100
AttackOneRound(FifthNearestEnemyOf(Myself))
END

IF
See(SixthNearestEnemyOf(Myself))
HasItem("melfmet",Myself)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,HELD)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SixthNearestEnemyOf(Myself),50,RESISTMAGIC)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SixthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(SixthNearestEnemyOf(Myself),75,RESISTPIERCING)
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SixthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SixthNearestEnemyOf(Myself))
OR(2)
CheckStatLT(SixthNearestEnemyOf(Myself),100,RESISTFIRE)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,STONESKINS)
OR(5)
Class(SixthNearestEnemyOf(Myself),MAGE_ALL)
Class(SixthNearestEnemyOf(Myself),BARD_ALL)
Class(SixthNearestEnemyOf(Myself),CLERIC_ALL)
Class(SixthNearestEnemyOf(Myself),CLERIC_RANGER)
Class(SixthNearestEnemyOf(Myself),DRUID_ALL)
THEN
RESPONSE #100
AttackOneRound(SixthNearestEnemyOf(Myself))
END

IF
See(NearestEnemyOf(Myself))
HasItem("melfmet",Myself)
!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(NearestEnemyOf(Myself),0,HELD)
!StateCheck(NearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(NearestEnemyOf(Myself),75,RESISTPIERCING)
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(NearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",NearestEnemyOf(Myself))
THEN
RESPONSE #100
AttackOneRound(NearestEnemyOf(Myself))
END

IF
See(SecondNearestEnemyOf(Myself))
HasItem("melfmet",Myself)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,HELD)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SecondNearestEnemyOf(Myself),75,RESISTPIERCING)
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearestEnemyOf(Myself))
THEN
RESPONSE #100
AttackOneRound(SecondNearestEnemyOf(Myself))
END

IF
See(ThirdNearestEnemyOf(Myself))
HasItem("melfmet",Myself)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,HELD)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(ThirdNearestEnemyOf(Myself),75,RESISTPIERCING)
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearestEnemyOf(Myself))
THEN
RESPONSE #100
AttackOneRound(ThirdNearestEnemyOf(Myself))
END

IF
See(FourthNearestEnemyOf(Myself))
HasItem("melfmet",Myself)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FourthNearestEnemyOf(Myself),75,RESISTPIERCING)
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FourthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FourthNearestEnemyOf(Myself))
THEN
RESPONSE #100
AttackOneRound(FourthNearestEnemyOf(Myself))
END

IF
See(FifthNearestEnemyOf(Myself))
HasItem("melfmet",Myself)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FifthNearestEnemyOf(Myself),75,RESISTPIERCING)
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FifthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FifthNearestEnemyOf(Myself))
THEN
RESPONSE #100
AttackOneRound(FifthNearestEnemyOf(Myself))
END

IF
See(SixthNearestEnemyOf(Myself))
HasItem("melfmet",Myself)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,HELD)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SixthNearestEnemyOf(Myself),75,RESISTPIERCING)
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SixthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SixthNearestEnemyOf(Myself))
THEN
RESPONSE #100
AttackOneRound(SixthNearestEnemyOf(Myself))
END

IF
See(NearestEnemyOf(Myself))
HasItem("melfmet",Myself)
!CheckStatGT(NearestEnemyOf(Myself),99,RESISTPIERCING)
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(NearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",NearestEnemyOf(Myself))
THEN
RESPONSE #100
AttackOneRound(NearestEnemyOf(Myself))
END

IF
See(SecondNearestEnemyOf(Myself))
HasItem("melfmet",Myself)
!CheckStatGT(SecondNearestEnemyOf(Myself),99,RESISTPIERCING)
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearestEnemyOf(Myself))
THEN
RESPONSE #100
AttackOneRound(SecondNearestEnemyOf(Myself))
END

IF
See(ThirdNearestEnemyOf(Myself))
HasItem("melfmet",Myself)
!CheckStatGT(ThirdNearestEnemyOf(Myself),99,RESISTPIERCING)
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearestEnemyOf(Myself))
THEN
RESPONSE #100
AttackOneRound(ThirdNearestEnemyOf(Myself))
END

IF
See(FourthNearestEnemyOf(Myself))
HasItem("melfmet",Myself)
!CheckStatGT(FourthNearestEnemyOf(Myself),99,RESISTPIERCING)
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FourthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FourthNearestEnemyOf(Myself))
THEN
RESPONSE #100
AttackOneRound(FourthNearestEnemyOf(Myself))
END

IF
See(FifthNearestEnemyOf(Myself))
HasItem("melfmet",Myself)
!CheckStatGT(FifthNearestEnemyOf(Myself),99,RESISTPIERCING)
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FifthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FifthNearestEnemyOf(Myself))
THEN
RESPONSE #100
AttackOneRound(FifthNearestEnemyOf(Myself))
END

IF
See(SixthNearestEnemyOf(Myself))
HasItem("melfmet",Myself)
!CheckStatGT(SixthNearestEnemyOf(Myself),99,RESISTPIERCING)
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SixthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SixthNearestEnemyOf(Myself))
THEN
RESPONSE #100
AttackOneRound(SixthNearestEnemyOf(Myself))
END

IF
See(NearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(NearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",NearestEnemyOf(Myself))
!CheckStatGT(NearestEnemyOf(Myself),99,RESISTSLASHING)
StateCheck(NearestEnemyOf(Myself),STATE_IMMOBILE)
THEN
RESPONSE #100
AttackOneRound(NearestEnemyOf(Myself))
END

IF
See(SecondNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearestEnemyOf(Myself))
!CheckStatGT(SecondNearestEnemyOf(Myself),99,RESISTSLASHING)
StateCheck(SecondNearestEnemyOf(Myself),STATE_IMMOBILE)
THEN
RESPONSE #100
AttackOneRound(SecondNearestEnemyOf(Myself))
END

IF
See(ThirdNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearestEnemyOf(Myself))
!CheckStatGT(ThirdNearestEnemyOf(Myself),99,RESISTSLASHING)
StateCheck(ThirdNearestEnemyOf(Myself),STATE_IMMOBILE)
THEN
RESPONSE #100
AttackOneRound(ThirdNearestEnemyOf(Myself))
END

IF
See(FourthNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FourthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FourthNearestEnemyOf(Myself))
!CheckStatGT(FourthNearestEnemyOf(Myself),99,RESISTSLASHING)
StateCheck(FourthNearestEnemyOf(Myself),STATE_IMMOBILE)
THEN
RESPONSE #100
AttackOneRound(FourthNearestEnemyOf(Myself))
END

IF
See(FifthNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FifthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FifthNearestEnemyOf(Myself))
!CheckStatGT(FifthNearestEnemyOf(Myself),99,RESISTSLASHING)
StateCheck(FifthNearestEnemyOf(Myself),STATE_IMMOBILE)
THEN
RESPONSE #100
AttackOneRound(FifthNearestEnemyOf(Myself))
END

IF
See(SixthNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SixthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SixthNearestEnemyOf(Myself))
!CheckStatGT(SixthNearestEnemyOf(Myself),99,RESISTSLASHING)
StateCheck(SixthNearestEnemyOf(Myself),STATE_IMMOBILE)
THEN
RESPONSE #100
AttackOneRound(SixthNearestEnemyOf(Myself))
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(NearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(NearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",NearestEnemyOf(Myself))
!CheckStatGT(NearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(NearestEnemyOf(Myself),0,STONESKINS)
!StateCheck(NearestEnemyOf(Myself),STATE_MIRRORIMAGE)
!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(NearestEnemyOf(Myself),0,HELD)
!StateCheck(NearestEnemyOf(Myself),STATE_STONE_DEATH)
!Range(NearestEnemyOf(Myself),5)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("RR#TELWE",NearestEnemyOf(Myself))
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(SecondNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearestEnemyOf(Myself))
!CheckStatGT(SecondNearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,STONESKINS)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_MIRRORIMAGE)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,HELD)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_STONE_DEATH)
!Range(SecondNearestEnemyOf(Myself),5)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("RR#TELWE",SecondNearestEnemyOf(Myself))
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(ThirdNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearestEnemyOf(Myself))
!CheckStatGT(ThirdNearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,STONESKINS)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_MIRRORIMAGE)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,HELD)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STONE_DEATH)
!Range(ThirdNearestEnemyOf(Myself),5)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("RR#TELWE",ThirdNearestEnemyOf(Myself))
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(FourthNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FourthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FourthNearestEnemyOf(Myself))
!CheckStatGT(FourthNearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,STONESKINS)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_MIRRORIMAGE)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!Range(FourthNearestEnemyOf(Myself),5)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("RR#TELWE",FourthNearestEnemyOf(Myself))
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(FifthNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FifthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FifthNearestEnemyOf(Myself))
!CheckStatGT(FifthNearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,STONESKINS)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_MIRRORIMAGE)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!Range(FifthNearestEnemyOf(Myself),5)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("RR#TELWE",FifthNearestEnemyOf(Myself))
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(SixthNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SixthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SixthNearestEnemyOf(Myself))
!CheckStatGT(SixthNearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,STONESKINS)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_MIRRORIMAGE)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,HELD)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!Range(SixthNearestEnemyOf(Myself),5)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("RR#TELWE",SixthNearestEnemyOf(Myself))
END

IF
See(NearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(NearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",NearestEnemyOf(Myself))
!CheckStatGT(NearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(NearestEnemyOf(Myself),0,STONESKINS)
!StateCheck(NearestEnemyOf(Myself),STATE_MIRRORIMAGE)
!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(NearestEnemyOf(Myself),0,HELD)
!StateCheck(NearestEnemyOf(Myself),STATE_STONE_DEATH)
THEN
RESPONSE #100
AttackOneRound(NearestEnemyOf(Myself))
END

IF
See(SecondNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearestEnemyOf(Myself))
!CheckStatGT(SecondNearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,STONESKINS)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_MIRRORIMAGE)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,HELD)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_STONE_DEATH)
THEN
RESPONSE #100
AttackOneRound(SecondNearestEnemyOf(Myself))
END

IF
See(ThirdNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearestEnemyOf(Myself))
!CheckStatGT(ThirdNearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,STONESKINS)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_MIRRORIMAGE)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,HELD)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STONE_DEATH)
THEN
RESPONSE #100
AttackOneRound(ThirdNearestEnemyOf(Myself))
END

IF
See(FourthNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FourthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FourthNearestEnemyOf(Myself))
!CheckStatGT(FourthNearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,STONESKINS)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_MIRRORIMAGE)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_STONE_DEATH)
THEN
RESPONSE #100
AttackOneRound(FourthNearestEnemyOf(Myself))
END

IF
See(FifthNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FifthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FifthNearestEnemyOf(Myself))
!CheckStatGT(FifthNearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,STONESKINS)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_MIRRORIMAGE)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_STONE_DEATH)
THEN
RESPONSE #100
AttackOneRound(FifthNearestEnemyOf(Myself))
END

IF
See(SixthNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SixthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SixthNearestEnemyOf(Myself))
!CheckStatGT(SixthNearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,STONESKINS)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_MIRRORIMAGE)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,HELD)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_STONE_DEATH)
THEN
RESPONSE #100
AttackOneRound(SixthNearestEnemyOf(Myself))
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(NearestEnemyOf(Myself))
!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(NearestEnemyOf(Myself),0,HELD)
!StateCheck(NearestEnemyOf(Myself),STATE_STONE_DEATH)
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(NearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",NearestEnemyOf(Myself))
!CheckStatGT(NearestEnemyOf(Myself),99,RESISTSLASHING)
!Range(NearestEnemyOf(Myself),5)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("RR#TELWE",NearestEnemyOf(Myself))
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(SecondNearestEnemyOf(Myself))
!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,HELD)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_STONE_DEATH)
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearestEnemyOf(Myself))
!CheckStatGT(SecondNearestEnemyOf(Myself),99,RESISTSLASHING)
!Range(SecondNearestEnemyOf(Myself),5)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("RR#TELWE",SecondNearestEnemyOf(Myself))
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(ThirdNearestEnemyOf(Myself))
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,HELD)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STONE_DEATH)
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearestEnemyOf(Myself))
!CheckStatGT(ThirdNearestEnemyOf(Myself),99,RESISTSLASHING)
!Range(ThirdNearestEnemyOf(Myself),5)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("RR#TELWE",ThirdNearestEnemyOf(Myself))
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(FourthNearestEnemyOf(Myself))
!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_STONE_DEATH)
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FourthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FourthNearestEnemyOf(Myself))
!CheckStatGT(FourthNearestEnemyOf(Myself),99,RESISTSLASHING)
!Range(FourthNearestEnemyOf(Myself),5)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("RR#TELWE",FourthNearestEnemyOf(Myself))
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(FifthNearestEnemyOf(Myself))
!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_STONE_DEATH)
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FifthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FifthNearestEnemyOf(Myself))
!CheckStatGT(FifthNearestEnemyOf(Myself),99,RESISTSLASHING)
!Range(FifthNearestEnemyOf(Myself),5)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("RR#TELWE",FifthNearestEnemyOf(Myself))
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(SixthNearestEnemyOf(Myself))
!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,HELD)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_STONE_DEATH)
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SixthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SixthNearestEnemyOf(Myself))
!CheckStatGT(SixthNearestEnemyOf(Myself),99,RESISTSLASHING)
!Range(SixthNearestEnemyOf(Myself),5)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("RR#TELWE",SixthNearestEnemyOf(Myself))
END

IF
See(NearestEnemyOf(Myself))
!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(NearestEnemyOf(Myself),0,HELD)
!StateCheck(NearestEnemyOf(Myself),STATE_STONE_DEATH)
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(NearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",NearestEnemyOf(Myself))
!CheckStatGT(NearestEnemyOf(Myself),99,RESISTSLASHING)
THEN
RESPONSE #100
AttackOneRound(NearestEnemyOf(Myself))
END

IF
See(SecondNearestEnemyOf(Myself))
!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,HELD)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_STONE_DEATH)
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearestEnemyOf(Myself))
!CheckStatGT(SecondNearestEnemyOf(Myself),99,RESISTSLASHING)
THEN
RESPONSE #100
AttackOneRound(SecondNearestEnemyOf(Myself))
END

IF
See(ThirdNearestEnemyOf(Myself))
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,HELD)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STONE_DEATH)
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearestEnemyOf(Myself))
!CheckStatGT(ThirdNearestEnemyOf(Myself),99,RESISTSLASHING)
THEN
RESPONSE #100
AttackOneRound(ThirdNearestEnemyOf(Myself))
END

IF
See(FourthNearestEnemyOf(Myself))
!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_STONE_DEATH)
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FourthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FourthNearestEnemyOf(Myself))
!CheckStatGT(FourthNearestEnemyOf(Myself),99,RESISTSLASHING)
THEN
RESPONSE #100
AttackOneRound(FourthNearestEnemyOf(Myself))
END

IF
See(FifthNearestEnemyOf(Myself))
!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_STONE_DEATH)
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FifthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FifthNearestEnemyOf(Myself))
!CheckStatGT(FifthNearestEnemyOf(Myself),99,RESISTSLASHING)
THEN
RESPONSE #100
AttackOneRound(FifthNearestEnemyOf(Myself))
END

IF
See(SixthNearestEnemyOf(Myself))
!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,HELD)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_STONE_DEATH)
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SixthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SixthNearestEnemyOf(Myself))
!CheckStatGT(SixthNearestEnemyOf(Myself),99,RESISTSLASHING)
THEN
RESPONSE #100
AttackOneRound(SixthNearestEnemyOf(Myself))
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(NearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(NearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",NearestEnemyOf(Myself))
!CheckStatGT(NearestEnemyOf(Myself),99,RESISTSLASHING)
!Range(NearestEnemyOf(Myself),5)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("RR#TELWE",NearestEnemyOf(Myself))
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(SecondNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearestEnemyOf(Myself))
!CheckStatGT(SecondNearestEnemyOf(Myself),99,RESISTSLASHING)
!Range(SecondNearestEnemyOf(Myself),5)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("RR#TELWE",SecondNearestEnemyOf(Myself))
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(ThirdNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearestEnemyOf(Myself))
!CheckStatGT(ThirdNearestEnemyOf(Myself),99,RESISTSLASHING)
!Range(ThirdNearestEnemyOf(Myself),5)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("RR#TELWE",ThirdNearestEnemyOf(Myself))
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(FourthNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FourthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FourthNearestEnemyOf(Myself))
!CheckStatGT(FourthNearestEnemyOf(Myself),99,RESISTSLASHING)
!Range(FourthNearestEnemyOf(Myself),5)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("RR#TELWE",FourthNearestEnemyOf(Myself))
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(FifthNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FifthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FifthNearestEnemyOf(Myself))
!CheckStatGT(FifthNearestEnemyOf(Myself),99,RESISTSLASHING)
!Range(FifthNearestEnemyOf(Myself),5)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("RR#TELWE",FifthNearestEnemyOf(Myself))
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
See(SixthNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SixthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SixthNearestEnemyOf(Myself))
!CheckStatGT(SixthNearestEnemyOf(Myself),99,RESISTSLASHING)
!Range(SixthNearestEnemyOf(Myself),5)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("RR#TELWE",SixthNearestEnemyOf(Myself))
END

IF
See(NearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(NearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",NearestEnemyOf(Myself))
!CheckStatGT(NearestEnemyOf(Myself),99,RESISTSLASHING)
THEN
RESPONSE #100
AttackOneRound(NearestEnemyOf(Myself))
END

IF
See(SecondNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearestEnemyOf(Myself))
!CheckStatGT(SecondNearestEnemyOf(Myself),99,RESISTSLASHING)
THEN
RESPONSE #100
AttackOneRound(SecondNearestEnemyOf(Myself))
END

IF
See(ThirdNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearestEnemyOf(Myself))
!CheckStatGT(ThirdNearestEnemyOf(Myself),99,RESISTSLASHING)
THEN
RESPONSE #100
AttackOneRound(ThirdNearestEnemyOf(Myself))
END

IF
See(FourthNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FourthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FourthNearestEnemyOf(Myself))
!CheckStatGT(FourthNearestEnemyOf(Myself),99,RESISTSLASHING)
THEN
RESPONSE #100
AttackOneRound(FourthNearestEnemyOf(Myself))
END

IF
See(FifthNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FifthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FifthNearestEnemyOf(Myself))
!CheckStatGT(FifthNearestEnemyOf(Myself),99,RESISTSLASHING)
THEN
RESPONSE #100
AttackOneRound(FifthNearestEnemyOf(Myself))
END

IF
See(SixthNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SixthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SixthNearestEnemyOf(Myself))
!CheckStatGT(SixthNearestEnemyOf(Myself),99,RESISTSLASHING)
THEN
RESPONSE #100
AttackOneRound(SixthNearestEnemyOf(Myself))
END

IF
!GlobalTimerNotExpired("flCast","LOCALS")
!StateCheck(Myself,STATE_INVISIBLE)
!CheckStatGT(NearestEnemyOf(Myself),0,TRUE_SIGHT)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,TRUE_SIGHT)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,TRUE_SIGHT)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,TRUE_SIGHT)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,TRUE_SIGHT)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,TRUE_SIGHT)
!CheckStatGT(SeventhNearestEnemyOf(Myself),0,TRUE_SIGHT)
!Global("dvgldust","LOCALS",1)
THEN
RESPONSE #100
SetGlobalTimer("flCast","LOCALS",6)
ForceSpellRES("RR#WI206",Myself)
RESPONSE #25
Continue()
END

IF
See([ANYONE])
False()
THEN
RESPONSE #100
Continue()
END

IF
Race(LastSeenBy(Myself),DEMONIC)
Alignment(LastSeenBy(Myself),MASK_EVIL)
Allegiance(Myself,GOODCUTOFF)
!Allegiance(LastSeenBy(Myself),EVILCUTOFF)
THEN
RESPONSE #100
RandomWalkContinuous()
END

IF
Race(LastSeenBy(Myself),DEMONIC)
Alignment(LastSeenBy(Myself),MASK_EVIL)
Allegiance(Myself,EVILCUTOFF)
!Allegiance(LastSeenBy(Myself),GOODCUTOFF)
THEN
RESPONSE #100
RandomWalkContinuous()
END

IF
OR(2)
Name("fl#propertyoftheyugoloth1",LastSeenBy(Myself))
Name("fl#propertyoftheyugoloth2",LastSeenBy(Myself))
Allegiance(Myself,GOODCUTOFF)
!Allegiance(LastSeenBy(Myself),EVILCUTOFF)
THEN
RESPONSE #100
RandomWalkContinuous()
END

IF
OR(2)
Name("fl#propertyoftheyugoloth1",LastSeenBy(Myself))
Name("fl#propertyoftheyugoloth2",LastSeenBy(Myself))
Allegiance(Myself,EVILCUTOFF)
!Allegiance(LastSeenBy(Myself),GOODCUTOFF)
THEN
RESPONSE #100
RandomWalkContinuous()
END

IF
!Range(LastSeenBy(Myself),6)
!GlobalTimerNotExpired("flCast","LOCALS")
ActionListEmpty()
THEN
RESPONSE #100
ForceSpellRES("RR#TELWE",LastSeenBy(Myself))
SetGlobalTimer("flCast","LOCALS",6)
END

IF
ActionListEmpty()
THEN
RESPONSE #100
AttackOneRound(LastSeenBy(Myself))
END

IF
ActionListEmpty()
THEN
RESPONSE #100
RandomWalkContinuous()
END

