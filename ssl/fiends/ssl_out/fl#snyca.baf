IF
HasItem("dw#sumfi",Myself)
THEN
RESPONSE #100
DestroyItem("dw#sumfi")
Continue()
END

IF
Die()
Global("fl#EACheck","LOCALS",1)
Global("fl#XP","LOCALS",0)
THEN
RESPONSE #100
SetGlobal("fl#XP","LOCALS",1)
AddexperienceParty(x)
END

IF
Global("fl#EACheck","LOCALS",0)
Allegiance(LastSummonerOf(Myself),GOODCUTOFF)
THEN
RESPONSE #100
SetInterrupt(FALSE)
SetGlobal("fl#EACheck","LOCALS",2)
DialogInterrupt(FALSE)
LeaveParty()
ChangeEnemyAlly(Myself,ALLY)
SetInterrupt(TRUE)
END

IF
Global("fl#EACheck","LOCALS",0)
Allegiance(LastSummonerOf(Myself),EVILCUTOFF)
THEN
RESPONSE #100
SetInterrupt(FALSE)
SetGlobal("fl#EACheck","LOCALS",1)
Enemy()
SetInterrupt(TRUE)
END

IF
Global("fl#EACheck","LOCALS",2)
Global("fl#Hostile","LOCALS",1)
Allegiance(Myself,EVILCUTOFF)
!See([PC])
THEN
RESPONSE #100
SetInterrupt(FALSE)
LeaveParty()
ChangeEnemyAlly(Myself,ALLY)
SetInterrupt(TRUE)
END

IF
Global("fl#EACheck","LOCALS",2)
Global("fl#Hostile","LOCALS",0)
!Allegiance(Myself,EVILCUTOFF)
See([PC])
THEN
RESPONSE #100
SetInterrupt(FALSE)
SetGlobal("fl#Hostile","LOCALS",1)
Enemy()
SetInterrupt(TRUE)
END

IF
StateCheck(Myself,STATE_REALLY_DEAD)
THEN
RESPONSE #100
NoAction()
END

IF
!InActiveArea(Myself)
!See([ANYONE])
THEN
RESPONSE #100
NoAction()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
OR(2)
AreaCheck("AR3004")
AreaCheck("AR3008")
THEN
RESPONSE #100
SetGlobalTimer("cast","LOCALS",600)
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
Exists(LastAttackerOf(Myself))
!Range(LastATtackerOf(Myself),6)
InMyArea(LastAttackerOf(Myself))
OR(2)
!Allegiance(LastAttackerOf(Myself),GOODCUTOFF)
!Allegiance(Myself,GOODCUTOFF)
!StateCheck(LastAttackerOf(Myself),STATE_REALLY_DEAD)
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(NODEFINEDTARGET,0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(NODEFINEDTARGET,4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(NODEFINEDTARGET,1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(NODEFINEDTARGET,2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(NODEFINEDTARGET,3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",NODEFINEDTARGET)
!CheckStatGT(NODEFINEDTARGET,99,RESISTSLASHING)
!CheckStatGT(NODEFINEDTARGET,0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",NODEFINEDTARGET)
!HasItemEquiped("wa2amu",NODEFINEDTARGET)
!See(NearestEnemyOf(Myself))
THEN
RESPONSE #100
SetGlobalTimer("cast","LOCALS",6)
ForceSpellRES("RR#TELWE",LastAttackerOf(Myself))
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
See(NearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(NearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",NearestEnemyOf(Myself))
!CheckStatGT(NearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(NearestEnemyOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",NearestEnemyOf(Myself))
!HasItemEquiped("wa2amu",NearestEnemyOf(Myself))
!HasItemEquiped("lich",NearestEnemyOf(Myself))
StateCheck(NearestEnemyOf(Myself),STATE_IMMOBILE)
!Range(NearestEnemyOf(Myself),6)
THEN
RESPONSE #100
SetGlobalTimer("cast","LOCALS",6)
ForceSpellRES("RR#TELWE",NearestEnemyOf(Myself))
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
See(SecondNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearestEnemyOf(Myself))
!CheckStatGT(SecondNearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",SecondNearestEnemyOf(Myself))
!HasItemEquiped("wa2amu",SecondNearestEnemyOf(Myself))
!HasItemEquiped("lich",SecondNearestEnemyOf(Myself))
StateCheck(SecondNearestEnemyOf(Myself),STATE_IMMOBILE)
!Range(SecondNearestEnemyOf(Myself),6)
THEN
RESPONSE #100
SetGlobalTimer("cast","LOCALS",6)
ForceSpellRES("RR#TELWE",SecondNearestEnemyOf(Myself))
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
See(ThirdNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearestEnemyOf(Myself))
!CheckStatGT(ThirdNearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",ThirdNearestEnemyOf(Myself))
!HasItemEquiped("wa2amu",ThirdNearestEnemyOf(Myself))
!HasItemEquiped("lich",ThirdNearestEnemyOf(Myself))
StateCheck(ThirdNearestEnemyOf(Myself),STATE_IMMOBILE)
!Range(ThirdNearestEnemyOf(Myself),6)
THEN
RESPONSE #100
SetGlobalTimer("cast","LOCALS",6)
ForceSpellRES("RR#TELWE",ThirdNearestEnemyOf(Myself))
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
See(FourthNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FourthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FourthNearestEnemyOf(Myself))
!CheckStatGT(FourthNearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",FourthNearestEnemyOf(Myself))
!HasItemEquiped("wa2amu",FourthNearestEnemyOf(Myself))
!HasItemEquiped("lich",FourthNearestEnemyOf(Myself))
StateCheck(FourthNearestEnemyOf(Myself),STATE_IMMOBILE)
!Range(FourthNearestEnemyOf(Myself),6)
THEN
RESPONSE #100
SetGlobalTimer("cast","LOCALS",6)
ForceSpellRES("RR#TELWE",FourthNearestEnemyOf(Myself))
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
See(FifthNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FifthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FifthNearestEnemyOf(Myself))
!CheckStatGT(FifthNearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",FifthNearestEnemyOf(Myself))
!HasItemEquiped("wa2amu",FifthNearestEnemyOf(Myself))
!HasItemEquiped("lich",FifthNearestEnemyOf(Myself))
StateCheck(FifthNearestEnemyOf(Myself),STATE_IMMOBILE)
!Range(FifthNearestEnemyOf(Myself),6)
THEN
RESPONSE #100
SetGlobalTimer("cast","LOCALS",6)
ForceSpellRES("RR#TELWE",FifthNearestEnemyOf(Myself))
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
See(SixthNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SixthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SixthNearestEnemyOf(Myself))
!CheckStatGT(SixthNearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",SixthNearestEnemyOf(Myself))
!HasItemEquiped("wa2amu",SixthNearestEnemyOf(Myself))
!HasItemEquiped("lich",SixthNearestEnemyOf(Myself))
StateCheck(SixthNearestEnemyOf(Myself),STATE_IMMOBILE)
!Range(SixthNearestEnemyOf(Myself),6)
THEN
RESPONSE #100
SetGlobalTimer("cast","LOCALS",6)
ForceSpellRES("RR#TELWE",SixthNearestEnemyOf(Myself))
END

IF
!GlobalTimerNotExpired("fl#Taunt","LOCALS")
!StateCheck(Myself,STATE_INVISIBLE)
!See(NearestEnemyOf(Myself))
See([0.HUMANOID.0.INNOCENT])
THEN
RESPONSE #40
SetGlobalTimer("fl#Taunt","LOCALS",12)
DisplayStringHead(Myself,@660)
DisplayStringHead(LastSeenBy(Myself),@665)
ApplySpellRES("RR#FEAR",LastSeenBy(Myself))
RESPONSE #30
SetGlobalTimer("fl#Taunt","LOCALS",12)
DisplayStringHead(Myself,@661)
DisplayStringHead(LastSeenBy(Myself),@666)
ApplySpellRES("RR#FEAR",LastSeenBy(Myself))
RESPONSE #30
SetGlobalTimer("fl#Taunt","LOCALS",12)
DisplayStringHead(LastSeenBy(Myself),@667)
ApplySpellRES("RR#FEAR",LastSeenBy(Myself))
DisplayStringHead(Myself,@662)
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
!Range(ThirdNearestEnemyOf(Myself),10)
See(ThirdNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
!Range(SecondNearestEnemyOf(Myself),10)
See(SecondNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
!Range(NearestEnemyOf(Myself),10)
See(NearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
!Range(LastSeenBy(Myself),10)
See(LastSeenBy(Myself))
THEN
RESPONSE #100
SetGlobal("cast","LOCALS",6)
ForceSpell(LastSeenBy(Myself),CLERIC_ANIMATE_DEAD)
RESPONSE #150
Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
!CheckStatGT(SixthNearestEnemyOf(Myself),0,TRUE_SIGHT)
!StateCheck(Myself,STATE_MIRRORIMAGE)
GlobalLT("flMirrorImage","LOCALS",3)
See(SixthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
!CheckStatGT(FifthNearestEnemyOf(Myself),0,TRUE_SIGHT)
!StateCheck(Myself,STATE_MIRRORIMAGE)
GlobalLT("flMirrorImage","LOCALS",3)
See(FifthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
!CheckStatGT(FourthNearestEnemyOf(Myself),0,TRUE_SIGHT)
!StateCheck(Myself,STATE_MIRRORIMAGE)
GlobalLT("flMirrorImage","LOCALS",3)
See(FourthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,TRUE_SIGHT)
!StateCheck(Myself,STATE_MIRRORIMAGE)
GlobalLT("flMirrorImage","LOCALS",3)
See(ThirdNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
!CheckStatGT(SecondNearestEnemyOf(Myself),0,TRUE_SIGHT)
!StateCheck(Myself,STATE_MIRRORIMAGE)
GlobalLT("flMirrorImage","LOCALS",3)
See(SecondNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
!CheckStatGT(NearestEnemyOf(Myself),0,TRUE_SIGHT)
!StateCheck(Myself,STATE_MIRRORIMAGE)
GlobalLT("flMirrorImage","LOCALS",3)
See(NearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
!CheckStatGT(LastSeenBy(Myself),0,TRUE_SIGHT)
!StateCheck(Myself,STATE_MIRRORIMAGE)
GlobalLT("flMirrorImage","LOCALS",3)
See(LastSeenBy(Myself))
THEN
RESPONSE #100
SetGlobal("cast","LOCALS",6)
ForceSpell(Myself,WIZARD_MIRROR_IMAGE)
IncrementGlobal("flMirrorImage","LOCALS",1)
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
Range(ThirdNearestEnemyOf(Myself),5)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,HELD)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(ThirdNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!General(ThirdNearestEnemyOf(Myself),UNDEAD)
!Race(ThirdNearestEnemyOf(Myself),SLIME)
!Race(ThirdNearestEnemyOf(Myself),GOLEM)
!Race(ThirdNearestEnemyOf(Myself),DEMONIC)
!Race(ThirdNearestEnemyOf(Myself),TROLL)
!Kit(ThirdNearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_RESIST_FEAR)
!CheckStat(ThirdNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("CLCK30",ThirdNearestEnemyOf(Myself))
!HasItemEquipedReal("SW1H32",ThirdNearestEnemyOf(Myself))
!HasItemEquipedReal("MISCBC",ThirdNearestEnemyOf(Myself))
!HasItemEquiped("RR#HELMD",ThirdNearestEnemyOf(Myself))
!CheckStatGT(ThirdNearestEnemyOf(Myself),75,RESISTMAGIC)
!CheckStat(ThirdNearestEnemyOf(Myself),5,WIZARD_SPELL_IMMUNITY)
See(ThirdNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
Range(SecondNearestEnemyOf(Myself),5)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,HELD)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SecondNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!General(SecondNearestEnemyOf(Myself),UNDEAD)
!Race(SecondNearestEnemyOf(Myself),SLIME)
!Race(SecondNearestEnemyOf(Myself),GOLEM)
!Race(SecondNearestEnemyOf(Myself),DEMONIC)
!Race(SecondNearestEnemyOf(Myself),TROLL)
!Kit(SecondNearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_RESIST_FEAR)
!CheckStat(SecondNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("CLCK30",SecondNearestEnemyOf(Myself))
!HasItemEquipedReal("SW1H32",SecondNearestEnemyOf(Myself))
!HasItemEquipedReal("MISCBC",SecondNearestEnemyOf(Myself))
!HasItemEquiped("RR#HELMD",SecondNearestEnemyOf(Myself))
!CheckStatGT(SecondNearestEnemyOf(Myself),75,RESISTMAGIC)
!CheckStat(SecondNearestEnemyOf(Myself),5,WIZARD_SPELL_IMMUNITY)
See(SecondNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
Range(NearestEnemyOf(Myself),5)
!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(NearestEnemyOf(Myself),0,HELD)
!StateCheck(NearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(NearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(NearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!General(NearestEnemyOf(Myself),UNDEAD)
!Race(NearestEnemyOf(Myself),SLIME)
!Race(NearestEnemyOf(Myself),GOLEM)
!Race(NearestEnemyOf(Myself),DEMONIC)
!Race(NearestEnemyOf(Myself),TROLL)
!Kit(NearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_RESIST_FEAR)
!CheckStat(NearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("CLCK30",NearestEnemyOf(Myself))
!HasItemEquipedReal("SW1H32",NearestEnemyOf(Myself))
!HasItemEquipedReal("MISCBC",NearestEnemyOf(Myself))
!HasItemEquiped("RR#HELMD",NearestEnemyOf(Myself))
!CheckStatGT(NearestEnemyOf(Myself),75,RESISTMAGIC)
!CheckStat(NearestEnemyOf(Myself),5,WIZARD_SPELL_IMMUNITY)
See(NearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
Range(LastSeenBy(Myself),5)
!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
!CheckStatGT(LastSeenBy(Myself),0,HELD)
!StateCheck(LastSeenBy(Myself),STATE_STONE_DEATH)
!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!General(LastSeenBy(Myself),UNDEAD)
!Race(LastSeenBy(Myself),SLIME)
!Race(LastSeenBy(Myself),GOLEM)
!Race(LastSeenBy(Myself),DEMONIC)
!Race(LastSeenBy(Myself),TROLL)
!Kit(LastSeenBy(Myself),CAVALIER)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_RESIST_FEAR)
!CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("CLCK30",LastSeenBy(Myself))
!HasItemEquipedReal("SW1H32",LastSeenBy(Myself))
!HasItemEquipedReal("MISCBC",LastSeenBy(Myself))
!HasItemEquiped("RR#HELMD",LastSeenBy(Myself))
!CheckStatGT(LastSeenBy(Myself),75,RESISTMAGIC)
!CheckStat(LastSeenBy(Myself),5,WIZARD_SPELL_IMMUNITY)
See(LastSeenBy(Myself))
THEN
RESPONSE #30
SetGlobalTimer("cast","LOCALS",6)
ForceSpellRES("RR#DCFEA",LastSeenBy(Myself))
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
Range(ThirdNearestEnemyOf(Myself),5)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,HELD)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(ThirdNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!General(ThirdNearestEnemyOf(Myself),UNDEAD)
!Race(ThirdNearestEnemyOf(Myself),DEMONIC)
!Race(ThirdNearestEnemyOf(Myself),GOLEM)
!Race(ThirdNearestEnemyOf(Myself),ELEMENTAL)
!Race(ThirdNearestEnemyOf(Myself),SLIME)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISEASED)
!HasItemEquiped("ring39",ThirdNearestEnemyOf(Myself))
!HasItemEquiped("misc8j",ThirdNearestEnemyOf(Myself))
!CheckStatGT(ThirdNearestEnemyOf(Myself),75,RESISTMAGIC)
See(ThirdNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
Range(SecondNearestEnemyOf(Myself),5)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,HELD)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SecondNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!General(SecondNearestEnemyOf(Myself),UNDEAD)
!Race(SecondNearestEnemyOf(Myself),DEMONIC)
!Race(SecondNearestEnemyOf(Myself),GOLEM)
!Race(SecondNearestEnemyOf(Myself),ELEMENTAL)
!Race(SecondNearestEnemyOf(Myself),SLIME)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISEASED)
!HasItemEquiped("ring39",SecondNearestEnemyOf(Myself))
!HasItemEquiped("misc8j",SecondNearestEnemyOf(Myself))
!CheckStatGT(SecondNearestEnemyOf(Myself),75,RESISTMAGIC)
See(SecondNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
Range(NearestEnemyOf(Myself),5)
!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(NearestEnemyOf(Myself),0,HELD)
!StateCheck(NearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(NearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(NearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!General(NearestEnemyOf(Myself),UNDEAD)
!Race(NearestEnemyOf(Myself),DEMONIC)
!Race(NearestEnemyOf(Myself),GOLEM)
!Race(NearestEnemyOf(Myself),ELEMENTAL)
!Race(NearestEnemyOf(Myself),SLIME)
!StateCheck(NearestEnemyOf(Myself),STATE_DISEASED)
!HasItemEquiped("ring39",NearestEnemyOf(Myself))
!HasItemEquiped("misc8j",NearestEnemyOf(Myself))
!CheckStatGT(NearestEnemyOf(Myself),75,RESISTMAGIC)
See(NearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
Range(LastSeenBy(Myself),5)
!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
!CheckStatGT(LastSeenBy(Myself),0,HELD)
!StateCheck(LastSeenBy(Myself),STATE_STONE_DEATH)
!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!General(LastSeenBy(Myself),UNDEAD)
!Race(LastSeenBy(Myself),DEMONIC)
!Race(LastSeenBy(Myself),GOLEM)
!Race(LastSeenBy(Myself),ELEMENTAL)
!Race(LastSeenBy(Myself),SLIME)
!StateCheck(LastSeenBy(Myself),STATE_DISEASED)
!HasItemEquiped("ring39",LastSeenBy(Myself))
!HasItemEquiped("misc8j",LastSeenBy(Myself))
!CheckStatGT(LastSeenBy(Myself),75,RESISTMAGIC)
See(LastSeenBy(Myself))
THEN
RESPONSE #30
SetGlobalTimer("cast","LOCALS",6)
ForceSpellRES("fl#csdis",LastSeenBy(Myself))
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
General(SixthNearestEnemyOf(Myself),HUMANOID)
!Race(SixthNearestEnemyOf(Myself),RAKSHASA)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,HELD)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SixthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!General(SixthNearestEnemyOf(Myself),UNDEAD)
!Race(SixthNearestEnemyOf(Myself),ELF)
!Race(SixthNearestEnemyOf(Myself),GOLEM)
!Race(SixthNearestEnemyOf(Myself),SLIME)
!Race(SixthNearestEnemyOf(Myself),DEMONIC)
!Race(SixthNearestEnemyOf(Myself),TROLL)
!Class(SixthNearestEnemyOf(Myself),MONK)
!Kit(SixthNearestEnemyOf(Myself),INQUISITOR)
!Kit(SixthNearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(SixthNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("helm06",SixthNearestEnemyOf(Myself))
!HasItemEquiped("ipsion",SixthNearestEnemyOf(Myself))
!HasItemEquipedReal("miscbc",SixthNearestEnemyOf(Myself))
!HasItemEquiped("npchan",SixthNearestEnemyOf(Myself))
!HasItemEquiped("shld25",SixthNearestEnemyOf(Myself))
!HasItemEquipedReal("sper07",SixthNearestEnemyOf(Myself))
!HasItemEquipedReal("staf11",SixthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h35",SixthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h54",SixthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw2h14",SixthNearestEnemyOf(Myself))
!CheckStat(SixthNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(SixthNearestEnemyOf(Myself),50,RESISTMAGIC)
See(SixthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
General(FifthNearestEnemyOf(Myself),HUMANOID)
!Race(FifthNearestEnemyOf(Myself),RAKSHASA)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(FifthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!General(FifthNearestEnemyOf(Myself),UNDEAD)
!Race(FifthNearestEnemyOf(Myself),ELF)
!Race(FifthNearestEnemyOf(Myself),GOLEM)
!Race(FifthNearestEnemyOf(Myself),SLIME)
!Race(FifthNearestEnemyOf(Myself),DEMONIC)
!Race(FifthNearestEnemyOf(Myself),TROLL)
!Class(FifthNearestEnemyOf(Myself),MONK)
!Kit(FifthNearestEnemyOf(Myself),INQUISITOR)
!Kit(FifthNearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(FifthNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("helm06",FifthNearestEnemyOf(Myself))
!HasItemEquiped("ipsion",FifthNearestEnemyOf(Myself))
!HasItemEquipedReal("miscbc",FifthNearestEnemyOf(Myself))
!HasItemEquiped("npchan",FifthNearestEnemyOf(Myself))
!HasItemEquiped("shld25",FifthNearestEnemyOf(Myself))
!HasItemEquipedReal("sper07",FifthNearestEnemyOf(Myself))
!HasItemEquipedReal("staf11",FifthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h35",FifthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h54",FifthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw2h14",FifthNearestEnemyOf(Myself))
!CheckStat(FifthNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(FifthNearestEnemyOf(Myself),50,RESISTMAGIC)
See(FifthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
General(FourthNearestEnemyOf(Myself),HUMANOID)
!Race(FourthNearestEnemyOf(Myself),RAKSHASA)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,HELD)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(FourthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!General(FourthNearestEnemyOf(Myself),UNDEAD)
!Race(FourthNearestEnemyOf(Myself),ELF)
!Race(FourthNearestEnemyOf(Myself),GOLEM)
!Race(FourthNearestEnemyOf(Myself),SLIME)
!Race(FourthNearestEnemyOf(Myself),DEMONIC)
!Race(FourthNearestEnemyOf(Myself),TROLL)
!Class(FourthNearestEnemyOf(Myself),MONK)
!Kit(FourthNearestEnemyOf(Myself),INQUISITOR)
!Kit(FourthNearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(FourthNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("helm06",FourthNearestEnemyOf(Myself))
!HasItemEquiped("ipsion",FourthNearestEnemyOf(Myself))
!HasItemEquipedReal("miscbc",FourthNearestEnemyOf(Myself))
!HasItemEquiped("npchan",FourthNearestEnemyOf(Myself))
!HasItemEquiped("shld25",FourthNearestEnemyOf(Myself))
!HasItemEquipedReal("sper07",FourthNearestEnemyOf(Myself))
!HasItemEquipedReal("staf11",FourthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h35",FourthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h54",FourthNearestEnemyOf(Myself))
!HasItemEquipedReal("sw2h14",FourthNearestEnemyOf(Myself))
!CheckStat(FourthNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(FourthNearestEnemyOf(Myself),50,RESISTMAGIC)
See(FourthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
General(ThirdNearestEnemyOf(Myself),HUMANOID)
!Race(ThirdNearestEnemyOf(Myself),RAKSHASA)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,HELD)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(ThirdNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!General(ThirdNearestEnemyOf(Myself),UNDEAD)
!Race(ThirdNearestEnemyOf(Myself),ELF)
!Race(ThirdNearestEnemyOf(Myself),GOLEM)
!Race(ThirdNearestEnemyOf(Myself),SLIME)
!Race(ThirdNearestEnemyOf(Myself),DEMONIC)
!Race(ThirdNearestEnemyOf(Myself),TROLL)
!Class(ThirdNearestEnemyOf(Myself),MONK)
!Kit(ThirdNearestEnemyOf(Myself),INQUISITOR)
!Kit(ThirdNearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(ThirdNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("helm06",ThirdNearestEnemyOf(Myself))
!HasItemEquiped("ipsion",ThirdNearestEnemyOf(Myself))
!HasItemEquipedReal("miscbc",ThirdNearestEnemyOf(Myself))
!HasItemEquiped("npchan",ThirdNearestEnemyOf(Myself))
!HasItemEquiped("shld25",ThirdNearestEnemyOf(Myself))
!HasItemEquipedReal("sper07",ThirdNearestEnemyOf(Myself))
!HasItemEquipedReal("staf11",ThirdNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h35",ThirdNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h54",ThirdNearestEnemyOf(Myself))
!HasItemEquipedReal("sw2h14",ThirdNearestEnemyOf(Myself))
!CheckStat(ThirdNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(ThirdNearestEnemyOf(Myself),50,RESISTMAGIC)
See(ThirdNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
General(SecondNearestEnemyOf(Myself),HUMANOID)
!Race(SecondNearestEnemyOf(Myself),RAKSHASA)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,HELD)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SecondNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!General(SecondNearestEnemyOf(Myself),UNDEAD)
!Race(SecondNearestEnemyOf(Myself),ELF)
!Race(SecondNearestEnemyOf(Myself),GOLEM)
!Race(SecondNearestEnemyOf(Myself),SLIME)
!Race(SecondNearestEnemyOf(Myself),DEMONIC)
!Race(SecondNearestEnemyOf(Myself),TROLL)
!Class(SecondNearestEnemyOf(Myself),MONK)
!Kit(SecondNearestEnemyOf(Myself),INQUISITOR)
!Kit(SecondNearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(SecondNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("helm06",SecondNearestEnemyOf(Myself))
!HasItemEquiped("ipsion",SecondNearestEnemyOf(Myself))
!HasItemEquipedReal("miscbc",SecondNearestEnemyOf(Myself))
!HasItemEquiped("npchan",SecondNearestEnemyOf(Myself))
!HasItemEquiped("shld25",SecondNearestEnemyOf(Myself))
!HasItemEquipedReal("sper07",SecondNearestEnemyOf(Myself))
!HasItemEquipedReal("staf11",SecondNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h35",SecondNearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h54",SecondNearestEnemyOf(Myself))
!HasItemEquipedReal("sw2h14",SecondNearestEnemyOf(Myself))
!CheckStat(SecondNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(SecondNearestEnemyOf(Myself),50,RESISTMAGIC)
See(SecondNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
General(NearestEnemyOf(Myself),HUMANOID)
!Race(NearestEnemyOf(Myself),RAKSHASA)
!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(NearestEnemyOf(Myself),0,HELD)
!StateCheck(NearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(NearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(NearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!General(NearestEnemyOf(Myself),UNDEAD)
!Race(NearestEnemyOf(Myself),ELF)
!Race(NearestEnemyOf(Myself),GOLEM)
!Race(NearestEnemyOf(Myself),SLIME)
!Race(NearestEnemyOf(Myself),DEMONIC)
!Race(NearestEnemyOf(Myself),TROLL)
!Class(NearestEnemyOf(Myself),MONK)
!Kit(NearestEnemyOf(Myself),INQUISITOR)
!Kit(NearestEnemyOf(Myself),CAVALIER)
!CheckStatGT(NearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(NearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("helm06",NearestEnemyOf(Myself))
!HasItemEquiped("ipsion",NearestEnemyOf(Myself))
!HasItemEquipedReal("miscbc",NearestEnemyOf(Myself))
!HasItemEquiped("npchan",NearestEnemyOf(Myself))
!HasItemEquiped("shld25",NearestEnemyOf(Myself))
!HasItemEquipedReal("sper07",NearestEnemyOf(Myself))
!HasItemEquipedReal("staf11",NearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h35",NearestEnemyOf(Myself))
!HasItemEquipedReal("sw1h54",NearestEnemyOf(Myself))
!HasItemEquipedReal("sw2h14",NearestEnemyOf(Myself))
!CheckStat(NearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(NearestEnemyOf(Myself),50,RESISTMAGIC)
See(NearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
General(LastSeenBy(Myself),HUMANOID)
!Race(LastSeenBy(Myself),RAKSHASA)
!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
!CheckStatGT(LastSeenBy(Myself),0,HELD)
!StateCheck(LastSeenBy(Myself),STATE_STONE_DEATH)
!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!General(LastSeenBy(Myself),UNDEAD)
!Race(LastSeenBy(Myself),ELF)
!Race(LastSeenBy(Myself),GOLEM)
!Race(LastSeenBy(Myself),SLIME)
!Race(LastSeenBy(Myself),DEMONIC)
!Race(LastSeenBy(Myself),TROLL)
!Class(LastSeenBy(Myself),MONK)
!Kit(LastSeenBy(Myself),INQUISITOR)
!Kit(LastSeenBy(Myself),CAVALIER)
!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("helm06",LastSeenBy(Myself))
!HasItemEquiped("ipsion",LastSeenBy(Myself))
!HasItemEquipedReal("miscbc",LastSeenBy(Myself))
!HasItemEquiped("npchan",LastSeenBy(Myself))
!HasItemEquiped("shld25",LastSeenBy(Myself))
!HasItemEquipedReal("sper07",LastSeenBy(Myself))
!HasItemEquipedReal("staf11",LastSeenBy(Myself))
!HasItemEquipedReal("sw1h35",LastSeenBy(Myself))
!HasItemEquipedReal("sw1h54",LastSeenBy(Myself))
!HasItemEquipedReal("sw2h14",LastSeenBy(Myself))
!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(LastSeenBy(Myself),50,RESISTMAGIC)
See(LastSeenBy(Myself))
THEN
RESPONSE #50
SetGlobal("cast","LOCALS",6)
ForceSpell(LastSeenBy(Myself),WIZARD_CHARM)
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
HPLT(SixthNearestEnemyOf(Myself),15)
!Race(SixthNearestEnemyOf(Myself),LICH)
!Race(SixthNearestEnemyOf(Myself),RAKSHASA)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SixthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(SixthNearestEnemyOf(Myself),99,RESISTFIRE)
!CheckStatGT(SixthNearestEnemyOf(Myself),75,RESISTMAGIC)
!CheckStat(SixthNearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
!HasItemEquiped("clck26",SixthNearestEnemyOf(Myself))
See(SixthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
HPLT(FifthNearestEnemyOf(Myself),15)
!Race(FifthNearestEnemyOf(Myself),LICH)
!Race(FifthNearestEnemyOf(Myself),RAKSHASA)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(FifthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(FifthNearestEnemyOf(Myself),99,RESISTFIRE)
!CheckStatGT(FifthNearestEnemyOf(Myself),75,RESISTMAGIC)
!CheckStat(FifthNearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
!HasItemEquiped("clck26",FifthNearestEnemyOf(Myself))
See(FifthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
HPLT(FourthNearestEnemyOf(Myself),15)
!Race(FourthNearestEnemyOf(Myself),LICH)
!Race(FourthNearestEnemyOf(Myself),RAKSHASA)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(FourthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(FourthNearestEnemyOf(Myself),99,RESISTFIRE)
!CheckStatGT(FourthNearestEnemyOf(Myself),75,RESISTMAGIC)
!CheckStat(FourthNearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
!HasItemEquiped("clck26",FourthNearestEnemyOf(Myself))
See(FourthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
HPLT(ThirdNearestEnemyOf(Myself),15)
!Race(ThirdNearestEnemyOf(Myself),LICH)
!Race(ThirdNearestEnemyOf(Myself),RAKSHASA)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(ThirdNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(ThirdNearestEnemyOf(Myself),99,RESISTFIRE)
!CheckStatGT(ThirdNearestEnemyOf(Myself),75,RESISTMAGIC)
!CheckStat(ThirdNearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
!HasItemEquiped("clck26",ThirdNearestEnemyOf(Myself))
See(ThirdNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
HPLT(SecondNearestEnemyOf(Myself),15)
!Race(SecondNearestEnemyOf(Myself),LICH)
!Race(SecondNearestEnemyOf(Myself),RAKSHASA)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SecondNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(SecondNearestEnemyOf(Myself),99,RESISTFIRE)
!CheckStatGT(SecondNearestEnemyOf(Myself),75,RESISTMAGIC)
!CheckStat(SecondNearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
!HasItemEquiped("clck26",SecondNearestEnemyOf(Myself))
See(SecondNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
HPLT(NearestEnemyOf(Myself),15)
!Race(NearestEnemyOf(Myself),LICH)
!Race(NearestEnemyOf(Myself),RAKSHASA)
!CheckStatGT(NearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(NearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(NearestEnemyOf(Myself),99,RESISTFIRE)
!CheckStatGT(NearestEnemyOf(Myself),75,RESISTMAGIC)
!CheckStat(NearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
!HasItemEquiped("clck26",NearestEnemyOf(Myself))
See(NearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
HPLT(LastSeenBy(Myself),15)
!Race(LastSeenBy(Myself),LICH)
!Race(LastSeenBy(Myself),RAKSHASA)
!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(LastSeenBy(Myself),99,RESISTFIRE)
!CheckStatGT(LastSeenBy(Myself),75,RESISTMAGIC)
!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
!HasItemEquiped("clck26",LastSeenBy(Myself))
See(LastSeenBy(Myself))
THEN
RESPONSE #100
SetGlobalTimer("cast","LOCALS",6)
ForceSpellRES("RR#PFLAM",LastSeenBy(Myself))
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
Range(ThirdNearestEnemyOf(Myself),10)
LevelLT(ThirdNearestEnemyOf(Myself),6)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,HELD)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(ThirdNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStat(ThirdNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!General(ThirdNearestEnemyOf(Myself),UNDEAD)
!Race(ThirdNearestEnemyOf(Myself),ELF)
!Race(ThirdNearestEnemyOf(Myself),GOLEM)
!Race(ThirdNearestEnemyOf(Myself),SLIME)
!Race(ThirdNearestEnemyOf(Myself),TROLL)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(ThirdNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("ipsion",ThirdNearestEnemyOf(Myself))
!CheckStatGT(ThirdNearestEnemyOf(Myself),50,RESISTMAGIC)
GlobalLT("flCommand","LOCALS",3)
See(ThirdNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
Range(SecondNearestEnemyOf(Myself),10)
LevelLT(SecondNearestEnemyOf(Myself),6)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,HELD)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SecondNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStat(SecondNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!General(SecondNearestEnemyOf(Myself),UNDEAD)
!Race(SecondNearestEnemyOf(Myself),ELF)
!Race(SecondNearestEnemyOf(Myself),GOLEM)
!Race(SecondNearestEnemyOf(Myself),SLIME)
!Race(SecondNearestEnemyOf(Myself),TROLL)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(SecondNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("ipsion",SecondNearestEnemyOf(Myself))
!CheckStatGT(SecondNearestEnemyOf(Myself),50,RESISTMAGIC)
GlobalLT("flCommand","LOCALS",3)
See(SecondNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
Range(NearestEnemyOf(Myself),10)
LevelLT(NearestEnemyOf(Myself),6)
!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(NearestEnemyOf(Myself),0,HELD)
!StateCheck(NearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(NearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(NearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStat(NearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!General(NearestEnemyOf(Myself),UNDEAD)
!Race(NearestEnemyOf(Myself),ELF)
!Race(NearestEnemyOf(Myself),GOLEM)
!Race(NearestEnemyOf(Myself),SLIME)
!Race(NearestEnemyOf(Myself),TROLL)
!CheckStatGT(NearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(NearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("ipsion",NearestEnemyOf(Myself))
!CheckStatGT(NearestEnemyOf(Myself),50,RESISTMAGIC)
GlobalLT("flCommand","LOCALS",3)
See(NearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
Range(LastSeenBy(Myself),10)
LevelLT(LastSeenBy(Myself),6)
!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
!CheckStatGT(LastSeenBy(Myself),0,HELD)
!StateCheck(LastSeenBy(Myself),STATE_STONE_DEATH)
!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
!General(LastSeenBy(Myself),UNDEAD)
!Race(LastSeenBy(Myself),ELF)
!Race(LastSeenBy(Myself),GOLEM)
!Race(LastSeenBy(Myself),SLIME)
!Race(LastSeenBy(Myself),TROLL)
!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("ipsion",LastSeenBy(Myself))
!CheckStatGT(LastSeenBy(Myself),50,RESISTMAGIC)
GlobalLT("flCommand","LOCALS",3)
See(LastSeenBy(Myself))
THEN
RESPONSE #100
SetGlobal("cast","LOCALS",6)
ForceSpell(LastSeenBy(Myself),CLERIC_COMMAND)
IncrementGlobal("flCommand","LOCALS",1)
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
Range(ThirdNearestEnemyOf(Myself),10)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,HELD)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(ThirdNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStat(ThirdNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!General(ThirdNearestEnemyOf(Myself),UNDEAD)
!Race(ThirdNearestEnemyOf(Myself),ELF)
!Race(ThirdNearestEnemyOf(Myself),GOLEM)
!Race(ThirdNearestEnemyOf(Myself),SLIME)
!Race(ThirdNearestEnemyOf(Myself),TROLL)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(ThirdNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("ipsion",ThirdNearestEnemyOf(Myself))
!CheckStatGT(ThirdNearestEnemyOf(Myself),50,RESISTMAGIC)
GlobalLT("flCommand","LOCALS",3)
See(ThirdNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
Range(SecondNearestEnemyOf(Myself),10)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,HELD)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SecondNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStat(SecondNearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!General(SecondNearestEnemyOf(Myself),UNDEAD)
!Race(SecondNearestEnemyOf(Myself),ELF)
!Race(SecondNearestEnemyOf(Myself),GOLEM)
!Race(SecondNearestEnemyOf(Myself),SLIME)
!Race(SecondNearestEnemyOf(Myself),TROLL)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(SecondNearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("ipsion",SecondNearestEnemyOf(Myself))
!CheckStatGT(SecondNearestEnemyOf(Myself),50,RESISTMAGIC)
GlobalLT("flCommand","LOCALS",3)
See(SecondNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
Range(NearestEnemyOf(Myself),10)
!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
!CheckStatGT(NearestEnemyOf(Myself),0,HELD)
!StateCheck(NearestEnemyOf(Myself),STATE_STONE_DEATH)
!CheckStatGT(NearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(NearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStat(NearestEnemyOf(Myself),4,WIZARD_SPELL_IMMUNITY)
!General(NearestEnemyOf(Myself),UNDEAD)
!Race(NearestEnemyOf(Myself),ELF)
!Race(NearestEnemyOf(Myself),GOLEM)
!Race(NearestEnemyOf(Myself),SLIME)
!Race(NearestEnemyOf(Myself),TROLL)
!CheckStatGT(NearestEnemyOf(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(NearestEnemyOf(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("ipsion",NearestEnemyOf(Myself))
!CheckStatGT(NearestEnemyOf(Myself),50,RESISTMAGIC)
GlobalLT("flCommand","LOCALS",3)
See(NearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
Range(LastSeenBy(Myself),10)
!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
!CheckStatGT(LastSeenBy(Myself),0,HELD)
!StateCheck(LastSeenBy(Myself),STATE_STONE_DEATH)
!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
!General(LastSeenBy(Myself),UNDEAD)
!Race(LastSeenBy(Myself),ELF)
!Race(LastSeenBy(Myself),GOLEM)
!Race(LastSeenBy(Myself),SLIME)
!Race(LastSeenBy(Myself),TROLL)
!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
!CheckStat(LastSeenBy(Myself),1,SCRIPTINGSTATE4)
!HasItemEquiped("ipsion",LastSeenBy(Myself))
!CheckStatGT(LastSeenBy(Myself),50,RESISTMAGIC)
GlobalLT("flCommand","LOCALS",3)
See(LastSeenBy(Myself))
THEN
RESPONSE #100
SetGlobal("cast","LOCALS",6)
ForceSpell(LastSeenBy(Myself),CLERIC_COMMAND)
IncrementGlobal("flCommand","LOCALS",1)
RESPONSE #200
Continue()
END

IF
See(LastSummonerOf(Myself))
Global("fl#Summoner","LOCALS",0)
Exists(LastSummonerOf(Myself))
!CheckStatGT(LastSummonerOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",LastSummonerOf(Myself))
!HasItemEquiped("wa2amu",LastSummonerOf(Myself))
!HasItemEquiped("lich",LastSummonerOf(Myself))
!StateCheck(LastSummonerOf(Myself),STATE_REALLY_DEAD)
!StateCheck(Myself,STATE_INVISIBLE)
THEN
RESPONSE #100
SetInterrupt(FALSE)
SetGlobal("fl#Summoner","LOCALS",0)
FaceObject(LastSummonerOf(Myself))
DisplayStringHead(Myself,@681)
SetInterrupt(TRUE)
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
See(NearestEnemyOf(Myself))
!Race(NearestEnemyOf(Myself),LICH)
!Race(NearestEnemyOf(Myself),RAKSHASA)
!CheckStatGT(NearestEnemyOf(Myself),99,RESISTMAGIC)
!CheckStatGT(NearestEnemyOf(Myself),99,RESISTFIRE)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(NearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(NearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(NearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(NearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(NearestEnemyOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",NearestEnemyOf(Myself))
!HasItemEquiped("wa2amu",NearestEnemyOf(Myself))
!HasItemEquiped("lich",NearestEnemyOf(Myself))
Range(NearestEnemyOf(Myself),5)
THEN
RESPONSE #100
SetGlobalTimer("cast","LOCALS",6)
ForceSpellRES("RR#PFLAM",NearestEnemyOf(Myself))
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
See(SecondNearestEnemyOf(Myself))
!Race(SecondNearestEnemyOf(Myself),LICH)
!Race(SecondNearestEnemyOf(Myself),RAKSHASA)
!CheckStatGT(SecondNearestEnemyOf(Myself),99,RESISTMAGIC)
!CheckStatGT(SecondNearestEnemyOf(Myself),99,RESISTFIRE)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SecondNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(SecondNearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",SecondNearestEnemyOf(Myself))
!HasItemEquiped("wa2amu",SecondNearestEnemyOf(Myself))
!HasItemEquiped("lich",SecondNearestEnemyOf(Myself))
Range(NearestEnemyOf(Myself),5)
THEN
RESPONSE #100
SetGlobalTimer("cast","LOCALS",6)
ForceSpellRES("RR#PFLAM",SecondNearestEnemyOf(Myself))
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
See(ThirdNearestEnemyOf(Myself))
!Race(ThirdNearestEnemyOf(Myself),LICH)
!Race(ThirdNearestEnemyOf(Myself),RAKSHASA)
!CheckStatGT(ThirdNearestEnemyOf(Myself),99,RESISTMAGIC)
!CheckStatGT(ThirdNearestEnemyOf(Myself),99,RESISTFIRE)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(ThirdNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(ThirdNearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",ThirdNearestEnemyOf(Myself))
!HasItemEquiped("wa2amu",ThirdNearestEnemyOf(Myself))
!HasItemEquiped("lich",ThirdNearestEnemyOf(Myself))
Range(NearestEnemyOf(Myself),5)
THEN
RESPONSE #100
SetGlobalTimer("cast","LOCALS",6)
ForceSpellRES("RR#PFLAM",ThirdNearestEnemyOf(Myself))
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
See(FourthNearestEnemyOf(Myself))
!Race(FourthNearestEnemyOf(Myself),LICH)
!Race(FourthNearestEnemyOf(Myself),RAKSHASA)
!CheckStatGT(FourthNearestEnemyOf(Myself),99,RESISTMAGIC)
!CheckStatGT(FourthNearestEnemyOf(Myself),99,RESISTFIRE)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(FourthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(FourthNearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",FourthNearestEnemyOf(Myself))
!HasItemEquiped("wa2amu",FourthNearestEnemyOf(Myself))
!HasItemEquiped("lich",FourthNearestEnemyOf(Myself))
Range(NearestEnemyOf(Myself),5)
THEN
RESPONSE #100
SetGlobalTimer("cast","LOCALS",6)
ForceSpellRES("RR#PFLAM",FourthNearestEnemyOf(Myself))
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
See(FifthNearestEnemyOf(Myself))
!Race(FifthNearestEnemyOf(Myself),LICH)
!Race(FifthNearestEnemyOf(Myself),RAKSHASA)
!CheckStatGT(FifthNearestEnemyOf(Myself),99,RESISTMAGIC)
!CheckStatGT(FifthNearestEnemyOf(Myself),99,RESISTFIRE)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(FifthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(FifthNearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",FifthNearestEnemyOf(Myself))
!HasItemEquiped("wa2amu",FifthNearestEnemyOf(Myself))
!HasItemEquiped("lich",FifthNearestEnemyOf(Myself))
Range(NearestEnemyOf(Myself),5)
THEN
RESPONSE #100
SetGlobalTimer("cast","LOCALS",6)
ForceSpellRES("RR#PFLAM",FifthNearestEnemyOf(Myself))
RESPONSE #100
Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
See(SixthNearestEnemyOf(Myself))
!Race(SixthNearestEnemyOf(Myself),LICH)
!Race(SixthNearestEnemyOf(Myself),RAKSHASA)
!CheckStatGT(SixthNearestEnemyOf(Myself),99,RESISTMAGIC)
!CheckStatGT(SixthNearestEnemyOf(Myself),99,RESISTFIRE)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_DEFLECTION)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_TURNING)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,WIZARD_SPELL_TRAP)
!CheckStat(SixthNearestEnemyOf(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,MINORGLOBE)
!CheckStat(SixthNearestEnemyOf(Myself),6,WIZARD_SPELL_IMMUNITY)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",SixthNearestEnemyOf(Myself))
!HasItemEquiped("wa2amu",SixthNearestEnemyOf(Myself))
!HasItemEquiped("lich",SixthNearestEnemyOf(Myself))
Range(NearestEnemyOf(Myself),5)
THEN
RESPONSE #100
SetGlobalTimer("cast","LOCALS",6)
ForceSpellRES("RR#PFLAM",SixthNearestEnemyOf(Myself))
RESPONSE #100
Continue()
END

IF
See([0.0.MAGE])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([0.0.MAGE],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([0.0.MAGE],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([0.0.MAGE],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([0.0.MAGE],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([0.0.MAGE],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[0.0.MAGE])
!CheckStatGT([0.0.MAGE],99,RESISTSLASHING)
!CheckStatGT([0.0.MAGE],0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",[0.0.MAGE])
!HasItemEquiped("wa2amu",[0.0.MAGE])
!CheckStatGT([0.0.MAGE],0,STONESKINS)
!StateCheck([0.0.MAGE],STATE_MIRRORIMAGE)
!HasItemEquiped("lich",[0.0.MAGE])
Range([0.0.MAGE],5)
THEN
RESPONSE #100
AttackOneRound([0.0.MAGE])
END

IF
See(SecondNearest([0.0.MAGE]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearest([0.0.MAGE]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearest([0.0.MAGE]))
!CheckStatGT(SecondNearest([0.0.MAGE]),99,RESISTSLASHING)
!CheckStatGT(SecondNearest([0.0.MAGE]),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",SecondNearest([0.0.MAGE]))
!HasItemEquiped("wa2amu",SecondNearest([0.0.MAGE]))
!CheckStatGT(SecondNearest([0.0.MAGE]),0,STONESKINS)
!StateCheck(SecondNearest([0.0.MAGE]),STATE_MIRRORIMAGE)
!HasItemEquiped("lich",SecondNearest([0.0.MAGE]))
Range(SecondNearest([0.0.MAGE]),5)
THEN
RESPONSE #100
AttackOneRound(SecondNearest([0.0.MAGE]))
END

IF
See([0.0.MAGE_THIEF])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([0.0.MAGE_THIEF],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([0.0.MAGE_THIEF],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([0.0.MAGE_THIEF],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([0.0.MAGE_THIEF],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([0.0.MAGE_THIEF],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[0.0.MAGE_THIEF])
!CheckStatGT([0.0.MAGE_THIEF],99,RESISTSLASHING)
!CheckStatGT([0.0.MAGE_THIEF],0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",[0.0.MAGE_THIEF])
!HasItemEquiped("wa2amu",[0.0.MAGE_THIEF])
!CheckStatGT([0.0.MAGE_THIEF],0,STONESKINS)
!StateCheck([0.0.MAGE_THIEF],STATE_MIRRORIMAGE)
!HasItemEquiped("lich",[0.0.MAGE_THIEF])
Range([0.0.MAGE_THIEF],5)
THEN
RESPONSE #100
AttackOneRound([0.0.MAGE_THIEF])
END

IF
See(SecondNearest([0.0.MAGE_THIEF]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearest([0.0.MAGE_THIEF]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE_THIEF]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE_THIEF]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE_THIEF]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE_THIEF]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearest([0.0.MAGE_THIEF]))
!CheckStatGT(SecondNearest([0.0.MAGE_THIEF]),99,RESISTSLASHING)
!CheckStatGT(SecondNearest([0.0.MAGE_THIEF]),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",SecondNearest([0.0.MAGE_THIEF]))
!HasItemEquiped("wa2amu",SecondNearest([0.0.MAGE_THIEF]))
!CheckStatGT(SecondNearest([0.0.MAGE_THIEF]),0,STONESKINS)
!StateCheck(SecondNearest([0.0.MAGE_THIEF]),STATE_MIRRORIMAGE)
!HasItemEquiped("lich",SecondNearest([0.0.MAGE_THIEF]))
Range(SecondNearest([0.0.MAGE_THIEF]),5)
THEN
RESPONSE #100
AttackOneRound(SecondNearest([0.0.MAGE_THIEF]))
END

IF
See([0.0.MAGE_ALL])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([0.0.MAGE_ALL],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([0.0.MAGE_ALL],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([0.0.MAGE_ALL],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([0.0.MAGE_ALL],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([0.0.MAGE_ALL],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[0.0.MAGE_ALL])
!CheckStatGT([0.0.MAGE_ALL],99,RESISTSLASHING)
!CheckStatGT([0.0.MAGE_ALL],0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",[0.0.MAGE_ALL])
!HasItemEquiped("wa2amu",[0.0.MAGE_ALL])
!CheckStatGT([0.0.MAGE_ALL],0,STONESKINS)
!StateCheck([0.0.MAGE_ALL],STATE_MIRRORIMAGE)
!HasItemEquiped("lich",[0.0.MAGE_ALL])
Range([0.0.MAGE_ALL],5)
THEN
RESPONSE #100
AttackOneRound([0.0.MAGE_ALL])
END

IF
See(SecondNearest([0.0.MAGE_ALL]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearest([0.0.MAGE_ALL]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE_ALL]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE_ALL]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE_ALL]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE_ALL]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearest([0.0.MAGE_ALL]))
!CheckStatGT(SecondNearest([0.0.MAGE_ALL]),99,RESISTSLASHING)
!CheckStatGT(SecondNearest([0.0.MAGE_ALL]),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",SecondNearest([0.0.MAGE_ALL]))
!HasItemEquiped("wa2amu",SecondNearest([0.0.MAGE_ALL]))
!CheckStatGT(SecondNearest([0.0.MAGE_ALL]),0,STONESKINS)
!StateCheck(SecondNearest([0.0.MAGE_ALL]),STATE_MIRRORIMAGE)
!HasItemEquiped("lich",SecondNearest([0.0.MAGE_ALL]))
Range(SecondNearest([0.0.MAGE_ALL]),5)
THEN
RESPONSE #100
AttackOneRound(SecondNearest([0.0.MAGE_ALL]))
END

IF
See(ThirdNearest([0.0.MAGE_ALL]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearest([0.0.MAGE_ALL]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearest([0.0.MAGE_ALL]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearest([0.0.MAGE_ALL]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearest([0.0.MAGE_ALL]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearest([0.0.MAGE_ALL]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearest([0.0.MAGE_ALL]))
!CheckStatGT(ThirdNearest([0.0.MAGE_ALL]),99,RESISTSLASHING)
!CheckStatGT(ThirdNearest([0.0.MAGE_ALL]),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",ThirdNearest([0.0.MAGE_ALL]))
!HasItemEquiped("wa2amu",ThirdNearest([0.0.MAGE_ALL]))
!CheckStatGT(ThirdNearest([0.0.MAGE_ALL]),0,STONESKINS)
!StateCheck(ThirdNearest([0.0.MAGE_ALL]),STATE_MIRRORIMAGE)
!HasItemEquiped("lich",ThirdNearest([0.0.MAGE_ALL]))
Range(ThirdNearest([0.0.MAGE_ALL]),5)
THEN
RESPONSE #100
AttackOneRound(ThirdNearest([0.0.MAGE_ALL]))
END

IF
See([0.0.CLERIC_ALL])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([0.0.CLERIC_ALL],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([0.0.CLERIC_ALL],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([0.0.CLERIC_ALL],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([0.0.CLERIC_ALL],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([0.0.CLERIC_ALL],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[0.0.CLERIC_ALL])
!CheckStatGT([0.0.CLERIC_ALL],99,RESISTSLASHING)
!CheckStatGT([0.0.CLERIC_ALL],0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",[0.0.CLERIC_ALL])
!HasItemEquiped("wa2amu",[0.0.CLERIC_ALL])
!CheckStatGT([0.0.CLERIC_ALL],0,STONESKINS)
!StateCheck([0.0.CLERIC_ALL],STATE_MIRRORIMAGE)
!HasItemEquiped("lich",[0.0.CLERIC_ALL])
Range([0.0.CLERIC_ALL],5)
THEN
RESPONSE #100
AttackOneRound([0.0.CLERIC_ALL])
END

IF
See(SecondNearest([0.0.CLERIC_ALL]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearest([0.0.CLERIC_ALL]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.CLERIC_ALL]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.CLERIC_ALL]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.CLERIC_ALL]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.CLERIC_ALL]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearest([0.0.CLERIC_ALL]))
!CheckStatGT(SecondNearest([0.0.CLERIC_ALL]),99,RESISTSLASHING)
!CheckStatGT(SecondNearest([0.0.CLERIC_ALL]),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",SecondNearest([0.0.CLERIC_ALL]))
!HasItemEquiped("wa2amu",SecondNearest([0.0.CLERIC_ALL]))
!CheckStatGT(SecondNearest([0.0.CLERIC_ALL]),0,STONESKINS)
!StateCheck(SecondNearest([0.0.CLERIC_ALL]),STATE_MIRRORIMAGE)
!HasItemEquiped("lich",SecondNearest([0.0.CLERIC_ALL]))
Range(SecondNearest([0.0.CLERIC_ALL]),5)
THEN
RESPONSE #100
AttackOneRound(SecondNearest([0.0.CLERIC_ALL]))
END

IF
See([0.0.DRUID_ALL])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([0.0.DRUID_ALL],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([0.0.DRUID_ALL],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([0.0.DRUID_ALL],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([0.0.DRUID_ALL],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([0.0.DRUID_ALL],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[0.0.DRUID_ALL])
!CheckStatGT([0.0.DRUID_ALL],99,RESISTSLASHING)
!CheckStatGT([0.0.DRUID_ALL],0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",[0.0.DRUID_ALL])
!HasItemEquiped("wa2amu",[0.0.DRUID_ALL])
!CheckStatGT([0.0.DRUID_ALL],0,STONESKINS)
!StateCheck([0.0.DRUID_ALL],STATE_MIRRORIMAGE)
!HasItemEquiped("lich",[0.0.DRUID_ALL])
Range([0.0.DRUID_ALL],5)
THEN
RESPONSE #100
AttackOneRound([0.0.DRUID_ALL])
END

IF
See([0.0.BARD_ALL])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([0.0.BARD_ALL],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([0.0.BARD_ALL],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([0.0.BARD_ALL],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([0.0.BARD_ALL],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([0.0.BARD_ALL],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[0.0.BARD_ALL])
!CheckStatGT([0.0.BARD_ALL],99,RESISTSLASHING)
!CheckStatGT([0.0.BARD_ALL],0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",[0.0.BARD_ALL])
!HasItemEquiped("wa2amu",[0.0.BARD_ALL])
!CheckStatGT([0.0.BARD_ALL],0,STONESKINS)
!StateCheck([0.0.BARD_ALL],STATE_MIRRORIMAGE)
!HasItemEquiped("lich",[0.0.BARD_ALL])
Range([0.0.BARD_ALL],5)
THEN
RESPONSE #100
AttackOneRound([0.0.BARD_ALL])
END

IF
See(NearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(NearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",NearestEnemyOf(Myself))
!CheckStatGT(NearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(NearestEnemyOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",NearestEnemyOf(Myself))
!HasItemEquiped("wa2amu",NearestEnemyOf(Myself))
!CheckStatGT(NearestEnemyOf(Myself),0,STONESKINS)
!StateCheck(NearestEnemyOf(Myself),STATE_MIRRORIMAGE)
!HasItemEquiped("lich",NearestEnemyOf(Myself))
Range(NearestEnemyOf(Myself),5)
THEN
RESPONSE #100
AttackOneRound(NearestEnemyOf(Myself))
END

IF
See(SecondNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearestEnemyOf(Myself))
!CheckStatGT(SecondNearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",SecondNearestEnemyOf(Myself))
!HasItemEquiped("wa2amu",SecondNearestEnemyOf(Myself))
!CheckStatGT(SecondNearestEnemyOf(Myself),0,STONESKINS)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_MIRRORIMAGE)
!HasItemEquiped("lich",SecondNearestEnemyOf(Myself))
Range(SecondNearestEnemyOf(Myself),5)
THEN
RESPONSE #100
AttackOneRound(SecondNearestEnemyOf(Myself))
END

IF
See(ThirdNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearestEnemyOf(Myself))
!CheckStatGT(ThirdNearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",ThirdNearestEnemyOf(Myself))
!HasItemEquiped("wa2amu",ThirdNearestEnemyOf(Myself))
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,STONESKINS)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_MIRRORIMAGE)
!HasItemEquiped("lich",ThirdNearestEnemyOf(Myself))
Range(ThirdNearestEnemyOf(Myself),5)
THEN
RESPONSE #100
AttackOneRound(ThirdNearestEnemyOf(Myself))
END

IF
See(FourthNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FourthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FourthNearestEnemyOf(Myself))
!CheckStatGT(FourthNearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",FourthNearestEnemyOf(Myself))
!HasItemEquiped("wa2amu",FourthNearestEnemyOf(Myself))
!CheckStatGT(FourthNearestEnemyOf(Myself),0,STONESKINS)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_MIRRORIMAGE)
!HasItemEquiped("lich",FourthNearestEnemyOf(Myself))
Range(FourthNearestEnemyOf(Myself),5)
THEN
RESPONSE #100
AttackOneRound(FourthNearestEnemyOf(Myself))
END

IF
See(FifthNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FifthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FifthNearestEnemyOf(Myself))
!CheckStatGT(FifthNearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",FifthNearestEnemyOf(Myself))
!HasItemEquiped("wa2amu",FifthNearestEnemyOf(Myself))
!CheckStatGT(FifthNearestEnemyOf(Myself),0,STONESKINS)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_MIRRORIMAGE)
!HasItemEquiped("lich",FifthNearestEnemyOf(Myself))
Range(FifthNearestEnemyOf(Myself),5)
THEN
RESPONSE #100
AttackOneRound(FifthNearestEnemyOf(Myself))
END

IF
See(SixthNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SixthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SixthNearestEnemyOf(Myself))
!CheckStatGT(SixthNearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",SixthNearestEnemyOf(Myself))
!HasItemEquiped("wa2amu",SixthNearestEnemyOf(Myself))
!CheckStatGT(SixthNearestEnemyOf(Myself),0,STONESKINS)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_MIRRORIMAGE)
!HasItemEquiped("lich",SixthNearestEnemyOf(Myself))
Range(SixthNearestEnemyOf(Myself),5)
THEN
RESPONSE #100
AttackOneRound(SixthNearestEnemyOf(Myself))
END

IF
See([0.0.MAGE])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([0.0.MAGE],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([0.0.MAGE],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([0.0.MAGE],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([0.0.MAGE],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([0.0.MAGE],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[0.0.MAGE])
!CheckStatGT([0.0.MAGE],99,RESISTSLASHING)
!CheckStatGT([0.0.MAGE],0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",[0.0.MAGE])
!HasItemEquiped("wa2amu",[0.0.MAGE])
!HasItemEquiped("lich",[0.0.MAGE])
Range([0.0.MAGE],5)
THEN
RESPONSE #100
AttackOneRound([0.0.MAGE])
END

IF
See(SecondNearest([0.0.MAGE]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearest([0.0.MAGE]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearest([0.0.MAGE]))
!CheckStatGT(SecondNearest([0.0.MAGE]),99,RESISTSLASHING)
!CheckStatGT(SecondNearest([0.0.MAGE]),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",SecondNearest([0.0.MAGE]))
!HasItemEquiped("wa2amu",SecondNearest([0.0.MAGE]))
!HasItemEquiped("lich",SecondNearest([0.0.MAGE]))
Range(SecondNearest([0.0.MAGE]),5)
THEN
RESPONSE #100
AttackOneRound(SecondNearest([0.0.MAGE]))
END

IF
See([0.0.MAGE_THIEF])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([0.0.MAGE_THIEF],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([0.0.MAGE_THIEF],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([0.0.MAGE_THIEF],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([0.0.MAGE_THIEF],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([0.0.MAGE_THIEF],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[0.0.MAGE_THIEF])
!CheckStatGT([0.0.MAGE_THIEF],99,RESISTSLASHING)
!CheckStatGT([0.0.MAGE_THIEF],0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",[0.0.MAGE_THIEF])
!HasItemEquiped("wa2amu",[0.0.MAGE_THIEF])
!HasItemEquiped("lich",[0.0.MAGE_THIEF])
Range([0.0.MAGE_THIEF],5)
THEN
RESPONSE #100
AttackOneRound([0.0.MAGE_THIEF])
END

IF
See(SecondNearest([0.0.MAGE_THIEF]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearest([0.0.MAGE_THIEF]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE_THIEF]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE_THIEF]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE_THIEF]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE_THIEF]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearest([0.0.MAGE_THIEF]))
!CheckStatGT(SecondNearest([0.0.MAGE_THIEF]),99,RESISTSLASHING)
!CheckStatGT(SecondNearest([0.0.MAGE_THIEF]),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",SecondNearest([0.0.MAGE_THIEF]))
!HasItemEquiped("wa2amu",SecondNearest([0.0.MAGE_THIEF]))
!HasItemEquiped("lich",SecondNearest([0.0.MAGE_THIEF]))
Range(SecondNearest([0.0.MAGE_THIEF]),5)
THEN
RESPONSE #100
AttackOneRound(SecondNearest([0.0.MAGE_THIEF]))
END

IF
See([0.0.MAGE_ALL])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([0.0.MAGE_ALL],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([0.0.MAGE_ALL],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([0.0.MAGE_ALL],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([0.0.MAGE_ALL],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([0.0.MAGE_ALL],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[0.0.MAGE_ALL])
!CheckStatGT([0.0.MAGE_ALL],99,RESISTSLASHING)
!CheckStatGT([0.0.MAGE_ALL],0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",[0.0.MAGE_ALL])
!HasItemEquiped("wa2amu",[0.0.MAGE_ALL])
!HasItemEquiped("lich",[0.0.MAGE_ALL])
Range([0.0.MAGE_ALL],5)
THEN
RESPONSE #100
AttackOneRound([0.0.MAGE_ALL])
END

IF
See(SecondNearest([0.0.MAGE_ALL]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearest([0.0.MAGE_ALL]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE_ALL]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE_ALL]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE_ALL]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE_ALL]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearest([0.0.MAGE_ALL]))
!CheckStatGT(SecondNearest([0.0.MAGE_ALL]),99,RESISTSLASHING)
!CheckStatGT(SecondNearest([0.0.MAGE_ALL]),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",SecondNearest([0.0.MAGE_ALL]))
!HasItemEquiped("wa2amu",SecondNearest([0.0.MAGE_ALL]))
!HasItemEquiped("lich",SecondNearest([0.0.MAGE_ALL]))
Range(SecondNearest([0.0.MAGE_ALL]),5)
THEN
RESPONSE #100
AttackOneRound(SecondNearest([0.0.MAGE_ALL]))
END

IF
See(ThirdNearest([0.0.MAGE_ALL]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearest([0.0.MAGE_ALL]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearest([0.0.MAGE_ALL]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearest([0.0.MAGE_ALL]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearest([0.0.MAGE_ALL]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearest([0.0.MAGE_ALL]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearest([0.0.MAGE_ALL]))
!CheckStatGT(ThirdNearest([0.0.MAGE_ALL]),99,RESISTSLASHING)
!CheckStatGT(ThirdNearest([0.0.MAGE_ALL]),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",ThirdNearest([0.0.MAGE_ALL]))
!HasItemEquiped("wa2amu",ThirdNearest([0.0.MAGE_ALL]))
!HasItemEquiped("lich",ThirdNearest([0.0.MAGE_ALL]))
Range(ThirdNearest([0.0.MAGE_ALL]),5)
THEN
RESPONSE #100
AttackOneRound(ThirdNearest([0.0.MAGE_ALL]))
END

IF
See([0.0.CLERIC_ALL])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([0.0.CLERIC_ALL],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([0.0.CLERIC_ALL],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([0.0.CLERIC_ALL],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([0.0.CLERIC_ALL],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([0.0.CLERIC_ALL],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[0.0.CLERIC_ALL])
!CheckStatGT([0.0.CLERIC_ALL],99,RESISTSLASHING)
!CheckStatGT([0.0.CLERIC_ALL],0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",[0.0.CLERIC_ALL])
!HasItemEquiped("wa2amu",[0.0.CLERIC_ALL])
!HasItemEquiped("lich",[0.0.CLERIC_ALL])
Range([0.0.CLERIC_ALL],5)
THEN
RESPONSE #100
AttackOneRound([0.0.CLERIC_ALL])
END

IF
See(SecondNearest([0.0.CLERIC_ALL]))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearest([0.0.CLERIC_ALL]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.CLERIC_ALL]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.CLERIC_ALL]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.CLERIC_ALL]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.CLERIC_ALL]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearest([0.0.CLERIC_ALL]))
!CheckStatGT(SecondNearest([0.0.CLERIC_ALL]),99,RESISTSLASHING)
!CheckStatGT(SecondNearest([0.0.CLERIC_ALL]),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",SecondNearest([0.0.CLERIC_ALL]))
!HasItemEquiped("wa2amu",SecondNearest([0.0.CLERIC_ALL]))
!HasItemEquiped("lich",SecondNearest([0.0.CLERIC_ALL]))
Range(SecondNearest([0.0.CLERIC_ALL]),5)
THEN
RESPONSE #100
AttackOneRound(SecondNearest([0.0.CLERIC_ALL]))
END

IF
See([0.0.DRUID_ALL])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([0.0.DRUID_ALL],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([0.0.DRUID_ALL],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([0.0.DRUID_ALL],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([0.0.DRUID_ALL],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([0.0.DRUID_ALL],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[0.0.DRUID_ALL])
!CheckStatGT([0.0.DRUID_ALL],99,RESISTSLASHING)
!CheckStatGT([0.0.DRUID_ALL],0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",[0.0.DRUID_ALL])
!HasItemEquiped("wa2amu",[0.0.DRUID_ALL])
!HasItemEquiped("lich",[0.0.DRUID_ALL])
Range([0.0.DRUID_ALL],5)
THEN
RESPONSE #100
AttackOneRound([0.0.DRUID_ALL])
END

IF
See([0.0.BARD_ALL])
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([0.0.BARD_ALL],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([0.0.BARD_ALL],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([0.0.BARD_ALL],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([0.0.BARD_ALL],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([0.0.BARD_ALL],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[0.0.BARD_ALL])
!CheckStatGT([0.0.BARD_ALL],99,RESISTSLASHING)
!CheckStatGT([0.0.BARD_ALL],0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",[0.0.BARD_ALL])
!HasItemEquiped("wa2amu",[0.0.BARD_ALL])
!HasItemEquiped("lich",[0.0.BARD_ALL])
Range([0.0.BARD_ALL],5)
THEN
RESPONSE #100
AttackOneRound([0.0.BARD_ALL])
END

IF
See(NearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(NearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",NearestEnemyOf(Myself))
!CheckStatGT(NearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(NearestEnemyOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",NearestEnemyOf(Myself))
!HasItemEquiped("wa2amu",NearestEnemyOf(Myself))
!HasItemEquiped("lich",NearestEnemyOf(Myself))
Range(NearestEnemyOf(Myself),5)
THEN
RESPONSE #100
AttackOneRound(NearestEnemyOf(Myself))
END

IF
See(SecondNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearestEnemyOf(Myself))
!CheckStatGT(SecondNearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",SecondNearestEnemyOf(Myself))
!HasItemEquiped("wa2amu",SecondNearestEnemyOf(Myself))
!HasItemEquiped("lich",SecondNearestEnemyOf(Myself))
Range(SecondNearestEnemyOf(Myself),5)
THEN
RESPONSE #100
AttackOneRound(SecondNearestEnemyOf(Myself))
END

IF
See(ThirdNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearestEnemyOf(Myself))
!CheckStatGT(ThirdNearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",ThirdNearestEnemyOf(Myself))
!HasItemEquiped("wa2amu",ThirdNearestEnemyOf(Myself))
!HasItemEquiped("lich",ThirdNearestEnemyOf(Myself))
Range(ThirdNearestEnemyOf(Myself),5)
THEN
RESPONSE #100
AttackOneRound(ThirdNearestEnemyOf(Myself))
END

IF
See(FourthNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FourthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FourthNearestEnemyOf(Myself))
!CheckStatGT(FourthNearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",FourthNearestEnemyOf(Myself))
!HasItemEquiped("wa2amu",FourthNearestEnemyOf(Myself))
!HasItemEquiped("lich",FourthNearestEnemyOf(Myself))
Range(FourthNearestEnemyOf(Myself),5)
THEN
RESPONSE #100
AttackOneRound(FourthNearestEnemyOf(Myself))
END

IF
See(FifthNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FifthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FifthNearestEnemyOf(Myself))
!CheckStatGT(FifthNearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",FifthNearestEnemyOf(Myself))
!HasItemEquiped("wa2amu",FifthNearestEnemyOf(Myself))
!HasItemEquiped("lich",FifthNearestEnemyOf(Myself))
Range(FifthNearestEnemyOf(Myself),5)
THEN
RESPONSE #100
AttackOneRound(FifthNearestEnemyOf(Myself))
END

IF
See(SixthNearestEnemyOf(Myself))
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SixthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SixthNearestEnemyOf(Myself))
!CheckStatGT(SixthNearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",SixthNearestEnemyOf(Myself))
!HasItemEquiped("wa2amu",SixthNearestEnemyOf(Myself))
!HasItemEquiped("lich",SixthNearestEnemyOf(Myself))
Range(SixthNearestEnemyOf(Myself),5)
THEN
RESPONSE #100
AttackOneRound(SixthNearestEnemyOf(Myself))
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SixthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SixthNearestEnemyOf(Myself))
!CheckStatGT(SixthNearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",SixthNearestEnemyOf(Myself))
!HasItemEquiped("wa2amu",SixthNearestEnemyOf(Myself))
!CheckStatGT(SixthNearestEnemyOf(Myself),0,STONESKINS)
!StateCheck(SixthNearestEnemyOf(Myself),STATE_MIRRORIMAGE)
!HasItemEquiped("lich",SixthNearestEnemyOf(Myself))
!Range(SixthNearestEnemyOf(Myself),5)
InMyArea(SixthNearestEnemyOf(Myself))
See(SixthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FifthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FifthNearestEnemyOf(Myself))
!CheckStatGT(FifthNearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",FifthNearestEnemyOf(Myself))
!HasItemEquiped("wa2amu",FifthNearestEnemyOf(Myself))
!CheckStatGT(FifthNearestEnemyOf(Myself),0,STONESKINS)
!StateCheck(FifthNearestEnemyOf(Myself),STATE_MIRRORIMAGE)
!HasItemEquiped("lich",FifthNearestEnemyOf(Myself))
!Range(FifthNearestEnemyOf(Myself),5)
InMyArea(FifthNearestEnemyOf(Myself))
See(FifthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FourthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FourthNearestEnemyOf(Myself))
!CheckStatGT(FourthNearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",FourthNearestEnemyOf(Myself))
!HasItemEquiped("wa2amu",FourthNearestEnemyOf(Myself))
!CheckStatGT(FourthNearestEnemyOf(Myself),0,STONESKINS)
!StateCheck(FourthNearestEnemyOf(Myself),STATE_MIRRORIMAGE)
!HasItemEquiped("lich",FourthNearestEnemyOf(Myself))
!Range(FourthNearestEnemyOf(Myself),5)
InMyArea(FourthNearestEnemyOf(Myself))
See(FourthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearestEnemyOf(Myself))
!CheckStatGT(ThirdNearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",ThirdNearestEnemyOf(Myself))
!HasItemEquiped("wa2amu",ThirdNearestEnemyOf(Myself))
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,STONESKINS)
!StateCheck(ThirdNearestEnemyOf(Myself),STATE_MIRRORIMAGE)
!HasItemEquiped("lich",ThirdNearestEnemyOf(Myself))
!Range(ThirdNearestEnemyOf(Myself),5)
InMyArea(ThirdNearestEnemyOf(Myself))
See(ThirdNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearestEnemyOf(Myself))
!CheckStatGT(SecondNearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",SecondNearestEnemyOf(Myself))
!HasItemEquiped("wa2amu",SecondNearestEnemyOf(Myself))
!CheckStatGT(SecondNearestEnemyOf(Myself),0,STONESKINS)
!StateCheck(SecondNearestEnemyOf(Myself),STATE_MIRRORIMAGE)
!HasItemEquiped("lich",SecondNearestEnemyOf(Myself))
!Range(SecondNearestEnemyOf(Myself),5)
InMyArea(SecondNearestEnemyOf(Myself))
See(SecondNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(NearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",NearestEnemyOf(Myself))
!CheckStatGT(NearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(NearestEnemyOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",NearestEnemyOf(Myself))
!HasItemEquiped("wa2amu",NearestEnemyOf(Myself))
!CheckStatGT(NearestEnemyOf(Myself),0,STONESKINS)
!StateCheck(NearestEnemyOf(Myself),STATE_MIRRORIMAGE)
!HasItemEquiped("lich",NearestEnemyOf(Myself))
!Range(NearestEnemyOf(Myself),5)
InMyArea(NearestEnemyOf(Myself))
See(NearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([0.0.BARD_ALL],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([0.0.BARD_ALL],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([0.0.BARD_ALL],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([0.0.BARD_ALL],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([0.0.BARD_ALL],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[0.0.BARD_ALL])
!CheckStatGT([0.0.BARD_ALL],99,RESISTSLASHING)
!CheckStatGT([0.0.BARD_ALL],0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",[0.0.BARD_ALL])
!HasItemEquiped("wa2amu",[0.0.BARD_ALL])
!CheckStatGT([0.0.BARD_ALL],0,STONESKINS)
!StateCheck([0.0.BARD_ALL],STATE_MIRRORIMAGE)
!HasItemEquiped("lich",[0.0.BARD_ALL])
!Range([0.0.BARD_ALL],5)
InMyArea([0.0.BARD_ALL])
See([0.0.BARD_ALL])
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([0.0.DRUID_ALL],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([0.0.DRUID_ALL],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([0.0.DRUID_ALL],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([0.0.DRUID_ALL],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([0.0.DRUID_ALL],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[0.0.DRUID_ALL])
!CheckStatGT([0.0.DRUID_ALL],99,RESISTSLASHING)
!CheckStatGT([0.0.DRUID_ALL],0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",[0.0.DRUID_ALL])
!HasItemEquiped("wa2amu",[0.0.DRUID_ALL])
!CheckStatGT([0.0.DRUID_ALL],0,STONESKINS)
!StateCheck([0.0.DRUID_ALL],STATE_MIRRORIMAGE)
!HasItemEquiped("lich",[0.0.DRUID_ALL])
!Range([0.0.DRUID_ALL],5)
InMyArea([0.0.DRUID_ALL])
See([0.0.DRUID_ALL])
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearest([0.0.CLERIC_ALL]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.CLERIC_ALL]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.CLERIC_ALL]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.CLERIC_ALL]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.CLERIC_ALL]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearest([0.0.CLERIC_ALL]))
!CheckStatGT(SecondNearest([0.0.CLERIC_ALL]),99,RESISTSLASHING)
!CheckStatGT(SecondNearest([0.0.CLERIC_ALL]),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",SecondNearest([0.0.CLERIC_ALL]))
!HasItemEquiped("wa2amu",SecondNearest([0.0.CLERIC_ALL]))
!CheckStatGT(SecondNearest([0.0.CLERIC_ALL]),0,STONESKINS)
!StateCheck(SecondNearest([0.0.CLERIC_ALL]),STATE_MIRRORIMAGE)
!HasItemEquiped("lich",SecondNearest([0.0.CLERIC_ALL]))
!Range(SecondNearest([0.0.CLERIC_ALL]),5)
InMyArea(SecondNearest([0.0.CLERIC_ALL]))
See(SecondNearest([0.0.CLERIC_ALL]))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([0.0.CLERIC_ALL],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([0.0.CLERIC_ALL],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([0.0.CLERIC_ALL],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([0.0.CLERIC_ALL],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([0.0.CLERIC_ALL],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[0.0.CLERIC_ALL])
!CheckStatGT([0.0.CLERIC_ALL],99,RESISTSLASHING)
!CheckStatGT([0.0.CLERIC_ALL],0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",[0.0.CLERIC_ALL])
!HasItemEquiped("wa2amu",[0.0.CLERIC_ALL])
!CheckStatGT([0.0.CLERIC_ALL],0,STONESKINS)
!StateCheck([0.0.CLERIC_ALL],STATE_MIRRORIMAGE)
!HasItemEquiped("lich",[0.0.CLERIC_ALL])
!Range([0.0.CLERIC_ALL],5)
InMyArea([0.0.CLERIC_ALL])
See([0.0.CLERIC_ALL])
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearest([0.0.MAGE_ALL]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearest([0.0.MAGE_ALL]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearest([0.0.MAGE_ALL]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearest([0.0.MAGE_ALL]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearest([0.0.MAGE_ALL]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearest([0.0.MAGE_ALL]))
!CheckStatGT(ThirdNearest([0.0.MAGE_ALL]),99,RESISTSLASHING)
!CheckStatGT(ThirdNearest([0.0.MAGE_ALL]),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",ThirdNearest([0.0.MAGE_ALL]))
!HasItemEquiped("wa2amu",ThirdNearest([0.0.MAGE_ALL]))
!CheckStatGT(ThirdNearest([0.0.MAGE_ALL]),0,STONESKINS)
!StateCheck(ThirdNearest([0.0.MAGE_ALL]),STATE_MIRRORIMAGE)
!HasItemEquiped("lich",ThirdNearest([0.0.MAGE_ALL]))
!Range(ThirdNearest([0.0.MAGE_ALL]),5)
InMyArea(ThirdNearest([0.0.MAGE_ALL]))
See(ThirdNearest([0.0.MAGE_ALL]))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearest([0.0.MAGE_ALL]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE_ALL]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE_ALL]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE_ALL]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE_ALL]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearest([0.0.MAGE_ALL]))
!CheckStatGT(SecondNearest([0.0.MAGE_ALL]),99,RESISTSLASHING)
!CheckStatGT(SecondNearest([0.0.MAGE_ALL]),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",SecondNearest([0.0.MAGE_ALL]))
!HasItemEquiped("wa2amu",SecondNearest([0.0.MAGE_ALL]))
!CheckStatGT(SecondNearest([0.0.MAGE_ALL]),0,STONESKINS)
!StateCheck(SecondNearest([0.0.MAGE_ALL]),STATE_MIRRORIMAGE)
!HasItemEquiped("lich",SecondNearest([0.0.MAGE_ALL]))
!Range(SecondNearest([0.0.MAGE_ALL]),5)
InMyArea(SecondNearest([0.0.MAGE_ALL]))
See(SecondNearest([0.0.MAGE_ALL]))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([0.0.MAGE_ALL],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([0.0.MAGE_ALL],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([0.0.MAGE_ALL],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([0.0.MAGE_ALL],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([0.0.MAGE_ALL],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[0.0.MAGE_ALL])
!CheckStatGT([0.0.MAGE_ALL],99,RESISTSLASHING)
!CheckStatGT([0.0.MAGE_ALL],0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",[0.0.MAGE_ALL])
!HasItemEquiped("wa2amu",[0.0.MAGE_ALL])
!CheckStatGT([0.0.MAGE_ALL],0,STONESKINS)
!StateCheck([0.0.MAGE_ALL],STATE_MIRRORIMAGE)
!HasItemEquiped("lich",[0.0.MAGE_ALL])
!Range([0.0.MAGE_ALL],5)
InMyArea([0.0.MAGE_ALL])
See([0.0.MAGE_ALL])
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearest([0.0.MAGE_THIEF]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE_THIEF]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE_THIEF]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE_THIEF]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE_THIEF]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearest([0.0.MAGE_THIEF]))
!CheckStatGT(SecondNearest([0.0.MAGE_THIEF]),99,RESISTSLASHING)
!CheckStatGT(SecondNearest([0.0.MAGE_THIEF]),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",SecondNearest([0.0.MAGE_THIEF]))
!HasItemEquiped("wa2amu",SecondNearest([0.0.MAGE_THIEF]))
!CheckStatGT(SecondNearest([0.0.MAGE_THIEF]),0,STONESKINS)
!StateCheck(SecondNearest([0.0.MAGE_THIEF]),STATE_MIRRORIMAGE)
!HasItemEquiped("lich",SecondNearest([0.0.MAGE_THIEF]))
!Range(SecondNearest([0.0.MAGE_THIEF]),5)
InMyArea(SecondNearest([0.0.MAGE_THIEF]))
See(SecondNearest([0.0.MAGE_THIEF]))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([0.0.MAGE_THIEF],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([0.0.MAGE_THIEF],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([0.0.MAGE_THIEF],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([0.0.MAGE_THIEF],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([0.0.MAGE_THIEF],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[0.0.MAGE_THIEF])
!CheckStatGT([0.0.MAGE_THIEF],99,RESISTSLASHING)
!CheckStatGT([0.0.MAGE_THIEF],0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",[0.0.MAGE_THIEF])
!HasItemEquiped("wa2amu",[0.0.MAGE_THIEF])
!CheckStatGT([0.0.MAGE_THIEF],0,STONESKINS)
!StateCheck([0.0.MAGE_THIEF],STATE_MIRRORIMAGE)
!HasItemEquiped("lich",[0.0.MAGE_THIEF])
!Range([0.0.MAGE_THIEF],5)
InMyArea([0.0.MAGE_THIEF])
See([0.0.MAGE_THIEF])
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearest([0.0.MAGE]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearest([0.0.MAGE]))
!CheckStatGT(SecondNearest([0.0.MAGE]),99,RESISTSLASHING)
!CheckStatGT(SecondNearest([0.0.MAGE]),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",SecondNearest([0.0.MAGE]))
!HasItemEquiped("wa2amu",SecondNearest([0.0.MAGE]))
!CheckStatGT(SecondNearest([0.0.MAGE]),0,STONESKINS)
!StateCheck(SecondNearest([0.0.MAGE]),STATE_MIRRORIMAGE)
!HasItemEquiped("lich",SecondNearest([0.0.MAGE]))
!Range(SecondNearest([0.0.MAGE]),5)
InMyArea(SecondNearest([0.0.MAGE]))
See(SecondNearest([0.0.MAGE]))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([0.0.MAGE],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([0.0.MAGE],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([0.0.MAGE],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([0.0.MAGE],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([0.0.MAGE],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[0.0.MAGE])
!CheckStatGT([0.0.MAGE],99,RESISTSLASHING)
!CheckStatGT([0.0.MAGE],0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",[0.0.MAGE])
!HasItemEquiped("wa2amu",[0.0.MAGE])
!CheckStatGT([0.0.MAGE],0,STONESKINS)
!StateCheck([0.0.MAGE],STATE_MIRRORIMAGE)
!HasItemEquiped("lich",[0.0.MAGE])
!Range([0.0.MAGE],5)
InMyArea([0.0.MAGE])
See([0.0.MAGE])
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(LastSeenBy(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(LastSeenBy(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(LastSeenBy(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(LastSeenBy(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(LastSeenBy(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",LastSeenBy(Myself))
!CheckStatGT(LastSeenBy(Myself),99,RESISTSLASHING)
!CheckStatGT(LastSeenBy(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",LastSeenBy(Myself))
!HasItemEquiped("wa2amu",LastSeenBy(Myself))
!CheckStatGT(LastSeenBy(Myself),0,STONESKINS)
!StateCheck(LastSeenBy(Myself),STATE_MIRRORIMAGE)
!HasItemEquiped("lich",LastSeenBy(Myself))
!Range(LastSeenBy(Myself),5)
InMyArea(LastSeenBy(Myself))
See(LastSeenBy(Myself))
THEN
RESPONSE #100
SetGlobalTimer("cast","LOCALS",6)
ForceSpellRES("RR#TELWE",LastSeenBy(Myself))
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SixthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SixthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SixthNearestEnemyOf(Myself))
!CheckStatGT(SixthNearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",SixthNearestEnemyOf(Myself))
!HasItemEquiped("wa2amu",SixthNearestEnemyOf(Myself))
!HasItemEquiped("lich",SixthNearestEnemyOf(Myself))
!Range(SixthNearestEnemyOf(Myself),5)
InMyArea(SixthNearestEnemyOf(Myself))
See(SixthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FifthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FifthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FifthNearestEnemyOf(Myself))
!CheckStatGT(FifthNearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",FifthNearestEnemyOf(Myself))
!HasItemEquiped("wa2amu",FifthNearestEnemyOf(Myself))
!HasItemEquiped("lich",FifthNearestEnemyOf(Myself))
!Range(FifthNearestEnemyOf(Myself),5)
InMyArea(FifthNearestEnemyOf(Myself))
See(FifthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(FourthNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(FourthNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",FourthNearestEnemyOf(Myself))
!CheckStatGT(FourthNearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",FourthNearestEnemyOf(Myself))
!HasItemEquiped("wa2amu",FourthNearestEnemyOf(Myself))
!HasItemEquiped("lich",FourthNearestEnemyOf(Myself))
!Range(FourthNearestEnemyOf(Myself),5)
InMyArea(FourthNearestEnemyOf(Myself))
See(FourthNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearestEnemyOf(Myself))
!CheckStatGT(ThirdNearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",ThirdNearestEnemyOf(Myself))
!HasItemEquiped("wa2amu",ThirdNearestEnemyOf(Myself))
!HasItemEquiped("lich",ThirdNearestEnemyOf(Myself))
!Range(ThirdNearestEnemyOf(Myself),5)
InMyArea(ThirdNearestEnemyOf(Myself))
See(ThirdNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearestEnemyOf(Myself))
!CheckStatGT(SecondNearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",SecondNearestEnemyOf(Myself))
!HasItemEquiped("wa2amu",SecondNearestEnemyOf(Myself))
!HasItemEquiped("lich",SecondNearestEnemyOf(Myself))
!Range(SecondNearestEnemyOf(Myself),5)
InMyArea(SecondNearestEnemyOf(Myself))
See(SecondNearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(NearestEnemyOf(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(NearestEnemyOf(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",NearestEnemyOf(Myself))
!CheckStatGT(NearestEnemyOf(Myself),99,RESISTSLASHING)
!CheckStatGT(NearestEnemyOf(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",NearestEnemyOf(Myself))
!HasItemEquiped("wa2amu",NearestEnemyOf(Myself))
!HasItemEquiped("lich",NearestEnemyOf(Myself))
!Range(NearestEnemyOf(Myself),5)
InMyArea(NearestEnemyOf(Myself))
See(NearestEnemyOf(Myself))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([0.0.BARD_ALL],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([0.0.BARD_ALL],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([0.0.BARD_ALL],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([0.0.BARD_ALL],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([0.0.BARD_ALL],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[0.0.BARD_ALL])
!CheckStatGT([0.0.BARD_ALL],99,RESISTSLASHING)
!CheckStatGT([0.0.BARD_ALL],0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",[0.0.BARD_ALL])
!HasItemEquiped("wa2amu",[0.0.BARD_ALL])
!HasItemEquiped("lich",[0.0.BARD_ALL])
!Range([0.0.BARD_ALL],5)
InMyArea([0.0.BARD_ALL])
See([0.0.BARD_ALL])
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([0.0.DRUID_ALL],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([0.0.DRUID_ALL],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([0.0.DRUID_ALL],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([0.0.DRUID_ALL],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([0.0.DRUID_ALL],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[0.0.DRUID_ALL])
!CheckStatGT([0.0.DRUID_ALL],99,RESISTSLASHING)
!CheckStatGT([0.0.DRUID_ALL],0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",[0.0.DRUID_ALL])
!HasItemEquiped("wa2amu",[0.0.DRUID_ALL])
!HasItemEquiped("lich",[0.0.DRUID_ALL])
!Range([0.0.DRUID_ALL],5)
InMyArea([0.0.DRUID_ALL])
See([0.0.DRUID_ALL])
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearest([0.0.CLERIC_ALL]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.CLERIC_ALL]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.CLERIC_ALL]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.CLERIC_ALL]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.CLERIC_ALL]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearest([0.0.CLERIC_ALL]))
!CheckStatGT(SecondNearest([0.0.CLERIC_ALL]),99,RESISTSLASHING)
!CheckStatGT(SecondNearest([0.0.CLERIC_ALL]),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",SecondNearest([0.0.CLERIC_ALL]))
!HasItemEquiped("wa2amu",SecondNearest([0.0.CLERIC_ALL]))
!HasItemEquiped("lich",SecondNearest([0.0.CLERIC_ALL]))
!Range(SecondNearest([0.0.CLERIC_ALL]),5)
InMyArea(SecondNearest([0.0.CLERIC_ALL]))
See(SecondNearest([0.0.CLERIC_ALL]))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([0.0.CLERIC_ALL],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([0.0.CLERIC_ALL],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([0.0.CLERIC_ALL],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([0.0.CLERIC_ALL],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([0.0.CLERIC_ALL],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[0.0.CLERIC_ALL])
!CheckStatGT([0.0.CLERIC_ALL],99,RESISTSLASHING)
!CheckStatGT([0.0.CLERIC_ALL],0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",[0.0.CLERIC_ALL])
!HasItemEquiped("wa2amu",[0.0.CLERIC_ALL])
!HasItemEquiped("lich",[0.0.CLERIC_ALL])
!Range([0.0.CLERIC_ALL],5)
InMyArea([0.0.CLERIC_ALL])
See([0.0.CLERIC_ALL])
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(ThirdNearest([0.0.MAGE_ALL]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(ThirdNearest([0.0.MAGE_ALL]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(ThirdNearest([0.0.MAGE_ALL]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(ThirdNearest([0.0.MAGE_ALL]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(ThirdNearest([0.0.MAGE_ALL]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",ThirdNearest([0.0.MAGE_ALL]))
!CheckStatGT(ThirdNearest([0.0.MAGE_ALL]),99,RESISTSLASHING)
!CheckStatGT(ThirdNearest([0.0.MAGE_ALL]),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",ThirdNearest([0.0.MAGE_ALL]))
!HasItemEquiped("wa2amu",ThirdNearest([0.0.MAGE_ALL]))
!HasItemEquiped("lich",ThirdNearest([0.0.MAGE_ALL]))
!Range(ThirdNearest([0.0.MAGE_ALL]),5)
InMyArea(ThirdNearest([0.0.MAGE_ALL]))
See(ThirdNearest([0.0.MAGE_ALL]))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearest([0.0.MAGE_ALL]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE_ALL]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE_ALL]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE_ALL]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE_ALL]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearest([0.0.MAGE_ALL]))
!CheckStatGT(SecondNearest([0.0.MAGE_ALL]),99,RESISTSLASHING)
!CheckStatGT(SecondNearest([0.0.MAGE_ALL]),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",SecondNearest([0.0.MAGE_ALL]))
!HasItemEquiped("wa2amu",SecondNearest([0.0.MAGE_ALL]))
!HasItemEquiped("lich",SecondNearest([0.0.MAGE_ALL]))
!Range(SecondNearest([0.0.MAGE_ALL]),5)
InMyArea(SecondNearest([0.0.MAGE_ALL]))
See(SecondNearest([0.0.MAGE_ALL]))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([0.0.MAGE_ALL],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([0.0.MAGE_ALL],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([0.0.MAGE_ALL],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([0.0.MAGE_ALL],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([0.0.MAGE_ALL],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[0.0.MAGE_ALL])
!CheckStatGT([0.0.MAGE_ALL],99,RESISTSLASHING)
!CheckStatGT([0.0.MAGE_ALL],0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",[0.0.MAGE_ALL])
!HasItemEquiped("wa2amu",[0.0.MAGE_ALL])
!HasItemEquiped("lich",[0.0.MAGE_ALL])
!Range([0.0.MAGE_ALL],5)
InMyArea([0.0.MAGE_ALL])
See([0.0.MAGE_ALL])
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearest([0.0.MAGE_THIEF]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE_THIEF]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE_THIEF]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE_THIEF]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE_THIEF]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearest([0.0.MAGE_THIEF]))
!CheckStatGT(SecondNearest([0.0.MAGE_THIEF]),99,RESISTSLASHING)
!CheckStatGT(SecondNearest([0.0.MAGE_THIEF]),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",SecondNearest([0.0.MAGE_THIEF]))
!HasItemEquiped("wa2amu",SecondNearest([0.0.MAGE_THIEF]))
!HasItemEquiped("lich",SecondNearest([0.0.MAGE_THIEF]))
!Range(SecondNearest([0.0.MAGE_THIEF]),5)
InMyArea(SecondNearest([0.0.MAGE_THIEF]))
See(SecondNearest([0.0.MAGE_THIEF]))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([0.0.MAGE_THIEF],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([0.0.MAGE_THIEF],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([0.0.MAGE_THIEF],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([0.0.MAGE_THIEF],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([0.0.MAGE_THIEF],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[0.0.MAGE_THIEF])
!CheckStatGT([0.0.MAGE_THIEF],99,RESISTSLASHING)
!CheckStatGT([0.0.MAGE_THIEF],0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",[0.0.MAGE_THIEF])
!HasItemEquiped("wa2amu",[0.0.MAGE_THIEF])
!HasItemEquiped("lich",[0.0.MAGE_THIEF])
!Range([0.0.MAGE_THIEF],5)
InMyArea([0.0.MAGE_THIEF])
See([0.0.MAGE_THIEF])
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(SecondNearest([0.0.MAGE]),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE]),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE]),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE]),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(SecondNearest([0.0.MAGE]),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",SecondNearest([0.0.MAGE]))
!CheckStatGT(SecondNearest([0.0.MAGE]),99,RESISTSLASHING)
!CheckStatGT(SecondNearest([0.0.MAGE]),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",SecondNearest([0.0.MAGE]))
!HasItemEquiped("wa2amu",SecondNearest([0.0.MAGE]))
!HasItemEquiped("lich",SecondNearest([0.0.MAGE]))
!Range(SecondNearest([0.0.MAGE]),5)
InMyArea(SecondNearest([0.0.MAGE]))
See(SecondNearest([0.0.MAGE]))
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat([0.0.MAGE],0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat([0.0.MAGE],4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat([0.0.MAGE],1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat([0.0.MAGE],2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat([0.0.MAGE],3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",[0.0.MAGE])
!CheckStatGT([0.0.MAGE],99,RESISTSLASHING)
!CheckStatGT([0.0.MAGE],0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",[0.0.MAGE])
!HasItemEquiped("wa2amu",[0.0.MAGE])
!HasItemEquiped("lich",[0.0.MAGE])
!Range([0.0.MAGE],5)
InMyArea([0.0.MAGE])
See([0.0.MAGE])
False()
THEN
RESPONSE #100
 Continue()
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
OR(2)
CheckStatGT(Myself,0,CLERIC_HALLOW)
CheckStat(LastSeenBy(Myself),0,WIZARD_PROTECTION_FROM_NORMAL_WEAPONS)
OR(2)
CheckStat(Myself,0,CLERIC_HALLOW)
!CheckStat(LastSeenBy(Myself),4,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,2,CLERIC_HALLOW)
!CheckStat(LastSeenBy(Myself),1,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,3,CLERIC_HALLOW)
!CheckStat(LastSeenBy(Myself),2,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
OR(2)
CheckStatGT(Myself,5,CLERIC_HALLOW)
!CheckStat(LastSeenBy(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
!HasItem("MORSWORD",LastSeenBy(Myself))
!CheckStatGT(LastSeenBy(Myself),99,RESISTSLASHING)
!CheckStatGT(LastSeenBy(Myself),0,PROTECTION_FROM_EVIL)
!HasItemEquipedReal("staf11",LastSeenBy(Myself))
!HasItemEquiped("wa2amu",LastSeenBy(Myself))
!HasItemEquiped("lich",LastSeenBy(Myself))
!Range(LastSeenBy(Myself),5)
InMyArea(LastSeenBy(Myself))
See(LastSeenBy(Myself))
THEN
RESPONSE #100
SetGlobalTimer("cast","LOCALS",6)
ForceSpellRES("RR#TELWE",LastSeenBy(Myself))
END

IF
!GlobalTimerNotExpired("cast","LOCALS")
!StateCheck(Myself,STATE_INVISIBLE)
!CheckStatGT(NearestEnemyOf(Myself),0,TRUE_SIGHT)
!CheckStatGT(SecondNearestEnemyOf(Myself),0,TRUE_SIGHT)
!CheckStatGT(ThirdNearestEnemyOf(Myself),0,TRUE_SIGHT)
!CheckStatGT(FourthNearestEnemyOf(Myself),0,TRUE_SIGHT)
!CheckStatGT(FifthNearestEnemyOf(Myself),0,TRUE_SIGHT)
!CheckStatGT(SixthNearestEnemyOf(Myself),0,TRUE_SIGHT)
!CheckStatGT(SeventhNearestEnemyOf(Myself),0,TRUE_SIGHT)
!Global("dvgldust","LOCALS",1)
THEN
RESPONSE #100
SetGlobal("cast","LOCALS",6)
ForceSpell(Myself,WIZARD_INVISIBILITY)
RESPONSE #25
Continue()
END

IF
ActionListEmpty()
THEN
RESPONSE #100
RandomWalkContinous()
END

